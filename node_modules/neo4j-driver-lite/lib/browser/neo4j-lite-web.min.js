!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).neo4j=t()}(this,function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L={},x={},B=(Object.defineProperty(x,"__esModule",{value:!0}),x.default="5.26.0",{}),t=(Object.defineProperty(B,"__esModule",{value:!0}),B.logging=void 0,B.logging={console:function(e){return{level:e,logger:function(e,t){return console.log("".concat(Date.now()," ").concat(e.toUpperCase()," ").concat(t))}}}},{}),r={},n={},F={},q=(Object.defineProperty(F,"__esModule",{value:!0}),F.getBrokenObjectReason=F.isBrokenObject=F.createBrokenObject=void 0,"__isBrokenObject__"),H="__reason__";F.createBrokenObject=function(r,e){function n(){throw r}return void 0===e&&(e={}),new Proxy(e,{get:function(e,t){return t===q||(t===H?r:void("toJSON"!==t&&n()))},set:n,apply:n,construct:n,defineProperty:n,deleteProperty:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,setPrototypeOf:n})},F.isBrokenObject=function(e){return null!==e&&"object"==typeof e&&!0===e[q]},F.getBrokenObjectReason=function(e){return e[H]},Object.defineProperty(n,"__esModule",{value:!0}),n.stringify=void 0;var V=F;n.stringify=function(e,r){return JSON.stringify(e,function(e,t){return(0,V.isBrokenObject)(t)?{__isBrokenObject__:!0,__reason__:(0,V.getBrokenObjectReason)(t)}:"bigint"==typeof t?"".concat(t,"n"):!0!==(null==r?void 0:r.useCustomToString)||"object"!=typeof t||Array.isArray(t)||"function"!=typeof t.toString||t.toString===Object.prototype.toString?t:null==t?void 0:t.toString()})};var z,W,G={},o=(o=G,Object.defineProperty(o,"__esModule",{value:!0}),o.rawPolyfilledDiagnosticRecord=void 0,o.rawPolyfilledDiagnosticRecord={OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"},Object.freeze(o.rawPolyfilledDiagnosticRecord),e&&e.__extends||(z=function(e,t){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}z(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),K=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Y=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&K(t,e,r);return Y(t,e),t},Z=(Object.defineProperty(r,"__esModule",{value:!0}),r.PROTOCOL_ERROR=r.SESSION_EXPIRED=r.SERVICE_UNAVAILABLE=r.GQLError=r.Neo4jError=r.isRetriableError=r.newGQLError=r.newError=void 0,i(n)),Q=G,i={DATABASE_ERROR:"DATABASE_ERROR",CLIENT_ERROR:"CLIENT_ERROR",TRANSIENT_ERROR:"TRANSIENT_ERROR",UNKNOWN:"UNKNOWN"},X=(Object.freeze(i),Object.values(i)),J="ServiceUnavailable",$=(r.SERVICE_UNAVAILABLE=J,"SessionExpired"),ee=(r.SESSION_EXPIRED=$,r.PROTOCOL_ERROR="ProtocolError",W=Error,o(te,W),Object.defineProperty(te.prototype,"diagnosticRecordAsJsonString",{get:function(){return Z.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),te);function te(e,t,r,n,o){var i=this;return(i=W.call(this,e,null!=o?{cause:o}:void 0)||this).constructor=te,i.__proto__=te.prototype,i.cause=null!=o?o:void 0,i.gqlStatus=t,i.gqlStatusDescription=r,i.diagnosticRecord=n,i.classification=void 0!==(e=i.diagnosticRecord)&&void 0!==e._classification&&X.includes(e._classification)?null==e?void 0:e._classification:"UNKNOWN",i.rawClassification=null!=(o=null==n?void 0:n._classification)?o:void 0,i.name="GQLError",i}r.GQLError=ee;o(oe,re=ee),oe.isRetriable=function(e){return null!=e&&e instanceof oe&&e.retriable};var re,ne=oe;function oe(e,t,r,n,o,i){e=re.call(this,e,r,n,o,i)||this;return e.constructor=oe,e.__proto__=oe.prototype,e.code=t,e.name="Neo4jError",e.retriable=(r=t)===J||r===$||"Neo.ClientError.Security.AuthorizationExpired"===r||function(e){return!0===(null==e?void 0:e.includes("TransientError"))}(r),e}r.Neo4jError=ne,r.newError=function(e,t,r,n,o,i){return new ne(e,null!=t?t:"N/A",null!=n?n:"50N42",null!=o?o:"error: general processing exception - unexpected error. "+e,null!=i?i:Q.rawPolyfilledDiagnosticRecord,r)},r.newGQLError=function(e,t,r,n,o){return new ee(e,null!=r?r:"50N42",null!=n?n:"error: general processing exception - unexpected error. "+e,null!=o?o:Q.rawPolyfilledDiagnosticRecord,t)};i=ne.isRetriable;r.isRetriableError=i;var o={},ie=(Object.defineProperty(o,"__esModule",{value:!0}),o.toString=o.toNumber=o.inSafeRange=o.isInt=o.int=void 0,r),ae=new Map,i=(p.prototype.inSafeRange=function(){return this.greaterThanOrEqual(p.MIN_SAFE_VALUE)&&this.lessThanOrEqual(p.MAX_SAFE_VALUE)},p.prototype.toInt=function(){return this.low},p.prototype.toNumber=function(){return this.high*pe+(this.low>>>0)},p.prototype.toBigInt=function(){var e;return this.isZero()?BigInt(0):this.isPositive()?BigInt(this.high>>>0)*BigInt(pe)+BigInt(this.low>>>0):(e=this.negate(),BigInt(-1)*(BigInt(e.high>>>0)*BigInt(pe)+BigInt(e.low>>>0)))},p.prototype.toNumberOrInfinity=function(){return this.lessThan(p.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(p.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()},p.prototype.toString=function(e){if((e=null!=e?e:10)<2||36<e)throw RangeError("radix out of range: "+e.toString());if(this.isZero())return"0";var t,r,n;if(this.isNegative())return this.equals(p.MIN_VALUE)?(t=p.fromNumber(e),n=(r=this.div(t)).multiply(t).subtract(this),r.toString(e)+n.toInt().toString(e)):"-"+this.negate().toString(e);for(var o=p.fromNumber(Math.pow(e,6)),i=(n=this,"");;){var a=n.div(o),s=(n.subtract(a.multiply(o)).toInt()>>>0).toString(e);if((n=a).isZero())return s+i;for(;s.length<6;)s="0"+s;i=""+s+i}},p.prototype.valueOf=function(){return this.toBigInt()},p.prototype.getHighBits=function(){return this.high},p.prototype.getLowBits=function(){return this.low},p.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(p.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!==this.high?this.high:this.low,t=0,t=31;0<t&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1},p.prototype.isZero=function(){return 0===this.high&&0===this.low},p.prototype.isNegative=function(){return this.high<0},p.prototype.isPositive=function(){return 0<=this.high},p.prototype.isOdd=function(){return 1==(1&this.low)},p.prototype.isEven=function(){return 0==(1&this.low)},p.prototype.equals=function(e){e=p.fromValue(e);return this.high===e.high&&this.low===e.low},p.prototype.notEquals=function(e){return!this.equals(e)},p.prototype.lessThan=function(e){return this.compare(e)<0},p.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},p.prototype.greaterThan=function(e){return 0<this.compare(e)},p.prototype.greaterThanOrEqual=function(e){return 0<=this.compare(e)},p.prototype.compare=function(e){var t,r,e=p.fromValue(e);return this.equals(e)?0:(t=this.isNegative(),r=e.isNegative(),t&&!r||(t||!r)&&this.subtract(e).isNegative()?-1:1)},p.prototype.negate=function(){return this.equals(p.MIN_VALUE)?p.MIN_VALUE:this.not().add(p.ONE)},p.prototype.add=function(e){var e=p.fromValue(e),t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,f=0;return c+=(l=l+((f+=o+(65535&e.low))>>>16)+(n+s))>>>16,p.fromBits((l&=65535)<<16|(f&=65535),((u+=(c+=r+a)>>>16)+(t+i)&65535)<<16|(c&=65535))},p.prototype.subtract=function(e){e=p.fromValue(e);return this.add(e.negate())},p.prototype.multiply=function(e){var t,r,n,o,i,a,s,u,c,l,f;return this.isZero()||(e=p.fromValue(e)).isZero()?p.ZERO:this.equals(p.MIN_VALUE)?e.isOdd()?p.MIN_VALUE:p.ZERO:e.equals(p.MIN_VALUE)?this.isOdd()?p.MIN_VALUE:p.ZERO:this.isNegative()?e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate():e.isNegative()?this.multiply(e.negate()).negate():this.lessThan(_e)&&e.lessThan(_e)?p.fromNumber(this.toNumber()*e.toNumber()):(t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,f=(f=l=c=u=0)+((c=c+((l+=o*(e=65535&e.low))>>>16)+n*e)>>>16)+((c=(c&65535)+o*s)>>>16),p.fromBits((c&=65535)<<16|(l&=65535),(u=(u=(u+=(f+=r*e)>>>16)+((f=(f&65535)+n*s)>>>16)+((f=(f&65535)+o*a)>>>16))+(t*e+r*s+n*a+o*i)&65535)<<16|(f&=65535)))},p.prototype.div=function(e){var t,r,n,o=p.fromValue(e);if(o.isZero())throw(0,ie.newError)("division by zero");if(this.isZero())return p.ZERO;if(this.equals(p.MIN_VALUE))return o.equals(p.ONE)||o.equals(p.NEG_ONE)?p.MIN_VALUE:o.equals(p.MIN_VALUE)?p.ONE:(n=this.shiftRight(1).div(o).shiftLeft(1)).equals(p.ZERO)?o.isNegative()?p.ONE:p.NEG_ONE:(t=this.subtract(o.multiply(n)),n.add(t.div(o)));if(o.equals(p.MIN_VALUE))return p.ZERO;if(this.isNegative())return o.isNegative()?this.negate().div(o.negate()):this.negate().div(o).negate();if(o.isNegative())return this.div(o.negate()).negate();for(r=p.ZERO,t=this;t.greaterThanOrEqual(o);){n=Math.max(1,Math.floor(t.toNumber()/o.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),a=i<=48?1:Math.pow(2,i-48),s=p.fromNumber(n),u=s.multiply(o);u.isNegative()||u.greaterThan(t);)u=(s=p.fromNumber(n-=a)).multiply(o);s.isZero()&&(s=p.ONE),r=r.add(s),t=t.subtract(u)}return r},p.prototype.modulo=function(e){e=p.fromValue(e);return this.subtract(this.div(e).multiply(e))},p.prototype.not=function(){return p.fromBits(~this.low,~this.high)},p.prototype.and=function(e){e=p.fromValue(e);return p.fromBits(this.low&e.low,this.high&e.high)},p.prototype.or=function(e){e=p.fromValue(e);return p.fromBits(this.low|e.low,this.high|e.high)},p.prototype.xor=function(e){e=p.fromValue(e);return p.fromBits(this.low^e.low,this.high^e.high)},p.prototype.shiftLeft=function(e){e=p.toNumber(e);return 0==(e&=63)?p.ZERO:e<32?p.fromBits(this.low<<e,this.high<<e|this.low>>>32-e):p.fromBits(0,this.low<<e-32)},p.prototype.shiftRight=function(e){var t=p.toNumber(e),e=p.toNumber(e);return 0==(t&=63)?p.ZERO:e<32?p.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):p.fromBits(this.high>>t-32,0<=this.high?0:-1)},p.isInteger=function(e){return!0===(null==e?void 0:e.__isInteger__)},p.fromInt=function(e){var t;return-128<=(e|=0)&&e<128&&null!=(t=ae.get(e))||(t=new p(e,e<0?-1:0),-128<=e&&e<128&&ae.set(e,t)),t},p.fromBits=function(e,t){return new p(e,t)},p.fromNumber=function(e){return isNaN(e)||!isFinite(e)?p.ZERO:e<=-de?p.MIN_VALUE:de<=e+1?p.MAX_VALUE:e<0?p.fromNumber(-e).negate():new p(e%pe|0,e/pe|0)},p.fromString=function(e,t,r){var n=(void 0===r?{}:r).strictStringValidation;if(0===e.length)throw(0,ie.newError)("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return p.ZERO;if((t=null!=t?t:10)<2||36<t)throw(0,ie.newError)("radix out of range: "+t.toString());if(0<(r=e.indexOf("-")))throw(0,ie.newError)('number format error: interior "-" character: '+e);if(0===r)return p.fromString(e.substring(1),t).negate();for(var o,i,a=p.fromNumber(Math.pow(t,8)),s=p.ZERO,u=0;u<e.length;u+=8){var c,l=Math.min(8,e.length-u),f=e.substring(u,u+l),h=parseInt(f,t);if(!0===n&&(o=f,c=h,i=t,Number.isNaN(o)||Number.isNaN(c)||function(e,t,r){e=e.toString(t),t=Math.max(r-e.length,0),r="0".repeat(t);return"".concat(r).concat(e)}(c,i,o.length)!==o.toLowerCase()))throw(0,ie.newError)('number format error: "'.concat(f,'" is NaN in radix ').concat(t,": ").concat(e));s=(l<8?(c=p.fromNumber(Math.pow(t,l)),s.multiply(c)):s=s.multiply(a)).add(p.fromNumber(h))}return s},p.fromValue=function(e,t){return void 0===t&&(t={}),e instanceof p?e:"number"==typeof e?(!0===t.ceilFloat&&(e=Math.ceil(e)),p.fromNumber(e)):"string"==typeof e?p.fromString(e,void 0,t):"bigint"==typeof e?p.fromString(e.toString()):new p(e.low,e.high)},p.toNumber=function(e){switch(typeof e){case"number":return e;case"bigint":return Number(e);default:return p.fromValue(e).toNumber()}},p.toString=function(e,t){return p.fromValue(e).toString(t)},p.inSafeRange=function(e){return p.fromValue(e).inSafeRange()},p.ZERO=p.fromInt(0),p.ONE=p.fromInt(1),p.NEG_ONE=p.fromInt(-1),p.MAX_VALUE=p.fromBits(-1,2147483647),p.MIN_VALUE=p.fromBits(0,-2147483648),p.MIN_SAFE_VALUE=p.fromBits(1,-2097152),p.MAX_SAFE_VALUE=p.fromBits(-1,2097151),p.__isInteger__=!0,p);function p(e,t){this.low=null!=e?e:0,this.high=null!=t?t:0}Object.defineProperty(i.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});var s,se,ue,ce,le,fe,he,pe=4294967296,de=pe*pe/2,_e=i.fromInt(1<<24),a=i.fromValue,a=(o.int=a,i.isInteger),a=(o.isInt=a,i.inSafeRange),a=(o.inSafeRange=a,i.toNumber),a=(o.toNumber=a,i.toString),a=(o.toString=a,o.default=i,{}),i={},u={},ye=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),be=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ye(t,e,r);return be(t,e),t},me=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ge=(Object.defineProperty(u,"__esModule",{value:!0}),u.ENCRYPTION_OFF=u.ENCRYPTION_ON=u.equals=u.validateQueryAndParameters=u.toNumber=u.assertValidDate=u.assertNumberOrInteger=u.assertNumber=u.assertString=u.assertObject=u.isString=u.isObject=u.isEmptyObjectOrNull=void 0,c(o)),ve=n;u.ENCRYPTION_ON="ENCRYPTION_ON";function Oe(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function we(e,t){if(Ee(e))return e;throw new TypeError((0,ve.stringify)(t)+" expected to be string but was: "+(0,ve.stringify)(e))}function Ee(e){return"[object String]"===Object.prototype.toString.call(e)}function Te(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=(0,ce.int)(e),this._maxInteger=(0,ce.int)(t)}function Ce(e,t,r){e=(0,ce.int)(e),t=(0,ce.int)(t),r=(0,ce.int)(r);var n=e.multiply(365);return n=(n=(n=e.greaterThanOrEqual(0)?n.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):n.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(r.subtract(1)),(n=t.greaterThan(2)&&(n=n.subtract(1),!function(e){if((e=(0,ce.int)(e)).modulo(4).equals(0)){if(e.modulo(100).equals(0))return!!e.modulo(400).equals(0);return 1}}(e))?n.subtract(1):n).subtract(s.DAYS_0000_TO_1970)}function Pe(e,t){return(0,le.newError)("".concat(t,' is expected to be a valid ZoneId but was: "').concat(e,'"'))}function Se(e,t,r){if((0,fe.assertNumberOrInteger)(e,r),t.contains(e))return e;throw(0,le.newError)("".concat(r," is expected to be in range ").concat(t.toString()," but was: ").concat(e.toString()))}function Re(e,t){e=(0,ce.int)(e),t=(0,ce.int)(t);var r=e.div(t);return r=e.isPositive()!==t.isPositive()&&r.multiply(t).notEquals(e)?r.subtract(1):r}function Ie(e,t){return e=(0,ce.int)(e),t=(0,ce.int)(t),e.subtract(Re(e,t).multiply(t))}function Ne(e){return(e=(0,ce.int)(e)).equals(0)?"":"."+ke(e,9)}function ke(e,t,r){var n=(e=(0,ce.int)(e)).isNegative(),o=(e=n?e.negate():e).toString();if(null!=t)for(;o.length<t;)o="0"+o;return n?"-"+o:!0===(null==r?void 0:r.usePositiveSign)?"+"+o:o}u.ENCRYPTION_OFF="ENCRYPTION_OFF",u.isEmptyObjectOrNull=function(e){if(null!==e){if(!Oe(e))return!1;for(var t in e)if(void 0!==e[t])return!1}return!0},u.isObject=Oe,u.validateQueryAndParameters=function(e,t,r){var n="",t=null!=t?t:{},r=null!=(r=null==r?void 0:r.skipAsserts)&&r;if("string"==typeof e?n=e:e instanceof String?n=e.toString():"object"==typeof e&&null!=e.text&&(n=e.text,t=null!=(e=e.parameters)?e:{}),!r){e=n;if(we(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.");r=t;if(!Oe(r))throw e=null!=r.constructor?" "+r.constructor.name:"",new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(e," ").concat(JSON.stringify(r)))}return{validatedQuery:n,params:t}},u.assertObject=function(e,t){if(Oe(e))return e;throw new TypeError(t+" expected to be an object but was: "+(0,ve.stringify)(e))},u.assertString=we,u.assertNumber=function(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+(0,ve.stringify)(e));return e},u.assertNumberOrInteger=function(e,t){if("number"==typeof e||"bigint"==typeof e||(0,ge.isInt)(e))return e;throw new TypeError(t+" expected to be either a number or an Integer object but was: "+(0,ve.stringify)(e))},u.assertValidDate=function(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+(0,ve.stringify)(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+(0,ve.stringify)(e));return e},u.isString=Ee,u.equals=function e(t,r){var n,o;if(t!==r){if(null===t||null===r)return!1;if("object"!=typeof t||"object"!=typeof r)return!1;var i=Object.keys(t),a=Object.keys(r);if(i.length!==a.length)return!1;try{for(var s=me(i),u=s.next();!u.done;u=s.next()){var c=u.value;if(!e(t[c],r[c]))return!1}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}return!0},u.toNumber=function(e){return e instanceof ge.default?e.toNumber():"bigint"==typeof e?(0,ge.int)(e).toNumber():e},s=i,se=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),ue=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&se(t,e,r);return ue(t,e),t},Object.defineProperty(s,"__esModule",{value:!0}),s.floorMod=s.floorDiv=s.assertValidZoneId=s.assertValidNanosecond=s.assertValidSecond=s.assertValidMinute=s.assertValidHour=s.assertValidDay=s.assertValidMonth=s.assertValidYear=s.timeZoneOffsetInSeconds=s.totalNanoseconds=s.newDate=s.toStandardDate=s.isoStringToStandardDate=s.dateToIsoString=s.timeZoneOffsetToIsoString=s.timeToIsoString=s.durationToIsoString=s.dateToEpochDay=s.localDateTimeToEpochSecond=s.localTimeToNanoOfDay=s.normalizeNanosecondsForDuration=s.normalizeSecondsForDuration=s.SECONDS_PER_DAY=s.DAYS_PER_400_YEAR_CYCLE=s.DAYS_0000_TO_1970=s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE=s.NANOS_PER_MILLISECOND=s.NANOS_PER_SECOND=s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE=s.MINUTES_PER_HOUR=s.NANOSECOND_OF_SECOND_RANGE=s.SECOND_OF_MINUTE_RANGE=s.MINUTE_OF_HOUR_RANGE=s.HOUR_OF_DAY_RANGE=s.DAY_OF_MONTH_RANGE=s.MONTH_OF_YEAR_RANGE=s.YEAR_RANGE=void 0,ce=c(o),le=r,fe=u,Te.prototype.contains=function(e){var t;return(0,ce.isInt)(e)&&e instanceof ce.default?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):"bigint"==typeof e?(t=(0,ce.int)(e)).greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber},Te.prototype.toString=function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")},c=Te,s.YEAR_RANGE=new c(-999999999,999999999),s.MONTH_OF_YEAR_RANGE=new c(1,12),s.DAY_OF_MONTH_RANGE=new c(1,31),s.HOUR_OF_DAY_RANGE=new c(0,23),s.MINUTE_OF_HOUR_RANGE=new c(0,59),s.SECOND_OF_MINUTE_RANGE=new c(0,59),s.NANOSECOND_OF_SECOND_RANGE=new c(0,999999999),s.MINUTES_PER_HOUR=60,s.SECONDS_PER_MINUTE=60,s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE*s.MINUTES_PER_HOUR,s.NANOS_PER_SECOND=1e9,s.NANOS_PER_MILLISECOND=1e6,s.NANOS_PER_MINUTE=s.NANOS_PER_SECOND*s.SECONDS_PER_MINUTE,s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE*s.MINUTES_PER_HOUR,s.DAYS_0000_TO_1970=719528,s.DAYS_PER_400_YEAR_CYCLE=146097,s.SECONDS_PER_DAY=86400,s.normalizeSecondsForDuration=function(e,t){return(0,ce.int)(e).add(Re(t,s.NANOS_PER_SECOND))},s.normalizeNanosecondsForDuration=function(e){return Ie(e,s.NANOS_PER_SECOND)},s.localTimeToNanoOfDay=function(e,t,r,n){return e=(0,ce.int)(e),t=(0,ce.int)(t),r=(0,ce.int)(r),n=(0,ce.int)(n),(e=(e=(e=e.multiply(s.NANOS_PER_HOUR)).add(t.multiply(s.NANOS_PER_MINUTE))).add(r.multiply(s.NANOS_PER_SECOND))).add(n)},s.localDateTimeToEpochSecond=function(e,t,r,n,o,i,a){return e=Ce(e,t,r),t=function(e,t,r){e=(0,ce.int)(e),t=(0,ce.int)(t),r=(0,ce.int)(r);e=e.multiply(s.SECONDS_PER_HOUR);return(e=e.add(t.multiply(s.SECONDS_PER_MINUTE))).add(r)}(n,o,i),e.multiply(s.SECONDS_PER_DAY).add(t)},s.dateToEpochDay=Ce,s.durationToIsoString=function(e,t,r,n){return e=ke(e),t=ke(t),r=function(e,t){e=(0,ce.int)(e),t=(0,ce.int)(t);var r,n=e.isNegative(),o=t.greaterThan(0);e=n&&o?e.equals(-1)?"-0":e.add(1).toString():e.toString();o&&(r=Ne((n?t.negate().add(2*s.NANOS_PER_SECOND):t.add(s.NANOS_PER_SECOND)).modulo(s.NANOS_PER_SECOND)));return null!=r?e+r:e}(r,n),"P".concat(e,"M").concat(t,"DT").concat(r,"S")},s.timeToIsoString=function(e,t,r,n){return e=ke(e,2),t=ke(t,2),r=ke(r,2),n=Ne(n),"".concat(e,":").concat(t,":").concat(r).concat(n)},s.timeZoneOffsetToIsoString=function(e){var t,r,n;return(e=(0,ce.int)(e)).equals(0)?"Z":(t=(r=e.isNegative())?"-":"+",r=ke((e=r?e.multiply(-1):e).div(s.SECONDS_PER_HOUR),2),n=ke(e.div(s.SECONDS_PER_MINUTE).modulo(s.MINUTES_PER_HOUR),2),null!=(e=(e=e.modulo(s.SECONDS_PER_MINUTE)).equals(0)?null:ke(e,2))?"".concat(t).concat(r,":").concat(n,":").concat(e):"".concat(t).concat(r,":").concat(n))},s.dateToIsoString=function(e,t,r){return e=function(e){e=(0,ce.int)(e);if(e.isNegative()||e.greaterThan(9999))return ke(e,6,{usePositiveSign:!0});return ke(e,4)}(e),t=ke(t,2),r=ke(r,2),"".concat(e,"-").concat(t,"-").concat(r)},s.isoStringToStandardDate=function(e){return new Date(e)},s.toStandardDate=function(e){return new Date(e)},s.newDate=function(e){return new Date(e)},s.totalNanoseconds=function(e,t){return t=null!=t?t:0,e=e.getMilliseconds()*s.NANOS_PER_MILLISECOND,t instanceof ce.default?t.add(e):"bigint"==typeof t?t+BigInt(e):t+e},s.timeZoneOffsetInSeconds=function(e){var t=e.getSeconds()>=e.getUTCSeconds()?e.getSeconds()-e.getUTCSeconds():e.getSeconds()-e.getUTCSeconds()+60;return 0===(e=e.getTimezoneOffset())?0+t:-1*e*s.SECONDS_PER_MINUTE+t},s.assertValidYear=function(e){return Se(e,s.YEAR_RANGE,"Year")},s.assertValidMonth=function(e){return Se(e,s.MONTH_OF_YEAR_RANGE,"Month")},s.assertValidDay=function(e){return Se(e,s.DAY_OF_MONTH_RANGE,"Day")},s.assertValidHour=function(e){return Se(e,s.HOUR_OF_DAY_RANGE,"Hour")},s.assertValidMinute=function(e){return Se(e,s.MINUTE_OF_HOUR_RANGE,"Minute")},s.assertValidSecond=function(e){return Se(e,s.SECOND_OF_MINUTE_RANGE,"Second")},s.assertValidNanosecond=function(e){return Se(e,s.NANOSECOND_OF_SECOND_RANGE,"Nanosecond")},he=new Map,s.assertValidZoneId=function(t,r){var e=he.get(r);if(!0!==e){if(!1===e)throw Pe(r,t);try{Intl.DateTimeFormat(void 0,{timeZone:r}),he.set(r,!0)}catch(e){throw he.set(r,!1),Pe(r,t)}}},s.floorDiv=Re,s.floorMod=Ie;var je=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Ae=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&je(t,e,r);return Ae(t,e),t},De=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},l=(Object.defineProperty(a,"__esModule",{value:!0}),a.isDateTime=a.DateTime=a.isLocalDateTime=a.LocalDateTime=a.isDate=a.Date=a.isTime=a.Time=a.isLocalTime=a.LocalTime=a.isDuration=a.Duration=void 0,c(i)),Me=u,Ue=r,Le=c(o),c={value:!0,enumerable:!1,configurable:!1,writable:!1},xe="__isDuration__",Be="__isLocalTime__",Fe="__isTime__",qe="__isDate__",He="__isLocalDateTime__",Ve="__isDateTime__",f=(ze.prototype.toString=function(){return l.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)},ze);function ze(e,t,r,n){this.months=(0,Me.assertNumberOrInteger)(e,"Months"),this.days=(0,Me.assertNumberOrInteger)(t,"Days"),(0,Me.assertNumberOrInteger)(r,"Seconds"),(0,Me.assertNumberOrInteger)(n,"Nanoseconds"),this.seconds=l.normalizeSecondsForDuration(r,n),this.nanoseconds=l.normalizeNanosecondsForDuration(n),Object.freeze(this)}a.Duration=f,Object.defineProperty(f.prototype,xe,c),a.isDuration=function(e){return Qe(e,xe)};We.fromStandardDate=function(e,t){Je(e,t);t=l.totalNanoseconds(e,t);return new We(e.getHours(),e.getMinutes(),e.getSeconds(),t instanceof Le.default?t.toInt():"bigint"==typeof t?(0,Le.int)(t).toInt():t)},We.prototype.toString=function(){return l.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)};f=We;function We(e,t,r,n){this.hour=l.assertValidHour(e),this.minute=l.assertValidMinute(t),this.second=l.assertValidSecond(r),this.nanosecond=l.assertValidNanosecond(n),Object.freeze(this)}a.LocalTime=f,Object.defineProperty(f.prototype,Be,c),a.isLocalTime=function(e){return Qe(e,Be)};Ge.fromStandardDate=function(e,t){return Je(e,t),new Ge(e.getHours(),e.getMinutes(),e.getSeconds(),(0,Le.toNumber)(l.totalNanoseconds(e,t)),l.timeZoneOffsetInSeconds(e))},Ge.prototype.toString=function(){return l.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+l.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)};f=Ge;function Ge(e,t,r,n,o){this.hour=l.assertValidHour(e),this.minute=l.assertValidMinute(t),this.second=l.assertValidSecond(r),this.nanosecond=l.assertValidNanosecond(n),this.timeZoneOffsetSeconds=(0,Me.assertNumberOrInteger)(o,"Time zone offset in seconds"),Object.freeze(this)}a.Time=f,Object.defineProperty(f.prototype,Fe,c),a.isTime=function(e){return Qe(e,Fe)};Ke.fromStandardDate=function(e){return Je(e),new Ke(e.getFullYear(),e.getMonth()+1,e.getDate())},Ke.prototype.toStandardDate=function(){return l.isoStringToStandardDate(this.toString())},Ke.prototype.toString=function(){return l.dateToIsoString(this.year,this.month,this.day)};f=Ke;function Ke(e,t,r){this.year=l.assertValidYear(e),this.month=l.assertValidMonth(t),this.day=l.assertValidDay(r),Object.freeze(this)}a.Date=f,Object.defineProperty(f.prototype,qe,c),a.isDate=function(e){return Qe(e,qe)};Ye.fromStandardDate=function(e,t){return Je(e,t),new Ye(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,Le.toNumber)(l.totalNanoseconds(e,t)))},Ye.prototype.toStandardDate=function(){return l.isoStringToStandardDate(this.toString())},Ye.prototype.toString=function(){return Xe(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)};f=Ye;function Ye(e,t,r,n,o,i,a){this.year=l.assertValidYear(e),this.month=l.assertValidMonth(t),this.day=l.assertValidDay(r),this.hour=l.assertValidHour(n),this.minute=l.assertValidMinute(o),this.second=l.assertValidSecond(i),this.nanosecond=l.assertValidNanosecond(a),Object.freeze(this)}a.LocalDateTime=f,Object.defineProperty(f.prototype,He,c),a.isLocalDateTime=function(e){return Qe(e,He)};Ze.fromStandardDate=function(e,t){return Je(e,t),new Ze(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,Le.toNumber)(l.totalNanoseconds(e,t)),l.timeZoneOffsetInSeconds(e),null)},Ze.prototype.toStandardDate=function(){return l.toStandardDate(this._toUTC())},Ze.prototype.toString=function(){var e;return Xe(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?l.timeZoneOffsetToIsoString(null!=(e=this.timeZoneOffsetSeconds)?e:0):"")+(null!=this.timeZoneId?"[".concat(this.timeZoneId,"]"):"")},Ze.prototype._toUTC=function(){if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var e=l.localDateTimeToEpochSecond(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(null!=(e=this.timeZoneOffsetSeconds)?e:0);return(0,Le.int)(e).multiply(1e3).add((0,Le.int)(this.nanosecond).div(1e6)).toNumber()};f=Ze;function Ze(e,t,r,n,o,i,a,s,u){this.year=l.assertValidYear(e),this.month=l.assertValidMonth(t),this.day=l.assertValidDay(r),this.hour=l.assertValidHour(n),this.minute=l.assertValidMinute(o),this.second=l.assertValidSecond(i),this.nanosecond=l.assertValidNanosecond(a);e=De(function(e,t){var r=null!=e,n=null!=t&&""!==t;if(!r&&!n)throw(0,Ue.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t));var o=[void 0,void 0];r&&((0,Me.assertNumberOrInteger)(e,"Time zone offset in seconds"),o[0]=e);n&&((0,Me.assertString)(t,"Time zone ID"),l.assertValidZoneId("Time zone ID",t),o[1]=t);return o}(s,u),2),t=e[0],r=e[1];this.timeZoneOffsetSeconds=t,this.timeZoneId=null!=r?r:void 0,Object.freeze(this)}function Qe(e,t){return null!=e&&!0===e[t]}function Xe(e,t,r,n,o,i,a){return l.dateToIsoString(e,t,r)+"T"+l.timeToIsoString(n,o,i,a)}function Je(e,t){(0,Me.assertValidDate)(e,"Standard date"),null!=t&&(0,Me.assertNumberOrInteger)(t,"Nanosecond")}a.DateTime=f,Object.defineProperty(f.prototype,Ve,c),a.isDateTime=function(e){return Qe(e,Ve)};var f={},$e=(Object.defineProperty(f,"__esModule",{value:!0}),f.isPathSegment=f.PathSegment=f.isPath=f.Path=f.isUnboundRelationship=f.UnboundRelationship=f.isRelationship=f.Relationship=f.isNode=f.Node=void 0,n),c={value:!0,enumerable:!1,configurable:!1,writable:!1},et="__isNode__",tt="__isRelationship__",rt="__isUnboundRelationship__",nt="__isPath__",ot="__isPathSegment__";function it(e,t){return null!=e&&!0===e[t]}at.prototype.toString=function(){for(var e="("+this.elementId,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var r=Object.keys(this.properties);if(0<r.length){e+=" {";for(t=0;t<r.length;t++)0<t&&(e+=","),e+=r[t]+":"+(0,$e.stringify)(this.properties[r[t]]);e+="}"}return e+=")"};var h=at;function at(e,t,r,n){this.identity=e,this.labels=t,this.properties=r,this.elementId=ht(n,function(){return e.toString()})}f.Node=h,Object.defineProperty(h.prototype,et,c),f.isNode=function(e){return it(e,et)};ut.prototype.toString=function(){var e="("+this.startNodeElementId+")-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,$e.stringify)(this.properties[t[r]]);e+="}"}return e+="]->("+this.endNodeElementId+")"};var st=ut;function ut(e,t,r,n,o,i,a,s){this.identity=e,this.start=t,this.end=r,this.type=n,this.properties=o,this.elementId=ht(i,function(){return e.toString()}),this.startNodeElementId=ht(a,function(){return t.toString()}),this.endNodeElementId=ht(s,function(){return r.toString()})}f.Relationship=st,Object.defineProperty(st.prototype,tt,c),f.isRelationship=function(e){return it(e,tt)};ct.prototype.bind=function(e,t){return new st(this.identity,e,t,this.type,this.properties,this.elementId)},ct.prototype.bindTo=function(e,t){return new st(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)},ct.prototype.toString=function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,$e.stringify)(this.properties[t[r]]);e+="}"}return e+="]->"};h=ct;function ct(e,t,r,n){this.identity=e,this.type=t,this.properties=r,this.elementId=ht(n,function(){return e.toString()})}f.UnboundRelationship=h,Object.defineProperty(h.prototype,rt,c),f.isUnboundRelationship=function(e){return it(e,rt)};function lt(e,t,r){this.start=e,this.relationship=t,this.end=r}f.PathSegment=lt,Object.defineProperty(lt.prototype,ot,c),f.isPathSegment=function(e){return it(e,ot)};function ft(e,t,r){this.start=e,this.end=t,this.segments=r,this.length=r.length}function ht(e,t){return null==e?t():e}f.Path=ft,Object.defineProperty(ft.prototype,nt,c),f.isPath=function(e){return it(e,nt)};var h={},pt=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},dt=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_t=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},yt=(Object.defineProperty(h,"__esModule",{value:!0}),r);function bt(e,t,r){var n;this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=null!=r?r:(n={},e.forEach(function(e,t){n[e]=t}),n)}bt.prototype.forEach=function(e){var t,r;try{for(var n=dt(this.entries()),o=n.next();!o.done;o=n.next()){var i=_t(o.value,2),a=i[0];e(i[1],a,this)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},bt.prototype.map=function(e){var t,r,n=[];try{for(var o=dt(this.entries()),i=o.next();!i.done;i=o.next()){var a=_t(i.value,2),s=a[0],u=a[1];n.push(e(u,s,this))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},bt.prototype.entries=function(){var t;return pt(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,[this.keys[t],this._fields[t]]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},bt.prototype.values=function(){var t;return pt(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},bt.prototype[Symbol.iterator]=function(){var t;return pt(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},bt.prototype.toObject=function(){var t,e,r={};try{for(var n=dt(this.entries()),o=n.next();!o.done;o=n.next()){var i=_t(o.value,2),a=i[0],s=i[1];r[a]=s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},bt.prototype.get=function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,yt.newError)("This record has no field with key '".concat(e.toString(),"', available keys are: [")+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,yt.newError)("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]},bt.prototype.has=function(e){return"number"==typeof e?0<=e&&e<this._fields.length:void 0!==this._fieldLookup[e]},h.default=bt;var c={},mt=(Object.defineProperty(c,"__esModule",{value:!0}),c.isPoint=c.Point=void 0,u),gt="__isPoint__",vt=(Ot.prototype.toString=function(){return null==this.z||isNaN(this.z)?"Point{srid=".concat(wt(this.srid),", x=").concat(wt(this.x),", y=").concat(wt(this.y),"}"):"Point{srid=".concat(wt(this.srid),", x=").concat(wt(this.x),", y=").concat(wt(this.y),", z=").concat(wt(this.z),"}")},Ot);function Ot(e,t,r,n){this.srid=(0,mt.assertNumberOrInteger)(e,"SRID"),this.x=(0,mt.assertNumber)(t,"X coordinate"),this.y=(0,mt.assertNumber)(r,"Y coordinate"),this.z=null==n?n:(0,mt.assertNumber)(n,"Z coordinate"),Object.freeze(this)}function wt(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}c.Point=vt,Object.defineProperty(vt.prototype,gt,{value:!0,enumerable:!1,configurable:!1,writable:!1}),c.isPoint=function(e){return null!=e&&!0===e[gt]};var vt={},d={},_={},y=(Object.defineProperty(_,"__esModule",{value:!0}),_.FailedObserver=_.CompletedObserver=void 0,Et.prototype.subscribe=function(e){Ct(e,e.onKeys,[]),Ct(e,e.onCompleted,{})},Et.prototype.cancel=function(){},Et.prototype.pause=function(){},Et.prototype.resume=function(){},Et.prototype.prepareToHandleSingleResponse=function(){},Et.prototype.markCompleted=function(){},Et.prototype.onError=function(e){throw new Error("CompletedObserver not supposed to call onError",{cause:e})},Et);function Et(){}function Tt(e){var t=e.error,e=e.onError;this._error=t,this._beforeError=e,this._observers=[],this.onError(t)}function Ct(e,t,r){null!=t&&t.bind(e)(r)}_.CompletedObserver=y,Tt.prototype.subscribe=function(e){Ct(e,e.onError,this._error),this._observers.push(e)},Tt.prototype.onError=function(t){Ct(this,this._beforeError,t),this._observers.forEach(function(e){return Ct(e,e.onError,t)})},Tt.prototype.cancel=function(){},Tt.prototype.pause=function(){},Tt.prototype.resume=function(){},Tt.prototype.markCompleted=function(){},Tt.prototype.prepareToHandleSingleResponse=function(){},_.FailedObserver=Tt;var y={},Pt=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),St=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),b=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Pt(t,e,r);return St(t,e),t},Rt=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},It=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Nt=(Object.defineProperty(y,"__esModule",{value:!0}),y.Bookmarks=void 0,b(u)),b=(kt.empty=function(){return jt},kt.prototype.isEmpty=function(){return 0===this._values.length},kt.prototype.values=function(){return this._values},kt.prototype[Symbol.iterator]=function(){return this._values[Symbol.iterator]()},kt.prototype.asBeginTransactionParameters=function(){var e;return this.isEmpty()?{}:((e={}).bookmarks=this._values,e)},kt);function kt(e){this._values=function(e){if(null==e||""===e)return[];if(Nt.isString(e))return[e];if(Array.isArray(e)){for(var t=new Set,r=function r(e){return e.reduce(function(e,t){return Array.isArray(t)?e.concat(r(t)):e.concat(t)},[])}(e),n=0;n<r.length;n++){var o=r[n];if(null!=o){if(!Nt.isString(o))throw new TypeError("Bookmark value should be a string, given: '".concat(o,"'"));t.add(o)}}return It([],Rt(t),!1)}throw new TypeError("Bookmarks should either be a string or a string array, given: '".concat(e,"'"))}(e)}var jt=new(y.Bookmarks=b)(null);var At,Dt,b={},m=(Object.defineProperty(b,"__esModule",{value:!0}),b.TELEMETRY_APIS=b.BOLT_PROTOCOL_V5_7=b.BOLT_PROTOCOL_V5_6=b.BOLT_PROTOCOL_V5_5=b.BOLT_PROTOCOL_V5_4=b.BOLT_PROTOCOL_V5_3=b.BOLT_PROTOCOL_V5_2=b.BOLT_PROTOCOL_V5_1=b.BOLT_PROTOCOL_V5_0=b.BOLT_PROTOCOL_V4_4=b.BOLT_PROTOCOL_V4_3=b.BOLT_PROTOCOL_V4_2=b.BOLT_PROTOCOL_V4_1=b.BOLT_PROTOCOL_V4_0=b.BOLT_PROTOCOL_V3=b.BOLT_PROTOCOL_V2=b.BOLT_PROTOCOL_V1=b.DEFAULT_POOL_MAX_SIZE=b.DEFAULT_POOL_ACQUISITION_TIMEOUT=b.DEFAULT_CONNECTION_TIMEOUT_MILLIS=b.ACCESS_MODE_WRITE=b.ACCESS_MODE_READ=b.FETCH_ALL=void 0,b.FETCH_ALL=-1,b.DEFAULT_POOL_ACQUISITION_TIMEOUT=6e4,b.DEFAULT_POOL_MAX_SIZE=100,b.DEFAULT_CONNECTION_TIMEOUT_MILLIS=3e4,b.ACCESS_MODE_READ="READ",b.ACCESS_MODE_WRITE="WRITE",b.BOLT_PROTOCOL_V1=1,b.BOLT_PROTOCOL_V2=2,b.BOLT_PROTOCOL_V3=3,b.BOLT_PROTOCOL_V4_0=4,b.BOLT_PROTOCOL_V4_1=4.1,b.BOLT_PROTOCOL_V4_2=4.2,b.BOLT_PROTOCOL_V4_3=4.3,b.BOLT_PROTOCOL_V4_4=4.4,b.BOLT_PROTOCOL_V5_0=5,b.BOLT_PROTOCOL_V5_1=5.1,b.BOLT_PROTOCOL_V5_2=5.2,b.BOLT_PROTOCOL_V5_3=5.3,b.BOLT_PROTOCOL_V5_4=5.4,b.BOLT_PROTOCOL_V5_5=5.5,b.BOLT_PROTOCOL_V5_6=5.6,b.BOLT_PROTOCOL_V5_7=5.7,b.TELEMETRY_APIS={MANAGED_TRANSACTION:0,UNMANAGED_TRANSACTION:1,AUTO_COMMIT_TRANSACTION:2,EXECUTE_QUERY:3},{}),g={},v=e&&e.__extends||(At=function(e,t){return(At=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}At(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Mt=(Object.defineProperty(g,"__esModule",{value:!0}),g.Logger=void 0,r),Ut="error",Lt="warn",xt="info",Bt="debug",Ft=((O={})[Ut]=0,O[Lt]=1,O[xt]=2,O[Bt]=3,O),O=(qt.create=function(e){return null!=(null==e?void 0:e.logging)?new qt(function(e){if(null==(null==e?void 0:e.level))return"info";var e=e.level,t=Ft[e];if(null!=t||0===t)return e;throw(0,Mt.newError)("Illegal logging level: ".concat(e,". Supported levels are: ").concat(Object.keys(Ft).toString()))}(e=e.logging),function(e){if(null!=(null==e?void 0:e.logger)){var t=e.logger;if(null!=t&&"function"==typeof t)return t}throw(0,Mt.newError)("Illegal logger function: ".concat(null!=(e=null==(t=null==e?void 0:e.logger)?void 0:t.toString())?e:"undefined"))}(e)):this.noOp()},qt.noOp=function(){return Vt},qt.prototype.isErrorEnabled=function(){return zt(this._level,Ut)},qt.prototype.error=function(e){this.isErrorEnabled()&&this._loggerFunction(Ut,e)},qt.prototype.isWarnEnabled=function(){return zt(this._level,Lt)},qt.prototype.warn=function(e){this.isWarnEnabled()&&this._loggerFunction(Lt,e)},qt.prototype.isInfoEnabled=function(){return zt(this._level,xt)},qt.prototype.info=function(e){this.isInfoEnabled()&&this._loggerFunction(xt,e)},qt.prototype.isDebugEnabled=function(){return zt(this._level,Bt)},qt.prototype.debug=function(e){this.isDebugEnabled()&&this._loggerFunction(Bt,e)},qt);function qt(e,t){this._level=e,this._loggerFunction=t}function Ht(){return Dt.call(this,xt,function(e,t){})||this}g.Logger=O,v(Ht,Dt=O),Ht.prototype.isErrorEnabled=function(){return!1},Ht.prototype.error=function(e){},Ht.prototype.isWarnEnabled=function(){return!1},Ht.prototype.warn=function(e){},Ht.prototype.isInfoEnabled=function(){return!1},Ht.prototype.info=function(e){},Ht.prototype.isDebugEnabled=function(){return!1},Ht.prototype.debug=function(e){};var Vt=new Ht;function zt(e,t){return Ft[t]<=Ft[e]}var Wt,v=e&&e.__extends||(Wt=function(e,t){return(Wt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Wt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Gt=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Kt=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Yt=(Object.defineProperty(m,"__esModule",{value:!0}),m.EMPTY_CONNECTION_HOLDER=m.ReadOnlyConnectionHolder=m.ConnectionHolder=void 0,r),Zt=u,Qt=b,Xt=y,Jt=g,O=($t.prototype.mode=function(){return this._mode},$t.prototype.database=function(){return this._database},$t.prototype.setDatabase=function(e){this._database=e},$t.prototype.bookmarks=function(){return this._bookmarks},$t.prototype.connectionProvider=function(){return this._connectionProvider},$t.prototype.referenceCount=function(){return this._referenceCount},$t.prototype.initializeConnection=function(){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider),this._referenceCount++,!0)},$t.prototype._createConnectionPromise=function(o){return Gt(this,void 0,void 0,function(){var t,r,n;return Kt(this,function(e){switch(e.label){case 0:return r=(t=o).acquireConnection,n={accessMode:this._mode,database:this._database},[4,this._getBookmarks()];case 1:return[4,r.apply(t,[(n.bookmarks=e.sent(),n.impersonatedUser=this._impersonatedUser,n.onDatabaseNameResolved=this._onDatabaseNameResolved,n.auth=this._auth,n)])];case 2:return[2,e.sent()]}})})},$t.prototype._getBookmarks=function(){return Gt(this,void 0,void 0,function(){return Kt(this,function(e){switch(e.label){case 0:return[4,this._getConnectionAcquistionBookmarks()];case 1:return[2,e.sent()]}})})},$t.prototype.getConnection=function(){return this._connectionPromise},$t.prototype.releaseConnection=function(){return 0!==this._referenceCount&&(this._referenceCount--,0===this._referenceCount)?this._releaseConnection():this._connectionPromise},$t.prototype.close=function(e){return this._closed=!0,0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))},$t.prototype.log=function(){return this._log},$t.prototype._releaseConnection=function(t){return this._connectionPromise=this._connectionPromise.then(function(e){return null!=e?e.isOpen()&&(e.hasOngoingObservableRequests()||!0===t)?e.resetAndFlush().catch(or).then(function(){return e.release().then(function(){return null})}):e.release().then(function(){return null}):Promise.resolve(null)}).catch(this._logError),this._connectionPromise},$t.prototype._logError=function(e){return this._log.isWarnEnabled()&&this._log.warn("ConnectionHolder got an error while releasing the connection. Error ".concat(e,". Stacktrace: ").concat(e.stack)),null},$t);function $t(e){var t=e.mode,r=e.database,r=void 0===r?"":r,n=e.bookmarks,o=e.connectionProvider,i=e.impersonatedUser,a=e.onDatabaseNameResolved,s=e.getConnectionAcquistionBookmarks,u=e.auth,e=e.log;this._mode=null!=t?t:Qt.ACCESS_MODE_WRITE,this._closed=!1,this._database=null!=r?(0,Zt.assertString)(r,"database"):"",this._bookmarks=null!=n?n:Xt.Bookmarks.empty(),this._connectionProvider=o,this._impersonatedUser=i,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=a,this._auth=u,this._log=e,this._logError=this._logError.bind(this),this._getConnectionAcquistionBookmarks=null!=s?s:function(){return Promise.resolve(Xt.Bookmarks.empty())}}m.ConnectionHolder=O;v(rr,er=O),rr.prototype.initializeConnection=function(){return 0!==this._connectionHolder.referenceCount()},rr.prototype.getConnection=function(){return this._connectionHolder.getConnection()},rr.prototype.releaseConnection=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},rr.prototype.close=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})};var er,tr,w=rr;function rr(e){var t=er.call(this,{mode:e.mode(),database:e.database(),bookmarks:e.bookmarks(),getConnectionAcquistionBookmarks:e._getConnectionAcquistionBookmarks,connectionProvider:e.connectionProvider(),log:e.log()})||this;return t._connectionHolder=e,t}function nr(){return tr.call(this,{log:Jt.Logger.create({})})||this}m.ReadOnlyConnectionHolder=w,m.default=w,v(nr,tr=O),nr.prototype.mode=function(){},nr.prototype.database=function(){},nr.prototype.initializeConnection=function(){return!0},nr.prototype.getConnection=function(){return Gt(this,void 0,void 0,function(){return Kt(this,function(e){switch(e.label){case 0:return[4,Promise.reject((0,Yt.newError)("This connection holder does not serve connections"))];case 1:return[2,e.sent()]}})})},nr.prototype.releaseConnection=function(){return Gt(this,void 0,void 0,function(){return Kt(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},nr.prototype.close=function(){return Gt(this,void 0,void 0,function(){return Kt(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})};w=new nr;function or(e){return null}m.EMPTY_CONNECTION_HOLDER=w;var v={},ir=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),ar=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),O=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ir(t,e,r);return ar(t,e),t},sr=(Object.defineProperty(v,"__esModule",{value:!0}),v.TxConfig=void 0,O(u)),ur=r,cr=o,w=(lr.empty=function(){return fr},lr.prototype.isEmpty=function(){return Object.values(this).every(function(e){return null==e})},lr);function lr(e,t){var r;null!=(r=e)&&sr.assertObject(r,"Transaction config"),this.timeout=function(e,t){if(sr.isObject(e)&&null!=e.timeout){sr.assertNumberOrInteger(e.timeout,"Transaction timeout"),!function(e){return"number"==typeof e.timeout&&!Number.isInteger(e.timeout)}(e)||!0!==(null==t?void 0:t.isInfoEnabled())||null==t||t.info("Transaction timeout expected to be an integer, got: ".concat(e.timeout,". The value will be rounded up."));t=(0,cr.int)(e.timeout,{ceilFloat:!0});if(t.isNegative())throw(0,ur.newError)("Transaction timeout should not be negative");return t}return null}(e,t),this.metadata=function(e){if(sr.isObject(e)&&null!=e.metadata){e=e.metadata;if(sr.assertObject(e,"config.metadata"),0!==Object.keys(e).length)return e}return null}(e)}var fr=new(v.TxConfig=w)({});var O={},hr=e&&e.__assign||function(){return(hr=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},pr=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},dr=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},_r=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},yr=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},br=(Object.defineProperty(O,"__esModule",{value:!0}),O.TransactionExecutor=void 0,r),mr=b;function gr(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,yr([e,t],_r(r),!1))}function vr(e){return clearTimeout(e)}function Or(e,t,r,n,o){void 0===o&&(o={setTimeout:gr,clearTimeout:vr}),this._maxRetryTimeMs=wr(e,3e4),this._initialRetryDelayMs=wr(t,1e3),this._multiplier=wr(r,2),this._jitterFactor=wr(n,.2),this._setTimeout=o.setTimeout,this._clearTimeout=o.clearTimeout,this._inFlightTimeoutIds=[],this.pipelineBegin=!1,this.telemetryApi=mr.TELEMETRY_APIS.MANAGED_TRANSACTION,this._verifyAfterConstruction()}function wr(e,t){return null!=e?e:t}Or.prototype.execute=function(n,o,i){var a=this,s={apiTransactionConfig:{api:this.telemetryApi,onTelemetrySuccess:function(){s.apiTransactionConfig=void 0}}};return new Promise(function(e,t){a._executeTransactionInsidePromise(n,o,e,t,i,s).catch(t)}).catch(function(e){var t=Date.now(),r=a._initialRetryDelayMs;return a._retryTransactionPromise(n,o,e,t,r,i,s)})},Or.prototype.close=function(){var t=this;this._inFlightTimeoutIds.forEach(function(e){return t._clearTimeout(e)}),this._inFlightTimeoutIds=[]},Or.prototype._retryTransactionPromise=function(o,i,e,r,a,s,u){var c=this;return Date.now()-r>this._maxRetryTimeMs||!(0,br.isRetriableError)(e)?Promise.reject(e):new Promise(function(e,t){var r=c._computeDelayWithJitter(a),n=c._setTimeout(function(){c._inFlightTimeoutIds=c._inFlightTimeoutIds.filter(function(e){return e!==n}),c._executeTransactionInsidePromise(o,i,e,t,s,u).catch(t)},r);c._inFlightTimeoutIds.push(n)}).catch(function(e){var t=a*c._multiplier;return c._retryTransactionPromise(o,i,e,r,t,s,u)})},Or.prototype._executeTransactionInsidePromise=function(a,s,u,c,l,f){return pr(this,void 0,void 0,function(){var t,r,n,o,i=this;return dr(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),r=a(null!=(null==f?void 0:f.apiTransactionConfig)?hr({},null==f?void 0:f.apiTransactionConfig):void 0),this.pipelineBegin)?(n=r,[3,3]):[3,1];case 1:return[4,r];case 2:n=e.sent(),e.label=3;case 3:return t=n,[3,5];case 4:return o=e.sent(),c(o),[2];case 5:return o=(null!=l?l:function(e){return e})(t),this._safeExecuteTransactionWork(o,s).then(function(e){return i._handleTransactionWorkSuccess(e,t,u,c)}).catch(function(e){return i._handleTransactionWorkFailure(e,t,c)}),[2]}})})},Or.prototype._safeExecuteTransactionWork=function(e,t){try{var r=t(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}},Or.prototype._handleTransactionWorkSuccess=function(e,t,r,n){t.isOpen()?t.commit().then(function(){r(e)}).catch(function(e){n(e)}):r(e)},Or.prototype._handleTransactionWorkFailure=function(e,t,r){t.isOpen()?t.rollback().catch(function(e){}).then(function(){return r(e)}).catch(r):r(e)},Or.prototype._computeDelayWithJitter=function(e){var t=e*this._jitterFactor,r=e-t,e=e+t;return Math.random()*(e-r)+r},Or.prototype._verifyAfterConstruction=function(){if(this._maxRetryTimeMs<0)throw(0,br.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw(0,br.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw(0,br.newError)("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||1<this._jitterFactor)throw(0,br.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())},O.TransactionExecutor=Or;var w={},Er=e&&e.__assign||function(){return(Er=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Tr=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},Cr=(Object.defineProperty(w,"__esModule",{value:!0}),w.Url=w.formatIPv6Address=w.formatIPv4Address=w.defaultPortForScheme=w.parseDatabaseUrl=void 0,u),Pr=7687,Sr=7474,Rr=7473,Ir=function(e,t,r,n,o){this.scheme=e,this.host=t,this.port=r,this.hostAndPort=n,this.query=o};function Nr(e,t,r){if(""===(e=(null!=e?e:"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(r,"'"));return e}function kr(e){var t="["===e.charAt(0),r="]"===e.charAt(e.length-1);if(t||r){if(t&&r)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function jr(e){return"http"===e?Sr:"https"===e?Rr:Pr}w.Url=Ir,w.parseDatabaseUrl=function(e){(0,Cr.assertString)(e,"URL");var t=function(e){function a(e,t){t=e.indexOf(t);return 0<=t?[e.substring(0,t),e[t],e.substring(t+1)]:[e,"",""]}function t(e){var t,r={},n=((t="@")===(t=0<=(t=(o=e).lastIndexOf(t))?[o.substring(0,t),o[t],o.substring(t+1)]:["","",o])[1]&&(r.userInfo=decodeURIComponent(t[0]),e=t[2]),Tr((o="]",n=a(n=e,i="["),[(i=a(n[2],o))[0],i[2]]),2)),o=n[0],i=n[1];return""!==o?(r.host=o,t=a(i,":")):(t=a(e,":"),r.host=t[0]),":"===t[1]&&(r.port=t[2]),r}var r,n={};":"===(r=a(e,":"))[1]&&(n.scheme=decodeURIComponent(r[0]),e=r[2]);"#"===(r=a(e,"#"))[1]&&(n.fragment=decodeURIComponent(r[2]),e=r[0]);"?"===(r=a(e,"?"))[1]&&(n.query=r[2],e=r[0]);e.startsWith("//")?(r=a(e.substr(2),"/"),(n=Er(Er({},n),t(r[0]))).path=r[1]+r[2]):n.path=e;return n}((r=(r=(r=e).trim()).includes("://")?{schemeMissing:!1,url:r}:{schemeMissing:!0,url:"none://".concat(r)}).url),r=r.schemeMissing?null:function(e){if(null==e)return null;":"===(e=e.trim()).charAt(e.length-1)&&(e=e.substring(0,e.length-1));return e}(t.scheme),n=function(e){if(null!=e)return e.trim();throw new Error("Unable to extract host from null or undefined URL")}(t.host),o=function(e){if(""===e||null==e)throw new Error("Illegal host ".concat(e));return e.includes(":")?kr(e):e}(n),i=function(e,t){e="string"==typeof e?parseInt(e,10):e;return null==e||isNaN(e)?jr(t):e}(t.port,r),o="".concat(o,":").concat(i),a=function(e,r){var e=null!=e?function(e){"?"===(null==(e=(null!=e?e:"").trim())?void 0:e.charAt(0))&&(e=e.substring(1,e.length));return e}(e):null,n={};null!=e&&e.split("&").forEach(function(e){e=e.split("=");if(2!==e.length)throw new Error("Invalid parameters: '".concat(e.toString(),"' in URL '").concat(r,"'."));var t=Nr(e[0],"key",r),e=Nr(e[1],"value",r);if(void 0!==n[t])throw new Error("Duplicated query parameters with key '".concat(t,"' in URL '").concat(r,"'"));n[t]=e});return n}(null!=(a=t.query)?a:function(e){if("string"!=typeof e)return null;return Tr(e.split("?"),2)[1]}(t.resourceName),e);return new Ir(r,n,i,o,a)},w.formatIPv4Address=function(e,t){return"".concat(e,":").concat(t)},w.formatIPv6Address=function(e,t){return e=kr(e),"".concat(e,":").concat(t)},w.defaultPortForScheme=jr;var Ar={},Dr=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Mr=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),E=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Dr(t,e,r);return Mr(t,e),t},Ur=(Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.ServerAddress=void 0,u),Lr=E(w);function xr(e,t,r,n){this._host=(0,Ur.assertString)(e,"host"),this._resolved=null!=t?(0,Ur.assertString)(t,"resolved"):null,this._port=(0,Ur.assertNumber)(r,"port"),this._hostPort=n,this._stringValue=null!=t?"".concat(n,"(").concat(t,")"):"".concat(n)}xr.prototype.host=function(){return this._host},xr.prototype.resolvedHost=function(){return null!=this._resolved?this._resolved:this._host},xr.prototype.port=function(){return this._port},xr.prototype.resolveWith=function(e){return new xr(this._host,e,this._port,this._hostPort)},xr.prototype.asHostPort=function(){return this._hostPort},xr.prototype.asKey=function(){return this._hostPort},xr.prototype.toString=function(){return this._stringValue},xr.fromUrl=function(e){e=Lr.parseDatabaseUrl(e);return new xr(e.host,null,e.port,e.hostAndPort)},Ar.ServerAddress=xr;var E={},T={};function Br(){}Object.defineProperty(T,"__esModule",{value:!0}),Br.prototype.resolve=function(){throw new Error("Abstract function")},Br.prototype._resolveToItself=function(e){return Promise.resolve([e])},T.default=Br;var C={},Fr=(Object.defineProperty(C,"__esModule",{value:!0}),Ar);function qr(e){return Promise.resolve([e])}function Hr(e){this._resolverFunction=null!=e?e:qr}Hr.prototype.resolve=function(t){var r=this;return new Promise(function(e){return e(r._resolverFunction(t.asHostPort()))}).then(function(e){if(Array.isArray(e))return e.map(function(e){return Fr.ServerAddress.fromUrl(e)});throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e))})},C.default=Hr;var Vr,P=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},T=(Object.defineProperty(E,"__esModule",{value:!0}),E.ConfiguredCustomResolver=E.BaseHostNameResolver=void 0,P(T)),T=(E.BaseHostNameResolver=T.default,P(C)),P=(E.ConfiguredCustomResolver=T.default,{}),T={};Object.defineProperty(T,"__esModule",{value:!0}),T.fromVersion=void 0,T.fromVersion=function(e,t){var r=null!=(t=(t=void 0===t?function(){return{get userAgent(){}}}:t)()).userAgent?t.userAgent.split("(")[1].split(")")[0]:void 0,t=t.userAgent||void 0;return{product:"neo4j-javascript/".concat(e),platform:r,languageDetails:t}},S=P,Vr=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),zr=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Vr(t,e,r)},Object.defineProperty(S,"__esModule",{value:!0}),zr(T,S);var zr={},T={},S=(Object.defineProperty(T,"__esModule",{value:!0}),T.DEFAULT_ACQUISITION_TIMEOUT=T.DEFAULT_MAX_SIZE=void 0,T.DEFAULT_MAX_SIZE=100,T.DEFAULT_ACQUISITION_TIMEOUT=6e4,Wr.defaultConfig=function(){return new Wr(100,6e4)},Wr.fromDriverConfig=function(e){return new Wr(Kr(e.maxConnectionPoolSize)?e.maxConnectionPoolSize:100,Kr(e.connectionAcquisitionTimeout)?e.connectionAcquisitionTimeout:6e4)},Wr);function Wr(e,t){this.maxSize=Gr(e,100),this.acquisitionTimeout=Gr(t,6e4)}function Gr(e,t){return Kr(e)?e:t}function Kr(e){return 0===e||null!=e}T.default=S;var S={},Yr=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Zr=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},R=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Qr=(Object.defineProperty(S,"__esModule",{value:!0}),R(T)),Xr=r,Jr=g,R=($r.prototype.acquire=function(s,u,c){return Yr(this,void 0,void 0,function(){var o,i,a=this;return Zr(this,function(e){switch(e.label){case 0:return o=u.asKey(),i=this._acquireRequests,null==i[o]&&(i[o]=[]),[4,new Promise(function(e,t){var r=setTimeout(function(){var e,t=i[o];null!=t&&(i[o]=t.filter(function(e){return e!==n})),n.isCompleted()||(t=a.activeResourceCount(u),e=a.has(u)?a._pools[o].length:0,n.reject((0,Xr.newError)("Connection acquisition timed out in ".concat(a._acquisitionTimeout," ms. Pool status: Active conn count = ").concat(t,", Idle conn count = ").concat(e,"."))))},a._acquisitionTimeout),n=("object"==typeof r&&r.unref(),new rn(o,s,c,e,t,r,a._log));i[o].push(n),a._processPendingAcquireRequests(u)})];case 1:return[2,e.sent()]}})})},$r.prototype.purge=function(t){return Yr(this,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t.asKey())];case 1:return[2,e.sent()]}})})},$r.prototype.apply=function(e,t){e=e.asKey();e in this._pools&&this._pools[e].apply(t)},$r.prototype.close=function(){return Yr(this,void 0,void 0,function(){var r=this;return Zr(this,function(e){switch(e.label){case 0:return this._closed=!0,[4,Promise.all(Object.keys(this._pools).map(function(t){return Yr(r,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},$r.prototype.keepAll=function(o){return Yr(this,void 0,void 0,function(){var t,r,n=this;return Zr(this,function(e){switch(e.label){case 0:return t=o.map(function(e){return e.asKey()}),r=Object.keys(this._pools),r=r.filter(function(e){return!t.includes(e)}),[4,Promise.all(r.map(function(t){return Yr(n,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},$r.prototype.has=function(e){return e.asKey()in this._pools},$r.prototype.activeResourceCount=function(e){return null!=(e=this._activeResourceCounts[e.asKey()])?e:0},$r.prototype._getOrInitializePoolFor=function(e){var t=this._pools[e];return null==t&&(t=new un,this._pools[e]=t,this._pendingCreates[e]=0),t},$r.prototype._acquire=function(c,l,f){return Yr(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u=this;return Zr(this,function(e){switch(e.label){case 0:if(this._closed)throw(0,Xr.newError)("Pool is closed, it is no more able to serve requests.");if(t=l.asKey(),n=this._getOrInitializePoolFor(t),f)return[3,10];e.label=1;case 1:if(!(0<n.length))return[3,10];if(null==(r=n.pop()))return[3,1];en(t,this._activeResourceCounts),null!=this._removeIdleObserver&&this._removeIdleObserver(r),o=!1,e.label=2;case 2:return e.trys.push([2,4,,6]),[4,this._validateOnAcquire(c,r)];case 3:return o=e.sent(),[3,6];case 4:return i=e.sent(),tn(t,this._activeResourceCounts),n.removeInUse(r),[4,this._destroy(r)];case 5:throw e.sent(),i;case 6:return o?(this._log.isDebugEnabled()&&this._log.debug("".concat(r," acquired from the pool ").concat(t)),[2,{resource:r,pool:n}]):[3,7];case 7:return tn(t,this._activeResourceCounts),n.removeInUse(r),[4,this._destroy(r)];case 8:e.sent(),e.label=9;case 9:return[3,1];case 10:if(0<this._maxSize&&this.activeResourceCount(l)+this._pendingCreates[t]>=this._maxSize)return[2,{resource:null,pool:n}];this._pendingCreates[t]=this._pendingCreates[t]+1,e.label=11;case 11:return(e.trys.push([11,,15,16]),this.activeResourceCount(l)+n.length>=this._maxSize&&f)?null==(s=n.pop())?[3,13]:(null!=this._removeIdleObserver&&this._removeIdleObserver(s),n.removeInUse(s),[4,this._destroy(s)]):[3,13];case 12:e.sent(),e.label=13;case 13:return[4,this._create(c,l,function(t,r){return Yr(u,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,this._release(t,r,n)];case 1:return[2,e.sent()]}})})})];case 14:return a=e.sent(),n.pushInUse(a),en(t,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(a," created for the pool ").concat(t)),[3,16];case 15:return this._pendingCreates[t]=this._pendingCreates[t]-1,[7];case 16:return[2,{resource:a,pool:n}]}})})},$r.prototype._release=function(n,o,i){return Yr(this,void 0,void 0,function(){var t,r=this;return Zr(this,function(e){switch(e.label){case 0:t=n.asKey(),e.label=1;case 1:return(e.trys.push([1,,9,10]),i.isActive())?[4,this._validateOnRelease(o)]:[3,6];case 2:return e.sent()?[3,4]:(this._log.isDebugEnabled()&&this._log.debug("".concat(o," destroyed and can't be released to the pool ").concat(t," because it is not functional")),i.removeInUse(o),[4,this._destroy(o)]);case 3:return e.sent(),[3,5];case 4:null!=this._installIdleObserver&&this._installIdleObserver(o,{onError:function(e){r._log.debug("Idle connection ".concat(o," destroyed because of error: ").concat(e));e=r._pools[t];null!=e&&(r._pools[t]=e.filter(function(e){return e!==o}),e.removeInUse(o)),r._destroy(o).catch(function(){})}}),i.push(o),this._log.isDebugEnabled()&&this._log.debug("".concat(o," released to the pool ").concat(t)),e.label=5;case 5:return[3,8];case 6:return this._log.isDebugEnabled()&&this._log.debug("".concat(o," destroyed and can't be released to the pool ").concat(t," because pool has been purged")),i.removeInUse(o),[4,this._destroy(o)];case 7:e.sent(),e.label=8;case 8:return[3,10];case 9:return tn(t,this._activeResourceCounts),this._processPendingAcquireRequests(n),[7];case 10:return[2]}})})},$r.prototype._purgeKey=function(o){return Yr(this,void 0,void 0,function(){var t,r,n;return Zr(this,function(e){switch(e.label){case 0:if(t=this._pools[o],r=[],null==t)return[3,2];for(;0<t.length;)null!=(n=t.pop())&&(null!=this._removeIdleObserver&&this._removeIdleObserver(n),r.push(this._destroy(n)));return t.close(),delete this._pools[o],[4,Promise.all(r)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},$r.prototype._processPendingAcquireRequests=function(r){var n,o=this,i=r.asKey(),e=this._acquireRequests[i];null!=e&&(null!=(n=e.shift())?this._acquire(n.context,r,n.requireNew).catch(function(e){return n.reject(e),{resource:null,pool:null}}).then(function(e){var t=e.resource,e=e.pool;null!=t&&null!=e?n.isCompleted()?o._release(r,t,e).catch(function(e){o._log.isDebugEnabled()&&o._log.debug("".concat(t," could not be release back to the pool. Cause: ").concat(e))}):n.resolve(t):n.isCompleted()||(null==o._acquireRequests[i]&&(o._acquireRequests[i]=[]),o._acquireRequests[i].unshift(n))}).catch(function(e){return n.reject(e)}):delete this._acquireRequests[i])},$r);function $r(e){var t=e.create,t=void 0===t?function(e,t,r){return Yr(u,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,Promise.reject(new Error("Not implemented"))];case 1:return[2,e.sent()]}})})}:t,r=e.destroy,r=void 0===r?function(e){return Yr(u,void 0,void 0,function(){return Zr(this,function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return[2,e.sent()]}})})}:r,n=e.validateOnAcquire,n=void 0===n?function(e,t){return!0}:n,o=e.validateOnRelease,o=void 0===o?function(e){return!0}:o,i=e.installIdleObserver,i=void 0===i?function(e,t){}:i,a=e.removeIdleObserver,a=void 0===a?function(e){}:a,s=e.config,s=void 0===s?Qr.default.defaultConfig():s,e=e.log,e=void 0===e?Jr.Logger.noOp():e,u=this;this._create=t,this._destroy=r,this._validateOnAcquire=n,this._validateOnRelease=o,this._installIdleObserver=i,this._removeIdleObserver=a,this._maxSize=s.maxSize,this._acquisitionTimeout=s.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=e,this._closed=!1}function en(e,t){var r=null!=(r=t[e])?r:0;t[e]=r+1}function tn(e,t){var r=(null!=(r=t[e])?r:0)-1;0<r?t[e]=r:delete t[e]}Object.defineProperty(nn.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(nn.prototype,"requireNew",{get:function(){var e;return null!=(e=this._config.requireNew)&&e},enumerable:!1,configurable:!0}),nn.prototype.isCompleted=function(){return this._completed},nn.prototype.resolve=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))},nn.prototype.reject=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))};var rn=nn;function nn(e,t,r,n,o,i,a){this._key=e,this._context=t,this._resolve=n,this._reject=o,this._timeoutId=i,this._log=a,this._completed=!1,this._config=null!=r?r:{}}cn.prototype.isActive=function(){return this._active},cn.prototype.close=function(){this._active=!1,this._elements=[],this._elementsInUse=new Set},cn.prototype.filter=function(e){return this._elements=this._elements.filter(e),this},cn.prototype.apply=function(e){this._elements.forEach(e),this._elementsInUse.forEach(e)},Object.defineProperty(cn.prototype,"length",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),cn.prototype.pop=function(){var e=this._elements.pop();return null!=e&&this._elementsInUse.add(e),e},cn.prototype.push=function(e){return this._elementsInUse.delete(e),this._elements.push(e)},cn.prototype.pushInUse=function(e){this._elementsInUse.add(e)},cn.prototype.removeInUse=function(e){this._elementsInUse.delete(e)};var on,an,sn,un=cn;function cn(){this._active=!0,this._elements=[],this._elementsInUse=new Set}S.default=R,R=zr,on=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),an=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),hn=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&on(t,e,r);return an(t,e),t},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(R,"__esModule",{value:!0}),R.DEFAULT_MAX_SIZE=R.DEFAULT_ACQUISITION_TIMEOUT=R.PoolConfig=R.Pool=void 0,sn=hn(T),R.PoolConfig=sn.default,Object.defineProperty(R,"DEFAULT_ACQUISITION_TIMEOUT",{enumerable:!0,get:function(){return sn.DEFAULT_ACQUISITION_TIMEOUT}}),Object.defineProperty(R,"DEFAULT_MAX_SIZE",{enumerable:!0,get:function(){return sn.DEFAULT_MAX_SIZE}}),hn=I(S),R.Pool=hn.default,R.default=hn.default;var ln=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),fn=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),T=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ln(t,e,r);return fn(t,e),t},I=(Object.defineProperty(d,"__esModule",{value:!0}),d.pool=d.boltAgent=d.objectUtil=d.resolver=d.serverAddress=d.urlUtil=d.logger=d.transactionExecutor=d.txConfig=d.connectionHolder=d.constants=d.bookmarks=d.observer=d.temporalUtil=d.util=void 0,T(u)),S=(d.util=I,T(i)),R=(d.temporalUtil=S,T(_)),hn=(d.observer=R,T(y)),I=(d.bookmarks=hn,T(b)),i=(d.constants=I,T(m)),S=(d.connectionHolder=i,T(v)),R=(d.txConfig=S,T(O)),hn=(d.transactionExecutor=R,T(g)),I=(d.logger=hn,T(w)),i=(d.urlUtil=I,T(Ar)),S=(d.serverAddress=i,T(E)),R=(d.resolver=S,T(F)),hn=(d.objectUtil=R,T(P)),w=(d.boltAgent=hn,T(zr)),I=(d.pool=w,{}),pn=e&&e.__assign||function(){return(pn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},dn=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),_n=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ar=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&dn(t,e,r);return _n(t,e),t},yn=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},bn=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},mn=(Object.defineProperty(I,"__esModule",{value:!0}),I.buildNotificationsFromMetadata=I.buildGqlStatusObjectFromMetadata=I.polyfillNotification=I.polyfillGqlStatusObject=I.GqlStatusObject=I.Notification=I.notificationClassification=I.notificationCategory=I.notificationSeverityLevel=void 0,Ar(n)),gn=d,vn=G,On={WARNING:{gql_status:"01N42",status_description:"warn: unknown warning"},NO_DATA:{gql_status:"02N42",status_description:"note: no data - unknown subcondition"},INFORMATION:{gql_status:"03N42",status_description:"info: unknown notification"},ERROR:{gql_status:"50N42",status_description:"error: general processing exception - unexpected error"}},wn={WARNING:"WARNING",INFORMATION:"INFORMATION",UNKNOWN:"UNKNOWN"},En=(I.notificationSeverityLevel=wn,Object.freeze(wn),Object.values(wn)),i={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",DEPRECATION:"DEPRECATION",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",GENERIC:"GENERIC",SCHEMA:"SCHEMA",UNKNOWN:"UNKNOWN"},Tn=(I.notificationCategory=i,Object.freeze(i),Object.values(i)),Cn=i,Pn=(I.notificationClassification=Cn,function(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=Dn(e.position),this.severityLevel=Mn(e.severity),this.rawSeverityLevel=e.severity,this.category=Un(e.category),this.rawCategory=e.category}),Sn=(I.Notification=Pn,Object.defineProperty(Rn.prototype,"diagnosticRecordAsJsonString",{get:function(){return mn.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),Rn);function Rn(e){var t;this.gqlStatus=e.gql_status,this.statusDescription=e.status_description,this.diagnosticRecord=null!=(t=e.diagnostic_record)?t:{},this.position=null!=this.diagnosticRecord._position?Dn(this.diagnosticRecord._position):void 0,this.severity=Mn(this.diagnosticRecord._severity),this.rawSeverity=this.diagnosticRecord._severity,this.classification=Un(this.diagnosticRecord._classification),this.rawClassification=this.diagnosticRecord._classification,this.isNotification=null!=e.neo4j_code,Object.freeze(this)}function In(e){var t;if(null!=e.neo4j_code)return new Pn({code:e.neo4j_code,title:e.title,description:e.description,severity:null==(t=e.diagnostic_record)?void 0:t._severity,category:null==(t=e.diagnostic_record)?void 0:t._classification,position:null==(t=e.diagnostic_record)?void 0:t._position})}function Nn(e){var t=e.severity===wn.WARNING?On.WARNING:On.INFORMATION,r={gql_status:t.gql_status,status_description:null!=(r=e.description)?r:t.status_description,neo4j_code:e.code,title:e.title,diagnostic_record:pn({},vn.rawPolyfilledDiagnosticRecord)};return null!=e.severity&&(r.diagnostic_record._severity=e.severity),null!=e.category&&(r.diagnostic_record._classification=e.category),null!=e.position&&(r.diagnostic_record._position=e.position),new Sn(r)}I.GqlStatusObject=Sn,I.polyfillNotification=In,I.polyfillGqlStatusObject=Nn;var kn={SUCCESS:new Sn({gql_status:"00000",status_description:"note: successful completion",diagnostic_record:vn.rawPolyfilledDiagnosticRecord}),NO_DATA:new Sn({gql_status:"02000",status_description:"note: no data",diagnostic_record:vn.rawPolyfilledDiagnosticRecord}),NO_DATA_UNKNOWN_SUBCONDITION:new Sn(pn(pn({},On.NO_DATA),{diagnostic_record:vn.rawPolyfilledDiagnosticRecord})),OMITTED_RESULT:new Sn({gql_status:"00001",status_description:"note: successful completion - omitted result",diagnostic_record:vn.rawPolyfilledDiagnosticRecord})};Object.freeze(kn),I.buildGqlStatusObjectFromMetadata=function(e){var t;return null!=e.statuses?e.statuses.map(function(e){return new Sn(e)}):(t=!0===(null==(t=e.stream_summary)?void 0:t.have_records_streamed)?kn.SUCCESS:!1===(null==t?void 0:t.has_keys)?kn.OMITTED_RESULT:!0===(null==t?void 0:t.pulled)?kn.NO_DATA:kn.NO_DATA_UNKNOWN_SUBCONDITION,bn([t],yn(null!=(e=null==(t=e.notifications)?void 0:t.map(Nn))?e:[]),!1).sort(function(e,t){return An(e)-An(t)}))};var jn=Object.freeze({"02":0,"01":1,"00":2});function An(e){var e=null==(e=e.gqlStatus)?void 0:e.slice(0,2);return null!=(e=jn[e])?e:9999}function Dn(e){return null==e?{}:{offset:gn.util.toNumber(e.offset),line:gn.util.toNumber(e.line),column:gn.util.toNumber(e.column)}}function Mn(e){return En.includes(e)?e:wn.UNKNOWN}function Un(e){return Tn.includes(e)?e:Cn.UNKNOWN}I.buildNotificationsFromMetadata=function(e){return null!=e.notifications?e.notifications.map(function(e){return new Pn(e)}):null!=e.statuses?e.statuses.map(In).filter(function(e){return null!=e}):[]},I.default=Pn,Object.defineProperty(vt,"__esModule",{value:!0}),vt.Stats=vt.QueryStatistics=vt.ProfiledPlan=vt.Plan=vt.ServerInfo=vt.queryType=void 0;var Ln=d,xn=I,E=(Bn.prototype.hasPlan=function(){return this.plan instanceof Fn},Bn.prototype.hasProfile=function(){return this.profile instanceof qn},Bn);function Bn(e,t,r,n){this.query={text:e,parameters:t},this.queryType=r.type,this.counters=new Vn(null!=(e=r.stats)?e:{}),this.updateStatistics=this.counters,this.plan=(null!=r.plan||null!=r.profile)&&new Fn(null!=(t=r.plan)?t:r.profile),this.profile=null!=r.profile&&new qn(r.profile),this.notifications=(0,xn.buildNotificationsFromMetadata)(r),this.gqlStatusObjects=(0,xn.buildGqlStatusObjectFromMetadata)(r),this.server=new Wn(r.server,n),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:null!=(e=r.db)?e:null}}var Fn=function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]},qn=(vt.Plan=Fn,Hn.prototype.hasPageCacheStats=function(){return 0<this.pageCacheMisses||0<this.pageCacheHits||0<this.pageCacheHitRatio},Hn);function Hn(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.dbHits=Gn("dbHits",e),this.rows=Gn("rows",e),this.pageCacheMisses=Gn("pageCacheMisses",e),this.pageCacheHits=Gn("pageCacheHits",e),this.pageCacheHitRatio=Gn("pageCacheHitRatio",e),this.time=Gn("time",e),this.children=null!=e.children?e.children.map(function(e){return new Hn(e)}):[]}vt.ProfiledPlan=qn;vt.Stats=function(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0},zn.prototype.containsUpdates=function(){var r=this;return void 0!==this._containsUpdates?this._containsUpdates:0<Object.keys(this._stats).reduce(function(e,t){return e+r._stats[t]},0)},zn.prototype.updates=function(){return this._stats},zn.prototype.containsSystemUpdates=function(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:0<this._systemUpdates},zn.prototype.systemUpdates=function(){return this._systemUpdates};var Vn=zn;function zn(r){var n=this;this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(r).forEach(function(e){var t=e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()});t in n._stats?n._stats[t]=Ln.util.toNumber(r[e]):"systemUpdates"===t?n._systemUpdates=Ln.util.toNumber(r[e]):"containsSystemUpdates"===t?n._containsSystemUpdates=r[e]:"containsUpdates"===t&&(n._containsUpdates=r[e])}),this._stats=Object.freeze(this._stats)}vt.QueryStatistics=Vn;var Wn=function(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t};function Gn(e,t,r){return void 0===r&&(r=0),!1!==t&&e in t?(t=t[e],Ln.util.toNumber(t)):r}vt.ServerInfo=Wn;function Kn(){throw this.minimumSeverityLevel=void 0,this.disabledCategories=void 0,this.disabledClassifications=void 0,new Error("Not implemented")}function Yn(e){console.log("Uncaught error when processing result: "+e)}function Zn(e){}function Qn(e){}vt.queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},vt.default=E;var Xn,S={},F=(Object.defineProperty(S,"__esModule",{value:!0}),S.notificationFilterDisabledClassification=S.notificationFilterDisabledCategory=S.notificationFilterMinimumSeverityLevel=void 0,{OFF:"OFF",WARNING:"WARNING",INFORMATION:"INFORMATION"}),R=(S.notificationFilterMinimumSeverityLevel=F,Object.freeze(F),{HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",DEPRECATION:"DEPRECATION",GENERIC:"GENERIC",SCHEMA:"SCHEMA"}),P=(S.notificationFilterDisabledCategory=R,Object.freeze(R),R),hn=(S.notificationFilterDisabledClassification=P,S.default=Kn,{}),Jn=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},$n=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},T=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},eo=(Object.defineProperty(hn,"__esModule",{value:!0}),T(vt)),to=d,ro=r,no=to.connectionHolder.EMPTY_CONNECTION_HOLDER;function oo(e,t,r,n,o){var i;void 0===o&&(o={high:Number.MAX_VALUE,low:Number.MAX_VALUE}),this[Xn]="Result",this._stack=null==(i=new Error("")).stack?null:i.stack.replace(/^Error(\n\r)*/,""),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=null!=r?r:{},this._connectionHolder=null!=n?n:no,this._keys=null,this._summary=null,this._error=null,this._watermarks=o}oo.prototype.keys=function(){var n=this;return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){return e.subscribe(n._decorateObserver({onKeys:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},oo.prototype.summary=function(){var n=this;return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){e.cancel(),e.subscribe(n._decorateObserver({onCompleted:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},oo.prototype._getOrCreatePromise=function(){var e=this;return null==this._p&&(this._p=new Promise(function(t,r){var n=[];e.subscribe({onNext:function(e){n.push(e)},onCompleted:function(e){t({records:n,summary:e})},onError:function(e){r(e)}})})),this._p},oo.prototype[Symbol.asyncIterator]=function(){var e,n,r,o,i,a=this;return this.isOpen()?(n={paused:!0,firstRun:!0,finished:!1},r=function(){var e,t;null!=n.streaming&&(e=(t=null!=(t=null==(t=n.queuedObserver)?void 0:t.size)?t:0)>=a._watermarks.high,t=t<=a._watermarks.low,e&&!n.paused?(n.paused=!0,n.streaming.pause()):(t&&n.paused||n.firstRun&&!e)&&(n.firstRun=!1,n.paused=!1,n.streaming.resume()))},o=function(){return Jn(a,void 0,void 0,function(){var t;return $n(this,function(e){switch(e.label){case 0:return void 0!==n.queuedObserver?[3,2]:(n.queuedObserver=this._createQueuedResultObserver(r),t=n,[4,this._subscribe(n.queuedObserver,!0).catch(function(){})]);case 1:t.streaming=e.sent(),r(),e.label=2;case 2:return[2,n.queuedObserver]}})})},i=function(e){if(void 0===e)throw(0,ro.newError)("InvalidState: Result stream finished without Summary",ro.PROTOCOL_ERROR);return!0},{next:function(){return Jn(a,void 0,void 0,function(){var t;return $n(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:n.summary}]:[4,o()];case 1:return[4,e.sent().dequeue()];case 2:return!0===(t=e.sent()).done&&(n.finished=t.done,n.summary=t.value),[2,t]}})})},return:function(r){return Jn(a,void 0,void 0,function(){var t;return $n(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:null!=r?r:n.summary}]:(null!=(t=n.streaming)&&t.cancel(),[4,o()]);case 1:return[4,e.sent().dequeueUntilDone()];case 2:return t=e.sent(),n.finished=!0,t.value=null!=r?r:t.value,n.summary=t.value,[2,t]}})})},peek:function(){return Jn(a,void 0,void 0,function(){return $n(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:n.summary}]:[4,o()];case 1:return[4,e.sent().head()];case 2:return[2,e.sent()]}})})}}):(e=(0,ro.newError)("Result is already consumed"),{next:function(){return Promise.reject(e)},peek:function(){return Promise.reject(e)}})},oo.prototype.then=function(e,t){return this._getOrCreatePromise().then(e,t)},oo.prototype.catch=function(e){return this._getOrCreatePromise().catch(e)},oo.prototype.finally=function(e){return this._getOrCreatePromise().finally(e)},oo.prototype.subscribe=function(e){this._subscribe(e).catch(function(){})},oo.prototype.isOpen=function(){return null===this._summary&&null===this._error},oo.prototype._subscribe=function(e,t){void 0===t&&(t=!1);var r=this._decorateObserver(e);return this._streamObserverPromise.then(function(e){return t&&e.pause(),e.subscribe(r),e}).catch(function(e){return null!=r.onError&&r.onError(e),Promise.reject(e)})},oo.prototype._decorateObserver=function(n){var e,o=this,t=null!=(e=n.onCompleted)?e:Zn,i=null!=(e=n.onError)?e:Yn,r=null!=(e=n.onKeys)?e:Qn;return{onNext:null!=n.onNext?n.onNext.bind(n):void 0,onKeys:function(e){return o._keys=e,r.call(n,e)},onCompleted:function(e){o._releaseConnectionAndGetSummary(e).then(function(e){return null!==o._summary?t.call(n,o._summary):(o._summary=e,t.call(n,e))}).catch(i)},onError:function(r){o._connectionHolder.releaseConnection().then(function(){var e,t;e=r,null!=(t=o._stack)&&(e.stack=e.toString()+"\n"+t),o._error=r,i.call(n,r)}).catch(i)}}},oo.prototype._cancel=function(){null===this._summary&&null===this._error&&this._streamObserverPromise.then(function(e){return e.cancel()}).catch(function(){})},oo.prototype._releaseConnectionAndGetSummary=function(t){var e=to.util.validateQueryAndParameters(this._query,this._parameters,{skipAsserts:!0}),r=e.validatedQuery,n=e.params,o=this._connectionHolder;return o.getConnection().then(function(e){return o.releaseConnection().then(function(){return null==e?void 0:e.getProtocolVersion()})},function(e){}).then(function(e){return new eo.default(r,n,t,e)})},oo.prototype._createQueuedResultObserver=function(n){var e=this;function o(){var r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r}function i(e){return e instanceof Error}function r(){var r;return Jn(this,void 0,void 0,function(){var t;return $n(this,function(e){switch(e.label){case 0:if(0<a.length){if(t=null!=(r=a.shift())?r:(0,ro.newError)("Unexpected empty buffer",ro.PROTOCOL_ERROR),n(),i(t))throw t;return[2,t]}return s.resolvable=o(),[4,s.resolvable.promise];case 1:return[2,e.sent()]}})})}var a=[],s={resolvable:null},t={onNext:function(e){t._push({done:!1,value:e})},onCompleted:function(e){t._push({done:!0,value:e})},onError:function(e){t._push(e)},_push:function(e){var t;null!==s.resolvable?(t=s.resolvable,s.resolvable=null,i(e)?t.reject(e):t.resolve(e)):(a.push(e),n())},dequeue:r,dequeueUntilDone:function(){return Jn(e,void 0,void 0,function(){var t;return $n(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return!0===(t=e.sent()).done?[2,t]:[3,0];case 2:return[2]}})})},head:function(){return Jn(e,void 0,void 0,function(){var t,r;return $n(this,function(e){switch(e.label){case 0:if(0<a.length){if(i(t=a[0]))throw t;return[2,t]}s.resolvable=o(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,s.resolvable.promise];case 2:return t=e.sent(),a.unshift(t),[2,t];case 3:throw r=e.sent(),a.unshift(r),r;case 4:return n(),[7];case 5:return[2]}})})},get size(){return a.length}};return t},Xn=Symbol.toStringTag,hn.default=oo;zr={};Object.defineProperty(zr,"__esModule",{value:!0});zr.default=function(e,t,r){this.keys=e,this.records=t,this.summary=r};w={},Object.defineProperty(w,"__esModule",{value:!0}),w.Releasable=void 0,io.prototype.release=function(){throw new Error("Not implemented")},Ar=io;function io(){}function ao(){}w.Releasable=Ar,ao.prototype.acquireConnection=function(e){throw Error("Not implemented")},ao.prototype.supportsMultiDb=function(){throw Error("Not implemented")},ao.prototype.supportsTransactionConfig=function(){throw Error("Not implemented")},ao.prototype.supportsUserImpersonation=function(){throw Error("Not implemented")},ao.prototype.supportsSessionAuth=function(){throw Error("Not implemented")},ao.prototype.verifyConnectivityAndGetServerInfo=function(e){throw Error("Not implemented")},ao.prototype.verifyAuthentication=function(e){throw Error("Not implemented")},ao.prototype.getNegotiatedProtocolVersion=function(){throw Error("Not Implemented")},ao.prototype.close=function(){throw Error("Not implemented")},w.default=ao;G={};function so(){}Object.defineProperty(G,"__esModule",{value:!0}),so.prototype.beginTransaction=function(e){throw new Error("Not implemented")},so.prototype.run=function(e,t,r){throw new Error("Not implemented")},so.prototype.commitTransaction=function(e){throw new Error("Not implemented")},so.prototype.rollbackTransaction=function(e){throw new Error("Not implemented")},so.prototype.resetAndFlush=function(){throw new Error("Not implemented")},so.prototype.isOpen=function(){throw new Error("Not implemented")},so.prototype.getProtocolVersion=function(){throw new Error("Not implemented")},so.prototype.hasOngoingObservableRequests=function(){throw new Error("Not implemented")},G.default=so;var i={},uo=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},co=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},lo=(Object.defineProperty(i,"__esModule",{value:!0}),u),fo=m,ho=y,po=v,_o=_,yo=r,bo=E(hn);function mo(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,e=e.apiTelemetryConfig,f=this;this._connectionHolder=t,this._reactive=i,this._state=go.ACTIVE,this._onClose=r,this._onBookmarks=n,this._onConnection=o,this._onError=this._onErrorCallback.bind(this),this._fetchSize=a,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=s,this._lowRecordWatermak=c,this._highRecordWatermark=u,this._bookmarks=ho.Bookmarks.empty(),this._notificationFilter=l,this._apiTelemetryConfig=e,this._acceptActive=function(){},this._activePromise=new Promise(function(e,t){f._acceptActive=e})}mo.prototype._begin=function(o,i,a){var t=this;this._connectionHolder.getConnection().then(function(n){return uo(t,void 0,void 0,function(){var t,r=this;return co(this,function(e){switch(e.label){case 0:return(this._onConnection(),null==n)?[3,2]:(t=this,[4,o()]);case 1:return t._bookmarks=e.sent(),[2,n.beginTransaction({bookmarks:this._bookmarks,txConfig:i,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,notificationFilter:this._notificationFilter,apiTelemetryConfig:this._apiTelemetryConfig,beforeError:function(e){null!=a&&a.onError(e),r._onError(e).catch(function(){})},afterComplete:function(e){null!=a&&a.onComplete(e),r._onComplete(e)}})];case 2:throw(0,yo.newError)("No connection available")}})})}).catch(function(e){null!=a&&a.onError(e),t._onError(e).catch(function(){})}).finally(function(){return t._acceptActive()})},mo.prototype.run=function(e,t){e=(0,lo.validateQueryAndParameters)(e,t),t=e.validatedQuery,e=e.params,t=this._state.run(t,e,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(t),t},mo.prototype.commit=function(){var t=this,r=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:function(e){return t._onCompleteCallback(e,t._bookmarks)},onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},mo.prototype.rollback=function(){var r=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},mo.prototype.isOpen=function(){return this._state===go.ACTIVE},mo.prototype.close=function(){return uo(this,void 0,void 0,function(){return co(this,function(e){switch(e.label){case 0:return this.isOpen()?[4,this.rollback()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},mo.prototype[Symbol.asyncDispose]=function(){return this.close()},mo.prototype._onErrorCallback=function(t){return this._state===go.FAILED?Promise.resolve(null):(this._state=go.FAILED,this._onClose(),this._results.forEach(function(e){e.isOpen()&&e._streamObserverPromise.then(function(e){return e.onError(t)}).catch(function(e){})}),this._connectionHolder.releaseConnection())},mo.prototype._onCompleteCallback=function(e,t){this._onBookmarks(new ho.Bookmarks(null==e?void 0:e.bookmark),null!=t?t:ho.Bookmarks.empty(),null==e?void 0:e.db)};var go={ACTIVE:{commit:function(e){return{result:vo(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:go.SUCCEEDED}},rollback:function(e){return{result:vo(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:go.ROLLED_BACK}},run:function(t,r,e){var n=e.connectionHolder,o=e.onError,i=e.onComplete,a=e.onConnection,s=e.reactive,u=e.fetchSize,c=e.highRecordWatermark,l=e.lowRecordWatermark,e=e.preparationJob,f=null!=e?e:Promise.resolve();return Oo(n.getConnection().then(function(e){return f.then(function(){return e})}).then(function(e){if(a(),null!=e)return e.run(t,r,{bookmarks:ho.Bookmarks.empty(),txConfig:po.TxConfig.empty(),beforeError:o,afterComplete:i,reactive:s,fetchSize:u,highRecordWatermark:c,lowRecordWatermark:l});throw(0,yo.newError)("No connection available")}).catch(function(e){return new _o.FailedObserver({error:e,onError:o})}),t,r,n,c,l)}},FAILED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:r}),"COMMIT",{},t,0,0),state:go.FAILED}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:Oo(new _o.CompletedObserver,"ROLLBACK",{},t,0,0),state:go.FAILED}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:o}),e,t,n,0,0)}},SUCCEEDED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot commit this transaction, because it has already been committed."),onError:r}),"COMMIT",{},fo.EMPTY_CONNECTION_HOLDER,0,0),state:go.SUCCEEDED,connectionHolder:t}},rollback:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot rollback this transaction, because it has already been committed."),onError:r}),"ROLLBACK",{},fo.EMPTY_CONNECTION_HOLDER,0,0),state:go.SUCCEEDED,connectionHolder:t}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot run query in this transaction, because it has already been committed."),onError:o}),e,t,n,0,0)}},ROLLED_BACK:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:r}),"COMMIT",{},t,0,0),state:go.ROLLED_BACK}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},t,0,0),state:go.ROLLED_BACK}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,Oo(new _o.FailedObserver({error:(0,yo.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:o}),e,t,n,0,0)}}};function vo(r,e,n,o,i,a,t){var s=null!=t?t:Promise.resolve(),t=e.getConnection().then(function(e){return s.then(function(){return e})}).then(function(t){return i(),a.forEach(function(e){return e._cancel()}),Promise.all(a.map(function(e){return e.summary()})).then(function(e){if(null!=t)return r?t.commitTransaction({beforeError:n,afterComplete:o}):t.rollbackTransaction({beforeError:n,afterComplete:o});throw(0,yo.newError)("No connection available")})}).catch(function(e){return new _o.FailedObserver({error:e,onError:n})});return new bo.default(t,r?"COMMIT":"ROLLBACK",{},e,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function Oo(e,t,r,n,o,i){return void 0===n&&(n=fo.EMPTY_CONNECTION_HOLDER),new bo.default(Promise.resolve(e),t,r,new fo.ReadOnlyConnectionHolder(null!=n?n:fo.EMPTY_CONNECTION_HOLDER),{low:i,high:o})}i.default=mo;F={};function wo(e){e=e.run;this._run=e}Object.defineProperty(F,"__esModule",{value:!0}),wo.fromTransaction=function(e){return new wo({run:e.run.bind(e)})},wo.prototype.run=function(e,t){return this._run(e,t)},F.default=wo;var Eo,To,Co,R={},P=e&&e.__extends||(Eo=function(e,t){return(Eo=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Eo(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Po=e&&e.__assign||function(){return(Po=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ar=(Object.defineProperty(R,"__esModule",{value:!0}),T(i)),E=(Co=Ar.default,P(So,Co),So.prototype.then=function(e,t){return this._getOrCreateBeginPromise().then(e,t)},So.prototype.catch=function(e){return this._getOrCreateBeginPromise().catch(e)},So.prototype.finally=function(e){return this._getOrCreateBeginPromise().finally(e)},So.prototype._getOrCreateBeginPromise=function(){var r=this;return null==this._beginPromise&&(this._beginPromise=new Promise(function(e,t){r._resolve=e,r._reject=t,null!=r._beginError&&t(r._beginError),null!=r._beginMetadata&&e(r._toTransaction())})),this._beginPromise},So.prototype._toTransaction=function(){return Po(Po({},this),{run:Co.prototype.run.bind(this),commit:Co.prototype.commit.bind(this),rollback:Co.prototype.rollback.bind(this),close:Co.prototype.close.bind(this),isOpen:Co.prototype.isOpen.bind(this),_begin:this._begin.bind(this)})},So.prototype._begin=function(e,t){return Co.prototype._begin.call(this,e,t,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this)})},So.prototype._onBeginError=function(e){this._beginError=e,null!=this._reject&&this._reject(e)},So.prototype._onBeginMetadata=function(e){this._beginMetadata=null!=e?e:{},null!=this._resolve&&this._resolve(this._toTransaction())},So);function So(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,e=e.apiTelemetryConfig,t=Co.call(this,{connectionHolder:t,onClose:r,onBookmarks:n,onConnection:o,reactive:i,fetchSize:a,impersonatedUser:s,highRecordWatermark:u,lowRecordWatermark:c,notificationFilter:l,apiTelemetryConfig:e})||this;return t[To]="TransactionPromise",t}To=Symbol.toStringTag,R.default=E;var T={},Ro=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Io=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},No=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},ko=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Ar=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},jo=(Object.defineProperty(T,"__esModule",{value:!0}),_),Ao=u,Do=b,Mo=r,Uo=Ar(hn),Lo=m,xo=O,Bo=y,Fo=v,qo=Ar(R),Ho=Ar(F);function Vo(e){var t=e.mode,r=e.connectionProvider,n=e.bookmarks,o=e.database,i=e.config,a=e.reactive,s=e.fetchSize,u=e.impersonatedUser,c=e.bookmarkManager,l=e.notificationFilter,f=e.auth,e=e.log,t=(this._mode=t,this._database=o,this._reactive=a,this._fetchSize=s,this._onDatabaseNameResolved=this._onDatabaseNameResolved.bind(this),this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new Lo.ConnectionHolder({mode:Do.ACCESS_MODE_READ,auth:f,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:e}),this._writeConnectionHolder=new Lo.ConnectionHolder({mode:Do.ACCESS_MODE_WRITE,auth:f,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:e}),this._open=!0,this._hasTx=!1,this._impersonatedUser=u,this._lastBookmarks=null!=n?n:Bo.Bookmarks.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=function(e){e=null!=(e=null==e?void 0:e.maxTransactionRetryTime)?e:null;return new xo.TransactionExecutor(e)}(i),this._databaseNameResolved=""!==this._database,this._calculateWatermaks());this._lowRecordWatermark=t.low,this._highRecordWatermark=t.high,this._results=[],this._bookmarkManager=c,this._notificationFilter=l,this._log=e}Vo.prototype.run=function(e,t,r){var o=this,e=(0,Ao.validateQueryAndParameters)(e,t),i=e.validatedQuery,a=e.params,s=null!=r?new Fo.TxConfig(r,this._log):Fo.TxConfig.empty(),t=this._run(i,a,function(n){return Ro(o,void 0,void 0,function(){var t,r=this;return Io(this,function(e){switch(e.label){case 0:return[4,this._bookmarks()];case 1:return t=e.sent(),this._assertSessionIsOpen(),[2,n.run(i,a,{bookmarks:t,txConfig:s,mode:this._mode,database:this._database,apiTelemetryConfig:{api:Do.TELEMETRY_APIS.AUTO_COMMIT_TRANSACTION},impersonatedUser:this._impersonatedUser,afterComplete:function(e){return r._onCompleteCallback(e,t)},reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter})]}})})});return this._results.push(t),t},Vo.prototype._run=function(e,t,r){var r=this._acquireAndConsumeConnection(r),n=r.connectionHolder,r=r.resultPromise.catch(function(e){return Promise.resolve(new jo.FailedObserver({error:e}))}),o={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new Uo.default(r,e,t,n,o)},Vo.prototype._acquireConnection=function(e){var r=this,e=this._acquireAndConsumeConnection(e),n=e.connectionHolder;return e.resultPromise.then(function(t){return Ro(r,void 0,void 0,function(){return Io(this,function(e){switch(e.label){case 0:return[4,n.releaseConnection()];case 1:return e.sent(),[2,t]}})})})},Vo.prototype._acquireAndConsumeConnection=function(t){var e=this._connectionHolderWithMode(this._mode),r=this._open?!this._hasTx&&e.initializeConnection()?e.getConnection().then(function(e){return t(e)}):Promise.reject((0,Mo.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject((0,Mo.newError)("Cannot run query in a closed session."));return{connectionHolder:e,resultPromise:r}},Vo.prototype.beginTransaction=function(e){var t=Fo.TxConfig.empty();return null!=e&&(t=new Fo.TxConfig(e,this._log)),this._beginTransaction(this._mode,t,{api:Do.TELEMETRY_APIS.UNMANAGED_TRANSACTION})},Vo.prototype._beginTransaction=function(e,t,r){var n=this;if(!this._open)throw(0,Mo.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,Mo.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");e=Vo._validateSessionMode(e),e=this._connectionHolderWithMode(e),e.initializeConnection(),this._hasTx=!0,e=new qo.default({connectionHolder:e,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:function(e,t,r){return n._updateBookmarks(e,t,r)},onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,apiTelemetryConfig:r});return e._begin(function(){return n._bookmarks()},t),e},Vo.prototype._assertSessionIsOpen=function(){if(!this._open)throw(0,Mo.newError)("You cannot run more transactions on a closed session.")},Vo.prototype._transactionClosed=function(){this._hasTx=!1},Vo.prototype.lastBookmark=function(){return this.lastBookmarks()},Vo.prototype.lastBookmarks=function(){return this._lastBookmarks.values()},Vo.prototype._bookmarks=function(){var r;return Ro(this,void 0,void 0,function(){var t;return Io(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new Bo.Bookmarks(ko(ko([],No(t),!1),No(this._configuredBookmarks),!1))]}})})},Vo.prototype.readTransaction=function(e,t){t=new Fo.TxConfig(t,this._log);return this._runTransaction(Do.ACCESS_MODE_READ,t,e)},Vo.prototype.writeTransaction=function(e,t){t=new Fo.TxConfig(t,this._log);return this._runTransaction(Do.ACCESS_MODE_WRITE,t,e)},Vo.prototype._runTransaction=function(t,r,e){var n=this;return this._transactionExecutor.execute(function(e){return n._beginTransaction(t,r,e)},e)},Vo.prototype.executeRead=function(e,t){t=new Fo.TxConfig(t,this._log);return this._executeInTransaction(Do.ACCESS_MODE_READ,t,e)},Vo.prototype.executeWrite=function(e,t){t=new Fo.TxConfig(t,this._log);return this._executeInTransaction(Do.ACCESS_MODE_WRITE,t,e)},Vo.prototype._executeInTransaction=function(t,r,e){var n=this;return this._transactionExecutor.execute(function(e){return n._beginTransaction(t,r,e)},e,Ho.default.fromTransaction)},Vo.prototype._onDatabaseNameResolved=function(e){this._databaseNameResolved||(this._database=e=null!=e?e:"",this._readConnectionHolder.setDatabase(e),this._writeConnectionHolder.setDatabase(e),this._databaseNameResolved=!0)},Vo.prototype._getConnectionAcquistionBookmarks=function(){var r;return Ro(this,void 0,void 0,function(){var t;return Io(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new Bo.Bookmarks(ko(ko([],No(this._configuredBookmarks),!1),No(t),!1))]}})})},Vo.prototype._updateBookmarks=function(e,t,r){var n;null==e||e.isEmpty()||(null!=(n=this._bookmarkManager)&&n.updateBookmarks(null!=(n=null==t?void 0:t.values())?n:[],null!=(t=null==e?void 0:e.values())?t:[]).catch(function(){}),this._lastBookmarks=e,this._configuredBookmarks=Bo.Bookmarks.empty())},Vo.prototype.close=function(){return Ro(this,void 0,void 0,function(){return Io(this,function(e){switch(e.label){case 0:return this._open?(this._open=!1,this._results.forEach(function(e){return e._cancel()}),this._transactionExecutor.close(),[4,this._readConnectionHolder.close(this._hasTx)]):[3,3];case 1:return e.sent(),[4,this._writeConnectionHolder.close(this._hasTx)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},Vo.prototype[Symbol.asyncDispose]=function(){return this.close()},Vo.prototype._connectionHolderWithMode=function(e){if(e===Do.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===Do.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,Mo.newError)("Unknown access mode: "+e)},Vo.prototype._onCompleteCallback=function(e,t){this._updateBookmarks(new Bo.Bookmarks(e.bookmark),t,e.db)},Vo.prototype._calculateWatermaks=function(){return this._fetchSize===Do.FETCH_ALL?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}},Vo.prototype._configureTransactionExecutor=function(e,t){this._transactionExecutor.pipelineBegin=e,this._transactionExecutor.telemetryApi=t},Vo._validateSessionMode=function(e){e=null!=e?e:Do.ACCESS_MODE_WRITE;if(e!==Do.ACCESS_MODE_READ&&e!==Do.ACCESS_MODE_WRITE)throw(0,Mo.newError)("Illegal session mode "+e);return e},T.default=Vo;var P={},E={},zo=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Wo=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Go=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ko=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},Yo=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},_=(Object.defineProperty(E,"__esModule",{value:!0}),E.bookmarkManager=void 0,Zo.prototype.updateBookmarks=function(e,t){return zo(this,void 0,void 0,function(){return Wo(this,function(e){throw new Error("Not implemented")})})},Zo.prototype.getBookmarks=function(){return zo(this,void 0,void 0,function(){return Wo(this,function(e){throw new Error("Not implemented")})})},Zo);function Zo(){throw new Error("Not implemented")}E.default=_,E.bookmarkManager=function(e){void 0===e&&(e={});var t=new Set(e.initialBookmarks);return new Qo(t,e.bookmarksSupplier,e.bookmarksConsumer)};Xo.prototype.updateBookmarks=function(f,h){return zo(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,c,l;return Wo(this,function(e){switch(e.label){case 0:t=this._bookmarks;try{for(r=Go(f),n=r.next();!n.done;n=r.next())a=n.value,t.delete(a)}catch(e){s={error:e}}finally{try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}try{for(o=Go(h),i=o.next();!i.done;i=o.next())a=i.value,t.add(a)}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=o.return)&&l.call(o)}finally{if(c)throw c.error}}return"function"!=typeof this._bookmarksConsumer?[3,2]:[4,this._bookmarksConsumer(Yo([],Ko(t),!1))];case 1:e.sent(),e.label=2;case 2:return[2]}})})},Xo.prototype.getBookmarks=function(){var u;return zo(this,void 0,void 0,function(){var t,r,n,o,i,a,s;return Wo(this,function(e){switch(e.label){case 0:return t=new Set(this._bookmarks),"function"!=typeof this._bookmarksSupplier?[3,2]:[4,this._bookmarksSupplier()];case 1:r=null!=(u=e.sent())?u:[];try{for(n=Go(r),o=n.next();!o.done;o=n.next())i=o.value,t.add(i)}catch(e){a={error:e}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}e.label=2;case 2:return[2,Yo([],Ko(t),!1)]}})})};var Qo=Xo;function Xo(e,t,r){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=r}var m={},Jo=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},$o=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},O=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ei=(Object.defineProperty(m,"__esModule",{value:!0}),O(zr)),ti=r;function ri(){}ri.prototype.eagerResultTransformer=function(){return ni},ri.prototype.eager=function(){return ni},ri.prototype.mappedResultTransformer=function(e){return oi(e)},ri.prototype.mapped=function(e){return oi(e)},ri.prototype.first=function(){return ii},ri.prototype.summary=function(){return ai};v=new ri;function ni(o){return Jo(this,void 0,void 0,function(){var t,r,n;return $o(this,function(e){switch(e.label){case 0:return[4,o];case 1:return r=e.sent(),t=r.summary,r=r.records,[4,o.keys()];case 2:return n=e.sent(),[2,new ei.default(n,r,t)]}})})}function oi(i){var e=this;if(null==i||null==i.collect&&null==i.map)throw(0,ti.newError)("Requires a map or/and a collect functions.");return function(o){return Jo(e,void 0,void 0,function(){return $o(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t,r){var n={records:[],keys:[]};o.subscribe({onKeys:function(e){n.keys=e},onNext:function(e){var t;null!=i.map?void 0!==(t=i.map(e))&&n.records.push(t):n.records.push(e)},onCompleted:function(e){null!=i.collect?t(i.collect(n.records,e,n.keys)):t({records:n.records,summary:e,keys:n.keys})},onError:function(e){r(e)}})})];case 1:return[2,e.sent()]}})})}}function ii(o){return Jo(this,void 0,void 0,function(){var t,r,n;return $o(this,function(e){switch(e.label){case 0:return[4,(t=o[Symbol.asyncIterator]()).next()];case 1:n=e.sent(),r=n.value,n=n.done,e.label=2;case 2:return e.trys.push([2,,3,6]),!0===n?[2,void 0]:[2,r];case 3:return null==t.return?[3,5]:[4,t.return()];case 4:e.sent(),e.label=5;case 5:return[7];case 6:return[2]}})})}function ai(t){return Jo(this,void 0,void 0,function(){return $o(this,function(e){switch(e.label){case 0:return[4,t.summary()];case 1:return[2,e.sent()]}})})}Object.freeze(v),m.default=v;var Ar={},si=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},ui=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},ci=(Object.defineProperty(Ar,"__esModule",{value:!0}),b);function li(e){this._createSession=e}li.prototype.execute=function(o,i,a){return si(this,void 0,void 0,function(){var t,r,n=this;return ui(this,function(e){switch(e.label){case 0:t=this._createSession({database:o.database,bookmarkManager:o.bookmarkManager,impersonatedUser:o.impersonatedUser,auth:o.auth}),r=function(e,t,r){"function"==typeof(null==e?void 0:e.addEventListener)&&e.addEventListener(t,r);return{uninstall:function(){"function"==typeof(null==e?void 0:e.removeEventListener)&&e.removeEventListener(t,r)}}}(o.signal,"abort",function(){return si(n,void 0,void 0,function(){return ui(this,function(e){switch(e.label){case 0:return[4,t.close()];case 1:return[2,e.sent()]}})})}),t._configureTransactionExecutor(!0,ci.TELEMETRY_APIS.EXECUTE_QUERY),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,("READ"===o.routing?t.executeRead:t.executeWrite).bind(t)(function(r){return si(n,void 0,void 0,function(){var t;return ui(this,function(e){switch(e.label){case 0:return t=r.run(i,a),[4,o.resultTransformer(t)];case 1:return[2,e.sent()]}})})},o.transactionConfig)];case 2:return[2,e.sent()];case 3:return r.uninstall(),[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})},Ar.default=li;function fi(){this.routing=Ii.WRITE,this.resultTransformer=void 0,this.database="",this.impersonatedUser=void 0,this.bookmarkManager=void 0,this.transactionConfig=void 0,this.auth=void 0,this.signal=void 0}var hi=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},pi=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},di=(Object.defineProperty(P,"__esModule",{value:!0}),P.QueryConfig=P.SessionConfig=P.routing=P.WRITE=P.READ=P.Driver=void 0,y),_i=_(C),yi=b,bi=g,mi=_(T),gi=u,vi=E,Oi=_(m),wi=_(Ar),Ei=r,Ti=36e5,Ci=1e3,Pi=yi.ACCESS_MODE_READ,Si=(P.READ=Pi,yi.ACCESS_MODE_WRITE),Ri=(P.WRITE=Si,0),Ii=(P.SessionConfig=function(){this.defaultAccessMode=Si,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.auth=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0,this.notificationFilter=void 0},{WRITE:"WRITE",READ:"READ"}),O=(P.routing=Ii,Object.freeze(Ii),P.QueryConfig=fi,Object.defineProperty(Ni.prototype,"executeQueryBookmarkManager",{get:function(){return this._defaultExecuteQueryBookmarkManager},enumerable:!1,configurable:!0}),Ni.prototype.executeQuery=function(o,i,a){var s,u;return void 0===a&&(a={}),hi(this,void 0,void 0,function(){var t,r,n;return pi(this,function(e){switch(e.label){case 0:if(t=null===a.bookmarkManager?void 0:null!=(s=a.bookmarkManager)?s:this.executeQueryBookmarkManager,r=null!=(s=a.resultTransformer)?s:Oi.default.eagerResultTransformer(),(n=null!=(u=a.routing)?u:Ii.WRITE)!==Ii.READ&&n!==Ii.WRITE)throw(0,Ei.newError)('Illegal query routing config: "'.concat(n,'"'));return[4,this._queryExecutor.execute({resultTransformer:r,bookmarkManager:t,routing:n,database:a.database,impersonatedUser:a.impersonatedUser,transactionConfig:a.transactionConfig,auth:a.auth,signal:a.signal},o,i)];case 1:return[2,e.sent()]}})})},Ni.prototype.verifyConnectivity=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:Pi})},Ni.prototype.verifyAuthentication=function(e){var e=void 0===e?{}:e,t=e.database,r=e.auth;return hi(this,void 0,void 0,function(){return pi(this,function(e){switch(e.label){case 0:return[4,this._getOrCreateConnectionProvider().verifyAuthentication({database:null!=t?t:"system",auth:r,accessMode:Pi})];case 1:return[2,e.sent()]}})})},Ni.prototype.getServerInfo=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:Pi})},Ni.prototype.supportsMultiDb=function(){return this._getOrCreateConnectionProvider().supportsMultiDb()},Ni.prototype.supportsTransactionConfig=function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()},Ni.prototype.supportsUserImpersonation=function(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()},Ni.prototype.supportsSessionAuth=function(){return this._getOrCreateConnectionProvider().supportsSessionAuth()},Ni.prototype.getNegotiatedProtocolVersion=function(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()},Ni.prototype.isEncrypted=function(){return this._isEncrypted()},Ni.prototype._supportsRouting=function(){return this._meta.routing},Ni.prototype._isEncrypted=function(){return this._config.encrypted===gi.ENCRYPTION_ON||!0===this._config.encrypted},Ni.prototype._getTrust=function(){return this._config.trust},Ni.prototype.session=function(e){var e=void 0===e?{}:e,t=e.defaultAccessMode,r=e.bookmarks,n=e.database,o=e.impersonatedUser,i=e.fetchSize,a=e.bookmarkManager,s=e.notificationFilter,e=e.auth;return this._newSession({defaultAccessMode:void 0===t?Si:t,bookmarkOrBookmarks:r,database:void 0===n?"":n,reactive:!1,impersonatedUser:o,fetchSize:ji(i,this._config.fetchSize),bookmarkManager:a,notificationFilter:s,auth:e})},Ni.prototype.close=function(){return this._log.info("Driver ".concat(this._id," closing")),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()},Ni.prototype[Symbol.asyncDispose]=function(){return this.close()},Ni.prototype._afterConstruction=function(){this._log.info("".concat(this._meta.typename," driver ").concat(this._id," created for server address ").concat(this._meta.address.toString()))},Ni.prototype._newSession=function(e){var t=e.defaultAccessMode,r=e.bookmarkOrBookmarks,n=e.database,o=e.reactive,i=e.impersonatedUser,a=e.fetchSize,s=e.bookmarkManager,u=e.notificationFilter,e=e.auth,t=mi.default._validateSessionMode(t),c=this._getOrCreateConnectionProvider(),r=null!=r?new di.Bookmarks(r):di.Bookmarks.empty();return this._createSession({mode:t,database:null!=n?n:"",connectionProvider:c,bookmarks:r,config:this._config,reactive:o,impersonatedUser:i,fetchSize:a,bookmarkManager:s,notificationFilter:u,auth:e,log:this._log})},Ni.prototype._getOrCreateConnectionProvider=function(){var e;return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,(e=this._config,new _i.default(e.resolver)))),this._connectionProvider},Ni);function Ni(e,t,r,n,o){void 0===n&&(n=function(e){return new mi.default(e)}),void 0===o&&(o=function(e){return new wi.default(e)}),(i=t=void 0===t?{}:t).maxConnectionLifetime=ki(i.maxConnectionLifetime,Ti),i.maxConnectionPoolSize=ki(i.maxConnectionPoolSize,yi.DEFAULT_POOL_MAX_SIZE),i.connectionAcquisitionTimeout=ki(i.connectionAcquisitionTimeout,yi.DEFAULT_POOL_ACQUISITION_TIMEOUT),i.fetchSize=ji(i.fetchSize,Ci),i.connectionTimeout=function(e){e=parseInt(e.connectionTimeout,10);return 0===e||!isNaN(e)&&e<0?null:isNaN(e)?yi.DEFAULT_CONNECTION_TIMEOUT_MILLIS:e}(i),i.connectionLivenessCheckTimeout=function(e){if(null==e)return;e=parseInt(e,10);if(e<0||Number.isNaN(e))throw new Error("The connectionLivenessCheckTimeout can only be a positive value or 0 for always. However connectionLivenessCheckTimeout = ".concat(e));return e}(i.connectionLivenessCheckTimeout);var i=bi.Logger.create(t);!function(e,t){var r=e.resolver;if(null!=r&&"function"!=typeof r)throw new TypeError("Configured resolver should be a function. Got: ".concat(typeof r));e.connectionAcquisitionTimeout<e.connectionTimeout&&t.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired');if(null==(null==(r=e.notificationFilter)?void 0:r.disabledCategories)||null==(null==(t=e.notificationFilter)?void 0:t.disabledClassifications))return;throw new Error('The notificationFilter can\'t have both "disabledCategories" and  "disabledClassifications" configured at the same time.')}(t,i),this._id=Ri++,this._meta=e,this._config=t,this._log=i,this._createConnectionProvider=r,this._createSession=n,this._defaultExecuteQueryBookmarkManager=(0,vi.bookmarkManager)(),this._queryExecutor=o(this.session.bind(this)),this._connectionProvider=null,this._afterConstruction()}function ki(e,t){e=parseInt(e,10);return 0<e||0===e?e:e<0?Number.MAX_SAFE_INTEGER:t}function ji(e,t){e=parseInt(e,10);if(0<e||e===yi.FETCH_ALL)return e;if(0===e||e<0)throw new Error("The fetch size can only be a positive value or ".concat(yi.FETCH_ALL," for ALL. However fetchSize = ").concat(e));return t}P.Driver=O,P.default=O;v={};function Ai(e){return null!=e&&""!==e&&(Object.getPrototypeOf(e)!==Object.prototype||0!==Object.keys(e).length)}Object.defineProperty(v,"__esModule",{value:!0}),v.default={basic:function(e,t,r){return null!=r?{scheme:"basic",principal:e,credentials:t,realm:r}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},bearer:function(e){return{scheme:"bearer",credentials:e}},none:function(){return{scheme:"none"}},custom:function(e,t,r,n,o){n={scheme:n,principal:e};return Ai(t)&&(n.credentials=t),Ai(r)&&(n.realm=r),Ai(o)&&(n.parameters=o),n}};var y={},Di=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Mi=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},C=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ui=(Object.defineProperty(y,"__esModule",{value:!0}),y.staticAuthTokenManager=y.authTokenManagers=y.AuthTokenAndExpiration=void 0,C(v)),Li=d;function xi(){}function Bi(){}xi.prototype.getToken=function(){throw new Error("Not Implemented")},xi.prototype.handleSecurityException=function(e,t){throw new Error("Not implemented")},y.default=xi,y.AuthTokenAndExpiration=function(){this.token=Ui.default.none(),this.expiration=void 0},Bi.prototype.bearer=function(e){e=e.tokenProvider;if("function"!=typeof e)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof e));return new Hi(e,["Neo.ClientError.Security.Unauthorized","Neo.ClientError.Security.TokenExpired"])},Bi.prototype.basic=function(e){var t=this,r=e.tokenProvider;if("function"!=typeof r)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof r));return new Hi(function(){return Di(t,void 0,void 0,function(){var t;return Mi(this,function(e){switch(e.label){case 0:return t={},[4,r()];case 1:return[2,(t.token=e.sent(),t)]}})})},["Neo.ClientError.Security.Unauthorized"])};b=new Bi;y.authTokenManagers=b,Object.freeze(b),y.staticAuthTokenManager=function(e){return e=e.authToken,new zi(e)};qi.prototype.subscribe=function(e){this._subscribers.push(e)},qi.prototype.onCompleted=function(t){this._subscribers.forEach(function(e){return e.onCompleted(t)})},qi.prototype.onError=function(t){this._subscribers.forEach(function(e){return e.onError(t)})};var Fi=qi;function qi(e){this._subscribers=e=void 0===e?[]:e}Vi.prototype.getToken=function(){var t;return Di(this,void 0,void 0,function(){return Mi(this,function(e){switch(e.label){case 0:return void 0===this._currentAuthData||void 0!==this._currentAuthData.expiration&&this._currentAuthData.expiration<new Date?[4,this._refreshAuthToken()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,null==(t=this._currentAuthData)?void 0:t.token]}})})},Vi.prototype.handleSecurityException=function(e,t){return!!this._handledSecurityCodes.includes(t)&&(Li.util.equals(e,null==(t=this._currentAuthData)?void 0:t.token)&&this._scheduleRefreshAuthToken(),!0)},Vi.prototype._scheduleRefreshAuthToken=function(e){var r=this;void 0===this._refreshObservable&&(this._currentAuthData=void 0,this._refreshObservable=new Fi,Promise.resolve(this._tokenProvider()).then(function(e){var t;r._currentAuthData=e,null!=(t=r._refreshObservable)&&t.onCompleted(e)}).catch(function(e){var t;null!=(t=r._refreshObservable)&&t.onError(e)}).finally(function(){r._refreshObservable=void 0})),void 0!==e&&this._refreshObservable.subscribe(e)},Vi.prototype._refreshAuthToken=function(){return Di(this,void 0,void 0,function(){var r=this;return Mi(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e,t){r._scheduleRefreshAuthToken({onCompleted:e,onError:t})})];case 1:return[2,e.sent()]}})})};var Hi=Vi;function Vi(e,t,r,n){this._tokenProvider=e,this._handledSecurityCodes=t,this._currentAuthData=r,this._refreshObservable=n}Wi.prototype.getToken=function(){return this._authToken},Wi.prototype.handleSecurityException=function(e,t){return!1};var zi=Wi;function Wi(e){this._authToken=e}function Gi(){this.encrypted=void 0,this.trust=void 0,this.trustedCertificates=[],this.maxConnectionPoolSize=100,this.maxConnectionLifetime=36e5,this.connectionAcquisitionTimeout=6e4,this.maxTransactionRetryTime=3e4,this.connectionLivenessCheckTimeout=void 0,this.connectionTimeout=3e4,this.disableLosslessIntegers=!1,this.useBigInt=!1,this.logging=void 0,this.resolver=void 0,this.notificationFilter=void 0,this.userAgent=void 0,this.telemetryDisabled=!1,this.clientCertificate=void 0}var Ki,Yi,g={},u=e&&e.__extends||(Ki=function(e,t){return(Ki=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ki(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),_=(Object.defineProperty(g,"__esModule",{value:!0}),g.InternalConfig=g.Config=void 0,g.Config=Gi,u(Zi,Yi=Gi),Zi);function Zi(){return null!==Yi&&Yi.apply(this,arguments)||this}g.InternalConfig=_;var Qi,Ar={},O=e&&e.__extends||(Qi=function(e,t){return(Qi=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Qi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Xi=e&&e.__assign||function(){return(Xi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ji=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),$i=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),C=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Ji(t,e,r);return $i(t,e),t},ea=(Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.resolveCertificateProvider=Ar.clientCertificateProviders=Ar.RotatingClientCertificateProvider=Ar.ClientCertificateProvider=void 0,C(n)),b=(Ar.default=function(){this.certfile="",this.keyfile="",this.password=void 0},ta.prototype.hasUpdate=function(){throw new Error("Not Implemented")},ta.prototype.getClientCertificate=function(){throw new Error("Not Implemented")},ta);function ta(){}Ar.ClientCertificateProvider=b;O(na,ra=b),na.prototype.updateCertificate=function(e){throw new Error("Not implemented")};var ra,u=na;function na(){return null!==ra&&ra.apply(this,arguments)||this}function oa(){}Ar.RotatingClientCertificateProvider=u,oa.prototype.rotating=function(e){var t,e=e.initialCertificate;if(null!=e&&ia(e))return t=Xi({},e),new Ta(t);throw new TypeError("initialCertificate should be ClientCertificate, but got ".concat(ea.stringify(e)))};_=new oa;function ia(e){return null!=e&&"object"==typeof e&&"certfile"in e&&(aa(r=e.certfile)||sa(r,aa))&&"keyfile"in e&&(t(r=e.keyfile)||sa(r,t))&&ua("password",e);function t(e){return"string"==typeof e||null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path&&ua("password",e)}var r}function aa(e){return"string"==typeof e}function sa(e,t,r){return void 0===r&&(r=!1),Array.isArray(e)&&(r||0<e.length)&&e.filter(t).length===e.length}function ua(e,t){return!(e in t)||null==t[e]||"string"==typeof t[e]}Ar.clientCertificateProviders=_,Object.freeze(_),Ar.resolveCertificateProvider=function(e){if(null!=e){if("object"==typeof e&&"hasUpdate"in e&&"getClientCertificate"in e&&"function"==typeof e.getClientCertificate&&"function"==typeof e.hasUpdate)return e;var t;if(ia(e))return t=Xi({},e),{getClientCertificate:function(){return t},hasUpdate:function(){return!1}};throw new TypeError("clientCertificate should be configured with ClientCertificate or ClientCertificateProvider, but got ".concat(ea.stringify(e)))}};Ca.prototype.hasUpdate=function(){try{return this._updated}finally{this._updated=!1}},Ca.prototype.getClientCertificate=function(){return this._certificate},Ca.prototype.updateCertificate=function(e){if(!ia(e))throw new TypeError("certificate should be ClientCertificate, but got ".concat(ea.stringify(e)));this._certificate=Xi({},e),this._updated=!0};var ca,la,fa,ha,pa,da,_a,ya,ba,ma,ga,va,Oa,wa,Ea,Ta=Ca;function Ca(e,t){void 0===t&&(t=!1),this._certificate=e,this._updated=t}C=t,ca=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),la=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),O=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ca(t,e,r);return la(t,e),t},b=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(C,"__esModule",{value:!0}),C.EagerResult=C.Result=C.Stats=C.QueryStatistics=C.ProfiledPlan=C.Plan=C.GqlStatusObject=C.Notification=C.ServerInfo=C.queryType=C.ResultSummary=C.Record=C.isPathSegment=C.PathSegment=C.isPath=C.Path=C.isUnboundRelationship=C.UnboundRelationship=C.isRelationship=C.Relationship=C.isNode=C.Node=C.Time=C.LocalTime=C.LocalDateTime=C.isTime=C.isLocalTime=C.isLocalDateTime=C.isDuration=C.isDateTime=C.isDate=C.Duration=C.DateTime=C.Date=C.Point=C.isPoint=C.internal=C.toString=C.toNumber=C.inSafeRange=C.isInt=C.int=C.Integer=C.error=C.isRetriableError=C.GQLError=C.newGQLError=C.Neo4jError=C.newError=C.authTokenManagers=void 0,C.resolveCertificateProvider=C.clientCertificateProviders=C.notificationFilterMinimumSeverityLevel=C.notificationFilterDisabledClassification=C.notificationFilterDisabledCategory=C.notificationSeverityLevel=C.notificationClassification=C.notificationCategory=C.resultTransformers=C.routing=C.staticAuthTokenManager=C.bookmarkManager=C.auth=C.json=C.driver=C.types=C.Driver=C.Session=C.TransactionPromise=C.ManagedTransaction=C.Transaction=C.Connection=C.Releasable=C.ConnectionProvider=void 0,fa=r,Object.defineProperty(C,"newError",{enumerable:!0,get:function(){return fa.newError}}),Object.defineProperty(C,"Neo4jError",{enumerable:!0,get:function(){return fa.Neo4jError}}),Object.defineProperty(C,"newGQLError",{enumerable:!0,get:function(){return fa.newGQLError}}),Object.defineProperty(C,"GQLError",{enumerable:!0,get:function(){return fa.GQLError}}),Object.defineProperty(C,"isRetriableError",{enumerable:!0,get:function(){return fa.isRetriableError}}),ha=O(o),C.Integer=ha.default,Object.defineProperty(C,"int",{enumerable:!0,get:function(){return ha.int}}),Object.defineProperty(C,"isInt",{enumerable:!0,get:function(){return ha.isInt}}),Object.defineProperty(C,"inSafeRange",{enumerable:!0,get:function(){return ha.inSafeRange}}),Object.defineProperty(C,"toNumber",{enumerable:!0,get:function(){return ha.toNumber}}),Object.defineProperty(C,"toString",{enumerable:!0,get:function(){return ha.toString}}),pa=a,Object.defineProperty(C,"Date",{enumerable:!0,get:function(){return pa.Date}}),Object.defineProperty(C,"DateTime",{enumerable:!0,get:function(){return pa.DateTime}}),Object.defineProperty(C,"Duration",{enumerable:!0,get:function(){return pa.Duration}}),Object.defineProperty(C,"isDate",{enumerable:!0,get:function(){return pa.isDate}}),Object.defineProperty(C,"isDateTime",{enumerable:!0,get:function(){return pa.isDateTime}}),Object.defineProperty(C,"isDuration",{enumerable:!0,get:function(){return pa.isDuration}}),Object.defineProperty(C,"isLocalDateTime",{enumerable:!0,get:function(){return pa.isLocalDateTime}}),Object.defineProperty(C,"isLocalTime",{enumerable:!0,get:function(){return pa.isLocalTime}}),Object.defineProperty(C,"isTime",{enumerable:!0,get:function(){return pa.isTime}}),Object.defineProperty(C,"LocalDateTime",{enumerable:!0,get:function(){return pa.LocalDateTime}}),Object.defineProperty(C,"LocalTime",{enumerable:!0,get:function(){return pa.LocalTime}}),Object.defineProperty(C,"Time",{enumerable:!0,get:function(){return pa.Time}}),da=f,Object.defineProperty(C,"Node",{enumerable:!0,get:function(){return da.Node}}),Object.defineProperty(C,"isNode",{enumerable:!0,get:function(){return da.isNode}}),Object.defineProperty(C,"Relationship",{enumerable:!0,get:function(){return da.Relationship}}),Object.defineProperty(C,"isRelationship",{enumerable:!0,get:function(){return da.isRelationship}}),Object.defineProperty(C,"UnboundRelationship",{enumerable:!0,get:function(){return da.UnboundRelationship}}),Object.defineProperty(C,"isUnboundRelationship",{enumerable:!0,get:function(){return da.isUnboundRelationship}}),Object.defineProperty(C,"Path",{enumerable:!0,get:function(){return da.Path}}),Object.defineProperty(C,"isPath",{enumerable:!0,get:function(){return da.isPath}}),Object.defineProperty(C,"PathSegment",{enumerable:!0,get:function(){return da.PathSegment}}),Object.defineProperty(C,"isPathSegment",{enumerable:!0,get:function(){return da.isPathSegment}}),u=b(h),C.Record=u.default,_a=c,Object.defineProperty(C,"isPoint",{enumerable:!0,get:function(){return _a.isPoint}}),Object.defineProperty(C,"Point",{enumerable:!0,get:function(){return _a.Point}}),ya=O(vt),C.ResultSummary=ya.default,Object.defineProperty(C,"queryType",{enumerable:!0,get:function(){return ya.queryType}}),Object.defineProperty(C,"ServerInfo",{enumerable:!0,get:function(){return ya.ServerInfo}}),Object.defineProperty(C,"Plan",{enumerable:!0,get:function(){return ya.Plan}}),Object.defineProperty(C,"ProfiledPlan",{enumerable:!0,get:function(){return ya.ProfiledPlan}}),Object.defineProperty(C,"QueryStatistics",{enumerable:!0,get:function(){return ya.QueryStatistics}}),Object.defineProperty(C,"Stats",{enumerable:!0,get:function(){return ya.Stats}}),ba=O(I),C.Notification=ba.default,Object.defineProperty(C,"GqlStatusObject",{enumerable:!0,get:function(){return ba.GqlStatusObject}}),Object.defineProperty(C,"notificationCategory",{enumerable:!0,get:function(){return ba.notificationCategory}}),Object.defineProperty(C,"notificationClassification",{enumerable:!0,get:function(){return ba.notificationClassification}}),Object.defineProperty(C,"notificationSeverityLevel",{enumerable:!0,get:function(){return ba.notificationSeverityLevel}}),ma=S,Object.defineProperty(C,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return ma.notificationFilterDisabledCategory}}),Object.defineProperty(C,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return ma.notificationFilterDisabledClassification}}),Object.defineProperty(C,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return ma.notificationFilterMinimumSeverityLevel}}),_=b(hn),C.Result=_.default,r=b(zr),C.EagerResult=r.default,ga=O(w),C.ConnectionProvider=ga.default,Object.defineProperty(C,"Releasable",{enumerable:!0,get:function(){return ga.Releasable}}),o=b(G),C.Connection=o.default,a=b(i),C.Transaction=a.default,f=b(F),C.ManagedTransaction=f.default,h=b(R),C.TransactionPromise=h.default,c=b(T),C.Session=c.default,vt=O(P),I=vt,C.Driver=vt.default,C.driver=I,S=b(v),C.auth=S.default,va=E,Object.defineProperty(C,"bookmarkManager",{enumerable:!0,get:function(){return va.bookmarkManager}}),Oa=y,Object.defineProperty(C,"authTokenManagers",{enumerable:!0,get:function(){return Oa.authTokenManagers}}),Object.defineProperty(C,"staticAuthTokenManager",{enumerable:!0,get:function(){return Oa.staticAuthTokenManager}}),wa=P,Object.defineProperty(C,"routing",{enumerable:!0,get:function(){return wa.routing}}),hn=O(g),C.types=hn,zr=O(n),C.json=zr,b=b(m),C.resultTransformers=b.default,Ea=Ar,Object.defineProperty(C,"clientCertificateProviders",{enumerable:!0,get:function(){return Ea.clientCertificateProviders}}),Object.defineProperty(C,"resolveCertificateProvider",{enumerable:!0,get:function(){return Ea.resolveCertificateProvider}}),O=O(d),C.internal=O,w={SERVICE_UNAVAILABLE:fa.SERVICE_UNAVAILABLE,SESSION_EXPIRED:fa.SESSION_EXPIRED,PROTOCOL_ERROR:fa.PROTOCOL_ERROR},C.error=w,w={authTokenManagers:Oa.authTokenManagers,newError:fa.newError,Neo4jError:fa.Neo4jError,newGQLError:fa.newGQLError,GQLError:fa.GQLError,isRetriableError:fa.isRetriableError,error:w,Integer:ha.default,int:ha.int,isInt:ha.isInt,inSafeRange:ha.inSafeRange,toNumber:ha.toNumber,toString:ha.toString,internal:O,isPoint:_a.isPoint,Point:_a.Point,Date:pa.Date,DateTime:pa.DateTime,Duration:pa.Duration,isDate:pa.isDate,isDateTime:pa.isDateTime,isDuration:pa.isDuration,isLocalDateTime:pa.isLocalDateTime,isLocalTime:pa.isLocalTime,isTime:pa.isTime,LocalDateTime:pa.LocalDateTime,LocalTime:pa.LocalTime,Time:pa.Time,Node:da.Node,isNode:da.isNode,Relationship:da.Relationship,isRelationship:da.isRelationship,UnboundRelationship:da.UnboundRelationship,isUnboundRelationship:da.isUnboundRelationship,Path:da.Path,isPath:da.isPath,PathSegment:da.PathSegment,isPathSegment:da.isPathSegment,Record:u.default,ResultSummary:ya.default,queryType:ya.queryType,ServerInfo:ya.ServerInfo,Notification:ba.default,GqlStatusObject:ba.GqlStatusObject,Plan:ya.Plan,ProfiledPlan:ya.ProfiledPlan,QueryStatistics:ya.QueryStatistics,Stats:ya.Stats,Result:_.default,EagerResult:r.default,Transaction:a.default,ManagedTransaction:f.default,TransactionPromise:h.default,Session:c.default,Driver:vt.default,Connection:o.default,Releasable:ga.Releasable,types:hn,driver:I,json:zr,auth:S.default,bookmarkManager:va.bookmarkManager,routing:wa.routing,resultTransformers:b.default,notificationCategory:ba.notificationCategory,notificationClassification:ba.notificationClassification,notificationSeverityLevel:ba.notificationSeverityLevel,notificationFilterDisabledCategory:ma.notificationFilterDisabledCategory,notificationFilterDisabledClassification:ma.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:ma.notificationFilterMinimumSeverityLevel,clientCertificateProviders:Ea.clientCertificateProviders,resolveCertificateProvider:Ea.resolveCertificateProvider},C.default=w;G={},i={},F={};function Pa(){}Object.defineProperty(F,"__esModule",{value:!0}),Pa.prototype.selectReader=function(e){throw new Error("Abstract function")},Pa.prototype.selectWriter=function(e){throw new Error("Abstract function")},F.default=Pa;R={},T={};function Sa(e){this._offset=e||0}Object.defineProperty(T,"__esModule",{value:!0}),Sa.prototype.next=function(e){var t;return 0===e?-1:(t=this._offset,this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e)},T.default=Sa;var Ra,Ia,v=e&&e.__extends||(Ra=function(e,t){return(Ra=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ra(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Na=(Object.defineProperty(R,"__esModule",{value:!0}),E(T)),y=E(F),P=(Ia=y.default,v(ka,Ia),ka.prototype.selectReader=function(e){return this._select(e,this._readersIndex)},ka.prototype.selectWriter=function(e){return this._select(e,this._writersIndex)},ka.prototype._select=function(e,t){var r=e.length;if(0===r)return null;var n=t.next(r),o=n,i=null,a=Number.MAX_SAFE_INTEGER;do{var s=e[o],u=this._connectionPool.activeResourceCount(s)}while(u<a&&(i=s,a=u),o===r-1?o=0:o++,o!==n);return i},ka);function ka(e){var t=Ia.call(this)||this;return t._readersIndex=new Na.default,t._writersIndex=new Na.default,t._connectionPool=e,t}R.default=P;g=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(i,"__esModule",{value:!0}),i.LeastConnectedLoadBalancingStrategy=i.LoadBalancingStrategy=void 0,n=g(F),i.LoadBalancingStrategy=n.default,m=g(R),i.LeastConnectedLoadBalancingStrategy=m.default,i.default=m.default,Ar={},d={},O={},u={},_={},r={},a={},f={byteLength:function(e){var e=xa(e),t=e[0],e=e[1];return 3*(t+e)/4-e}};f.toByteArray=function(e){var t,r,n=xa(e),o=n[0],n=n[1],i=new Da(function(e,t){return 3*(e+t)/4-t}(o,n)),a=0,s=0<n?o-4:o;for(r=0;r<s;r+=4)t=Aa[e.charCodeAt(r)]<<18|Aa[e.charCodeAt(r+1)]<<12|Aa[e.charCodeAt(r+2)]<<6|Aa[e.charCodeAt(r+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=255&t;2===n&&(t=Aa[e.charCodeAt(r)]<<2|Aa[e.charCodeAt(r+1)]>>4,i[a++]=255&t);1===n&&(t=Aa[e.charCodeAt(r)]<<10|Aa[e.charCodeAt(r+1)]<<4|Aa[e.charCodeAt(r+2)]>>2,i[a++]=t>>8&255,i[a++]=255&t);return i},f.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],i=0,a=r-n;i<a;i+=16383)o.push(function(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(function(e){return ja[e>>18&63]+ja[e>>12&63]+ja[e>>6&63]+ja[63&e]}(n));return o.join("")}(e,i,a<i+16383?a:i+16383));1==n?(t=e[r-1],o.push(ja[t>>2]+ja[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],o.push(ja[t>>10]+ja[t>>4&63]+ja[t<<2&63]+"="));return o.join("")};for(var ja=[],Aa=[],Da="undefined"!=typeof Uint8Array?Uint8Array:Array,Ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ua=0,La=Ma.length;Ua<La;++Ua)ja[Ua]=Ma[Ua],Aa[Ma.charCodeAt(Ua)]=Ua;function xa(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}Aa["-".charCodeAt(0)]=62,Aa["_".charCodeAt(0)]=63;h={read:function(e,t,r,n,o){var i,a,s=8*o-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?o-1:0,h=r?-1:1,o=e[t+f];for(f+=h,i=o&(1<<-l)-1,o>>=-l,l+=s;0<l;i=256*i+e[t+f],f+=h,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;0<l;a=256*a+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(o?-1:1);a+=Math.pow(2,n),i-=c}return(o?-1:1)*a*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var a,s,u=8*i-o-1,c=(1<<u)-1,l=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,p=n?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-a))<1&&(a--,n*=2),2<=(t+=1<=a+l?f/n:f*Math.pow(2,1-l))*n&&(a++,n/=2),c<=a+l?(s=0,a=c):1<=a+l?(s=(t*n-1)*Math.pow(2,o),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,o),a=0));8<=o;e[r+h]=255&s,h+=p,s/=256,o-=8);for(a=a<<o|s,u+=o;0<u;e[r+h]=255&a,h+=p,a/=256,u-=8);e[r+h-p]|=128*i}};{var Ba=a;const Qy=f,Xy=h,Jy=(c="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,Ba.Buffer=N,Ba.SlowBuffer=function(e){+e!=e&&(e=0);return N.alloc(+e)},Ba.INSPECT_MAX_BYTES=50,2147483647);function Fa(e){if(e>Jy)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,N.prototype),e}function N(e,t,r){if("number"!=typeof e)return qa(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Va(e)}function qa(t,r,e){if("string"==typeof t){var n=t;var o=r;"string"==typeof o&&""!==o||(o="utf8");if(!N.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var i=0|Ka(n,o);let e=Fa(i);n=e.write(n,o);n!==i&&(e=e.slice(0,n));return e}if(ArrayBuffer.isView(t))return ys(o=t,Uint8Array)?Wa((i=new Uint8Array(o)).buffer,i.byteOffset,i.byteLength):za(o);if(null!=t){if(ys(t,ArrayBuffer)||t&&ys(t.buffer,ArrayBuffer))return Wa(t,r,e);if("undefined"!=typeof SharedArrayBuffer&&(ys(t,SharedArrayBuffer)||t&&ys(t.buffer,SharedArrayBuffer)))return Wa(t,r,e);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return N.from(n,r,e);var a=function(e){{var t,r;if(N.isBuffer(e))return t=0|Ga(e.length),0!==(r=Fa(t)).length&&e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||bs(e.length)?Fa(0):za(e);if("Buffer"===e.type&&Array.isArray(e.data))return za(e.data)}(t);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return N.from(t[Symbol.toPrimitive]("string"),r,e)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function Ha(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Va(e){return Ha(e),Fa(e<0?0:0|Ga(e))}function za(t){var r=t.length<0?0:0|Ga(t.length),n=Fa(r);for(let e=0;e<r;e+=1)n[e]=255&t[e];return n}function Wa(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,N.prototype),n}function Ga(e){if(e>=Jy)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Jy.toString(16)+" bytes");return 0|e}function Ka(e,t){if(N.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ys(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return ps(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return ds(e).length;default:if(o)return n?-1:ps(e).length;t=(""+t).toLowerCase(),o=!0}}function Ya(e,r,n){let t=!1;if((r=void 0===r||r<0?0:r)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(r>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":{var o=this;var i=r;var a=n;var s=o.length;(!i||i<0)&&(i=0);(!a||a<0||s<a)&&(a=s);let t="";for(let e=i;e<a;++e)t+=rb[o[e]];return t;return}case"utf8":case"utf-8":return es(this,r,n);case"ascii":{var u=this;s=r;var c=n;let t="";c=Math.min(u.length,c);for(let e=s;e<c;++e)t+=String.fromCharCode(127&u[e]);return t;return}case"latin1":case"binary":{var l=this;i=r;var f=n;let t="";f=Math.min(l.length,f);for(let e=i;e<f;++e)t+=String.fromCharCode(l[e]);return t;return}case"base64":return p=this,_=n,0===(d=r)&&_===p.length?Qy.fromByteArray(p):Qy.fromByteArray(p.slice(d,_));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":{p=this;d=r;_=n;var h=p.slice(d,_);let t="";for(let e=0;e<h.length-1;e+=2)t+=String.fromCharCode(h[e]+256*h[e+1]);return t;return}default:if(t)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),t=!0}var p,d,_}function Za(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Qa(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=bs(r=+r)?o?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=N.from(t,n)),N.isBuffer(t))return 0===t.length?-1:Xa(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):Xa(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Xa(r,n,t,e,o){let i=1,a=r.length,s=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(r.length<2||n.length<2)return-1;i=2,a/=2,s/=2,t/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}let c;if(o){let e=-1;for(c=t;c<a;c++)if(u(r,c)===u(n,-1===e?0:c-e)){if(-1===e&&(e=c),c-e+1===s)return e*i}else-1!==e&&(c-=c-e),e=-1}else for(t+s>a&&(t=a-s),c=t;0<=c;c--){let t=!0;for(let e=0;e<s;e++)if(u(r,c+e)!==u(n,e)){t=!1;break}if(t)return c}return-1}function Ja(e,t,r,n){return _s(function(t){var r=[];for(let e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(t),e,r,n)}function $a(e,t,r,n){return _s(function(t,r){var n,o;var i=[];for(let e=0;e<t.length&&!((r-=2)<0);++e)n=t.charCodeAt(e),o=n>>8,i.push(n%256),i.push(o);return i}(t,e.length-r),e,r,n)}function es(a,e,t){t=Math.min(a.length,t);var r=[];let s=e;for(;s<t;){var u=a[s];let o=null,i=239<u?4:223<u?3:191<u?2:1;if(s+i<=t){let e,t,r,n;switch(i){case 1:u<128&&(o=u);break;case 2:128==(192&(e=a[s+1]))&&127<(n=(31&u)<<6|63&e)&&(o=n);break;case 3:e=a[s+1],t=a[s+2],128==(192&e)&&128==(192&t)&&2047<(n=(15&u)<<12|(63&e)<<6|63&t)&&(n<55296||57343<n)&&(o=n);break;case 4:e=a[s+1],t=a[s+2],r=a[s+3],128==(192&e)&&128==(192&t)&&128==(192&r)&&65535<(n=(15&u)<<18|(63&e)<<12|(63&t)<<6|63&r)&&n<1114112&&(o=n)}}null===o?(o=65533,i=1):65535<o&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),s+=i}{var n=r,o=n.length;if(o<=$y)return String.fromCharCode.apply(String,n);let e="",t=0;for(;t<o;)e+=String.fromCharCode.apply(String,n.slice(t,t+=$y));return e}}Ba.kMaxLength=Jy,(N.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(N.prototype,"parent",{enumerable:!0,get:function(){if(N.isBuffer(this))return this.buffer}}),Object.defineProperty(N.prototype,"offset",{enumerable:!0,get:function(){if(N.isBuffer(this))return this.byteOffset}}),N.poolSize=8192,N.from=qa,Object.setPrototypeOf(N.prototype,Uint8Array.prototype),Object.setPrototypeOf(N,Uint8Array),N.alloc=function(e,t,r){return t=t,r=r,Ha(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?Fa(e).fill(t,r):Fa(e).fill(t):Fa(e)},N.allocUnsafe=Va,N.allocUnsafeSlow=Va,N.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==N.prototype},N.compare=function(r,n){if(ys(r,Uint8Array)&&(r=N.from(r,r.offset,r.byteLength)),ys(n,Uint8Array)&&(n=N.from(n,n.offset,n.byteLength)),!N.isBuffer(r)||!N.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;let o=r.length,i=n.length;for(let e=0,t=Math.min(o,i);e<t;++e)if(r[e]!==n[e]){o=r[e],i=n[e];break}return o<i?-1:i<o?1:0},N.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},N.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return N.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=N.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(ys(e,Uint8Array))o+e.length>n.length?(e=N.isBuffer(e)?e:N.from(e)).copy(n,o):Uint8Array.prototype.set.call(n,e,o);else{if(!N.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},N.byteLength=Ka,N.prototype._isBuffer=!0,N.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)Za(this,e,e+1);return this},N.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)Za(this,e,e+3),Za(this,e+1,e+2);return this},N.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)Za(this,e,e+7),Za(this,e+1,e+6),Za(this,e+2,e+5),Za(this,e+3,e+4);return this},N.prototype.toLocaleString=N.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?es(this,0,e):Ya.apply(this,arguments)},N.prototype.equals=function(e){if(N.isBuffer(e))return this===e||0===N.compare(this,e);throw new TypeError("Argument must be a Buffer")},N.prototype.inspect=function(){let e="";var t=Ba.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},c&&(N.prototype[c]=N.prototype.inspect),N.prototype.compare=function(e,t,r,n,o){if(ys(e,Uint8Array)&&(e=N.from(e,e.offset,e.byteLength)),!N.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(o<=n&&r<=t)return 0;if(o<=n)return-1;if(r<=t)return 1;if(this===e)return 0;let i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);var s=Math.min(i,a),u=this.slice(n,o),c=e.slice(t,r);for(let e=0;e<s;++e)if(u[e]!==c[e]){i=u[e],a=c[e];break}return i<a?-1:a<i?1:0},N.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},N.prototype.indexOf=function(e,t,r){return Qa(this,e,t,r,!0)},N.prototype.lastIndexOf=function(e,t,r){return Qa(this,e,t,r,!1)},N.prototype.write=function(t,r,n,e){if(void 0===r)e="utf8",n=this.length,r=0;else if(void 0===n&&"string"==typeof r)e=r,n=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(n)?(n>>>=0,void 0===e&&(e="utf8")):(e=n,n=void 0)}var o,i,a,s=this.length-r;if((void 0===n||s<n)&&(n=s),0<t.length&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");e=e||"utf8";let u=!1;for(;;)switch(e){case"hex":{var c=this;var l=t;var f=r;var h=n;f=Number(f)||0;var p=c.length-f;(!h||p<(h=Number(h)))&&(h=p),(p=l.length)/2<h&&(h=p/2);let e;for(e=0;e<h;++e){var d=parseInt(l.substr(2*e,2),16);if(bs(d))return e;c[f+e]=d}return e;return}case"utf8":case"utf-8":return p=r,a=n,_s(ps(t,(i=this).length-p),i,p,a);case"ascii":case"latin1":case"binary":return Ja(this,t,r,n);case"base64":return i=this,a=r,o=n,_s(ds(t),i,a,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $a(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),u=!0}},N.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const $y=4096;function ts(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function rs(e,t,r,n,o,i){if(!N.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function ns(e,t,r,n,o){ls(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r++]=n,e[r++]=n>>=8,e[r++]=n>>=8,e[r++]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,e[r++]=o>>=8,e[r++]=o>>=8,e[r++]=o>>=8,r}function os(e,t,r,n,o){ls(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r+7]=n,e[r+6]=n>>=8,e[r+5]=n>>=8,e[r+4]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,e[r+2]=o>>=8,e[r+1]=o>>=8,e[r]=o>>=8,r+8}function is(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function as(e,t,r,n,o){return t=+t,r>>>=0,o||is(e,0,r,4),Xy.write(e,t,r,n,23,4),r+4}function ss(e,t,r,n,o){return t=+t,r>>>=0,o||is(e,0,r,8),Xy.write(e,t,r,n,52,8),r+8}N.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(r,N.prototype),r},N.prototype.readUintLE=N.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||ts(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return n},N.prototype.readUintBE=N.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||ts(e,t,this.length);let n=this[e+--t],o=1;for(;0<t&&(o*=256);)n+=this[e+--t]*o;return n},N.prototype.readUint8=N.prototype.readUInt8=function(e,t){return e>>>=0,t||ts(e,1,this.length),this[e]},N.prototype.readUint16LE=N.prototype.readUInt16LE=function(e,t){return e>>>=0,t||ts(e,2,this.length),this[e]|this[e+1]<<8},N.prototype.readUint16BE=N.prototype.readUInt16BE=function(e,t){return e>>>=0,t||ts(e,2,this.length),this[e]<<8|this[e+1]},N.prototype.readUint32LE=N.prototype.readUInt32LE=function(e,t){return e>>>=0,t||ts(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},N.prototype.readUint32BE=N.prototype.readUInt32BE=function(e,t){return e>>>=0,t||ts(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},N.prototype.readBigUInt64LE=ms(function(e){fs(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||hs(e,this.length-8),t+256*this[++e]+65536*this[++e]+this[++e]*2**24),e=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(t)+(BigInt(e)<<BigInt(32))}),N.prototype.readBigUInt64BE=ms(function(e){fs(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||hs(e,this.length-8),t*2**24+65536*this[++e]+256*this[++e]+this[++e]),e=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(t)<<BigInt(32))+BigInt(e)}),N.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||ts(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},N.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||ts(e,t,this.length);let n=t,o=1,i=this[e+--n];for(;0<n&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},N.prototype.readInt8=function(e,t){return e>>>=0,t||ts(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},N.prototype.readInt16LE=function(e,t){e>>>=0,t||ts(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},N.prototype.readInt16BE=function(e,t){e>>>=0,t||ts(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},N.prototype.readInt32LE=function(e,t){return e>>>=0,t||ts(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},N.prototype.readInt32BE=function(e,t){return e>>>=0,t||ts(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},N.prototype.readBigInt64LE=ms(function(e){fs(e>>>=0,"offset");var t=this[e],r=this[e+7],r=(void 0!==t&&void 0!==r||hs(e,this.length-8),this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24));return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),N.prototype.readBigInt64BE=ms(function(e){fs(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||hs(e,this.length-8),(t<<24)+65536*this[++e]+256*this[++e]+this[++e]);return(BigInt(t)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),N.prototype.readFloatLE=function(e,t){return e>>>=0,t||ts(e,4,this.length),Xy.read(this,e,!0,23,4)},N.prototype.readFloatBE=function(e,t){return e>>>=0,t||ts(e,4,this.length),Xy.read(this,e,!1,23,4)},N.prototype.readDoubleLE=function(e,t){return e>>>=0,t||ts(e,8,this.length),Xy.read(this,e,!0,52,8)},N.prototype.readDoubleBE=function(e,t){return e>>>=0,t||ts(e,8,this.length),Xy.read(this,e,!1,52,8)},N.prototype.writeUintLE=N.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||rs(this,e,t,r,Math.pow(2,8*r)-1,0);let o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},N.prototype.writeUintBE=N.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||rs(this,e,t,r,Math.pow(2,8*r)-1,0);let o=r-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+r},N.prototype.writeUint8=N.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,1,255,0),this[t]=255&e,t+1},N.prototype.writeUint16LE=N.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},N.prototype.writeUint16BE=N.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},N.prototype.writeUint32LE=N.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},N.prototype.writeUint32BE=N.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},N.prototype.writeBigUInt64LE=ms(function(e,t=0){return ns(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),N.prototype.writeBigUInt64BE=ms(function(e,t=0){return os(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),N.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||rs(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=0,i=1,a=0;for(this[t]=255&e;++o<r&&(i*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/i>>0)-a&255;return t+r},N.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||rs(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=r-1,i=1,a=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/i>>0)-a&255;return t+r},N.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},N.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},N.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},N.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},N.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||rs(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},N.prototype.writeBigInt64LE=ms(function(e,t=0){return ns(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),N.prototype.writeBigInt64BE=ms(function(e,t=0){return os(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),N.prototype.writeFloatLE=function(e,t,r){return as(this,e,t,!0,r)},N.prototype.writeFloatBE=function(e,t,r){return as(this,e,t,!1,r)},N.prototype.writeDoubleLE=function(e,t,r){return ss(this,e,t,!0,r)},N.prototype.writeDoubleBE=function(e,t,r){return ss(this,e,t,!1,r)},N.prototype.copy=function(e,t,r,n){if(!N.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var o=(n=e.length-t<n-r?e.length-t+r:n)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),o},N.prototype.fill=function(t,r,n,o){if("string"==typeof t){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!N.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var e;1===t.length&&(e=t.charCodeAt(0),"utf8"===o&&e<128||"latin1"===o)&&(t=e)}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(!(n<=r)){r>>>=0,n=void 0===n?this.length:n>>>0;let e;if("number"==typeof(t=t||0))for(e=r;e<n;++e)this[e]=t;else{var i=N.isBuffer(t)?t:N.from(t,o),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(e=0;e<n-r;++e)this[e+r]=i[e%a]}}return this};const eb={};function us(e,t,r){eb[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=this.name+` [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return this.name+` [${e}]: `+this.message}}}function cs(e){let t="",r=e.length;for(var n="-"===e[0]?1:0;r>=4+n;r-=3)t="_"+e.slice(r-3,r)+t;return""+e.slice(0,r)+t}function ls(t,r,n,e,o,i){if(n<t||t<r){var a="bigint"==typeof r?"n":"";let e;throw e=3<i?0===r||r===BigInt(0)?`>= 0${a} and < 2${a} ** `+8*(i+1)+a:`>= -(2${a} ** ${8*(i+1)-1}${a}) and < 2 ** `+(8*(i+1)-1)+a:`>= ${r}${a} and <= `+n+a,new eb.ERR_OUT_OF_RANGE("value",e,t)}r=e,n=i,fs(a=o,"offset"),void 0!==r[a]&&void 0!==r[a+n]||hs(a,r.length-(n+1))}function fs(e,t){if("number"!=typeof e)throw new eb.ERR_INVALID_ARG_TYPE(t,"number",e)}function hs(e,t,r){if(Math.floor(e)!==e)throw fs(e,r),new eb.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new eb.ERR_BUFFER_OUT_OF_BOUNDS;throw new eb.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= `+t,e)}us("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?e+" is outside of buffer bounds":"Attempt to access memory outside buffer bounds"},RangeError),us("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type `+typeof t},TypeError),us("ERR_OUT_OF_RANGE",function(e,t,r){e=`The value of "${e}" is out of range.`;let n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=cs(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=cs(n)),n+="n"),e+=` It must be ${t}. Received `+n},RangeError);const tb=/[^+/0-9A-Za-z-_]/g;function ps(t,r){r=r||1/0;let n;var o=t.length;let i=null;var a=[];for(let e=0;e<o;++e){if(55295<(n=t.charCodeAt(e))&&n<57344){if(!i){if(56319<n){-1<(r-=3)&&a.push(239,191,189);continue}if(e+1===o){-1<(r-=3)&&a.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(r-=3)&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(r-=3)&&a.push(239,191,189);if(i=null,n<128){if(--r<0)break;a.push(n)}else if(n<2048){if((r-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((r-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function ds(e){return Qy.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(tb,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function _s(e,t,r,n){let o;for(o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function ys(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function bs(e){return e!=e}const rb=function(){var r="0123456789abcdef",n=new Array(256);for(let t=0;t<16;++t){var o=16*t;for(let e=0;e<16;++e)n[o+e]=r[t]+r[e]}return n}();function ms(e){return"undefined"==typeof BigInt?gs:e}function gs(){throw new Error("BigInt not supported")}}var vs,vt={},o={},hn=e&&e.__extends||(vs=function(e,t){return(vs=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}vs(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),I=(Object.defineProperty(o,"__esModule",{value:!0}),k.prototype.getUInt8=function(e){throw new Error("Not implemented")},k.prototype.getInt8=function(e){throw new Error("Not implemented")},k.prototype.getFloat64=function(e){throw new Error("Not implemented")},k.prototype.putUInt8=function(e,t){throw new Error("Not implemented")},k.prototype.putInt8=function(e,t){throw new Error("Not implemented")},k.prototype.putFloat64=function(e,t){throw new Error("Not implemented")},k.prototype.getInt16=function(e){return this.getInt8(e)<<8|this.getUInt8(e+1)},k.prototype.getUInt16=function(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)},k.prototype.getInt32=function(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},k.prototype.getUInt32=function(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},k.prototype.getInt64=function(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)},k.prototype.getSlice=function(e,t){return new ws(e,t,this)},k.prototype.putInt16=function(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)},k.prototype.putUInt16=function(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)},k.prototype.putInt32=function(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},k.prototype.putUInt32=function(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},k.prototype.putInt64=function(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)},k.prototype.putBytes=function(e,t){for(var r=0,n=t.remaining();r<n;r++)this.putUInt8(e+r,t.readUInt8())},k.prototype.readUInt8=function(){return this.getUInt8(this._updatePos(1))},k.prototype.readInt8=function(){return this.getInt8(this._updatePos(1))},k.prototype.readUInt16=function(){return this.getUInt16(this._updatePos(2))},k.prototype.readUInt32=function(){return this.getUInt32(this._updatePos(4))},k.prototype.readInt16=function(){return this.getInt16(this._updatePos(2))},k.prototype.readInt32=function(){return this.getInt32(this._updatePos(4))},k.prototype.readInt64=function(){return this.getInt32(this._updatePos(8))},k.prototype.readFloat64=function(){return this.getFloat64(this._updatePos(8))},k.prototype.writeUInt8=function(e){this.putUInt8(this._updatePos(1),e)},k.prototype.writeInt8=function(e){this.putInt8(this._updatePos(1),e)},k.prototype.writeInt16=function(e){this.putInt16(this._updatePos(2),e)},k.prototype.writeInt32=function(e){this.putInt32(this._updatePos(4),e)},k.prototype.writeUInt32=function(e){this.putUInt32(this._updatePos(4),e)},k.prototype.writeInt64=function(e){this.putInt64(this._updatePos(8),e)},k.prototype.writeFloat64=function(e){this.putFloat64(this._updatePos(8),e)},k.prototype.writeBytes=function(e){this.putBytes(this._updatePos(e.remaining()),e)},k.prototype.readSlice=function(e){return this.getSlice(this._updatePos(e),e)},k.prototype._updatePos=function(e){var t=this.position;return this.position+=e,t},k.prototype.remaining=function(){return this.length-this.position},k.prototype.hasRemaining=function(){return 0<this.remaining()},k.prototype.reset=function(){this.position=0},k.prototype.toString=function(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()},k.prototype.toHex=function(){for(var e="",t=0;t<this.length;t++){var r=this.getUInt8(t).toString(16);e+=r=1===r.length?"0"+r:r,t!==this.length-1&&(e+=" ")}return e},k);function k(e){this.position=0,this.length=e}o.default=I;hn(Es,Os=I),Es.prototype.putUInt8=function(e,t){this._inner.putUInt8(this._start+e,t)},Es.prototype.getUInt8=function(e){return this._inner.getUInt8(this._start+e)},Es.prototype.putInt8=function(e,t){this._inner.putInt8(this._start+e,t)},Es.prototype.putFloat64=function(e,t){this._inner.putFloat64(this._start+e,t)},Es.prototype.getInt8=function(e){return this._inner.getInt8(this._start+e)},Es.prototype.getFloat64=function(e){return this._inner.getFloat64(this._start+e)};var Os,ws=Es;function Es(e,t,r){t=Os.call(this,t)||this;return t._start=e,t._inner=r,t}var Ts,Cs,zr=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},S=(Object.defineProperty(vt,"__esModule",{value:!0}),vt.BaseBuffer=void 0,zr(o)),b=(vt.BaseBuffer=S.default,vt.default=S.default,e&&e.__extends||(Ts=function(e,t){return(Ts=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ts(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),C=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ps=(Object.defineProperty(r,"__esModule",{value:!0}),r.alloc=void 0,C(a)),w=C(vt),Ss=(Cs=w.default,b(Rs,Cs),Rs.prototype.getUInt8=function(e){return this._buffer.readUInt8(e)},Rs.prototype.getInt8=function(e){return this._buffer.readInt8(e)},Rs.prototype.getFloat64=function(e){return this._buffer.readDoubleBE(e)},Rs.prototype.putUInt8=function(e,t){this._buffer.writeUInt8(t,e)},Rs.prototype.putInt8=function(e,t){this._buffer.writeInt8(t,e)},Rs.prototype.putFloat64=function(e,t){this._buffer.writeDoubleBE(t,e)},Rs.prototype.putBytes=function(e,t){var r;t instanceof Rs?(r=Math.min(t.length-t.position,this.length-e),t._buffer.copy(this._buffer,e,t.position,t.position+r),t.position+=r):Cs.prototype.putBytes.call(this,e,t)},Rs.prototype.getSlice=function(e,t){return new Rs(this._buffer.slice(e,e+t))},Rs);function Rs(e){var t=this,e=(e=e)instanceof Ps.default.Buffer?e:"number"==typeof e&&"function"==typeof Ps.default.Buffer.alloc?Ps.default.Buffer.alloc(e):new Ps.default.Buffer(e);return(t=Cs.call(this,e.length)||this)._buffer=e,t}r.default=Ss,r.alloc=function(e){return new Ss(e)};var T=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Is=(Object.defineProperty(_,"__esModule",{value:!0}),T(r)),Ns=t,E=Ns.internal.util,ks=E.ENCRYPTION_OFF,js=E.ENCRYPTION_ON;function As(e,t,r){void 0===t&&(t=Ds),void 0===r&&(r=function(e){return new WebSocket(e)});var n,o=this,t=(this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=e,this._receiveTimeout=null,this._receiveTimeoutStarted=!1,this._receiveTimeoutId=null,this._closingPromise=null,function(e,t){var r=function(e){return!0===e.encrypted||e.encrypted===js}(e),n=function(e){return!1===e.encrypted||e.encrypted===ks}(e),e=e.trust,t=function(e){e="function"==typeof e?e():"";return e&&0<=e.toLowerCase().indexOf("https")}(t);if(function(e,t,r){null!==r&&(e&&!r?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&r&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption."))}(r,n,t),!n){if(t)return{scheme:"wss",error:null};if(r)return e&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==e?{scheme:null,error:(0,Ns.newError)("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+e+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+ks+'"` in the driver configuration.')}:{scheme:"wss",error:null}}return{scheme:"ws",error:null}}(e,t)),i=t.scheme,t=t.error;t?this._error=t:(this._ws=function(t,r,n){var o=t+"://"+r.asHostPort();try{return n(o)}catch(e){if(function(e,t){return"SyntaxError"===e.name&&function(e){return"["===e.charAt(0)&&-1!==e.indexOf("]")}(t.asHostPort())}(e,r))return o=function(e,t){var r=t.host().replace(/:/g,"-").replace("%","s")+".ipv6-literal.net";return"".concat(e,"://").concat(r,":").concat(t.port())}(t,r),n(o);throw e}}(i,e.address,r),this._ws.binaryType="arraybuffer",(n=this)._ws.onclose=function(e){e&&!e.wasClean&&n._handleConnectionError(),n._open=!1},this._ws.onopen=function(){n._clearConnectionTimeout();var e=n._pending;n._pending=null;for(var t=0;t<e.length;t++)n.write(e[t])},this._ws.onmessage=function(e){o._resetTimeout(),n.onmessage&&(e=new Is.default(e.data),n.onmessage(e))},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout())}function Ds(){return"undefined"!=typeof window&&window.location?window.location.protocol:null}As.prototype._handleConnectionError=function(){this._connectionTimeoutFired?(this._error=(0,Ns.newError)("Failed to establish connection in ".concat(this._config.connectionTimeout,"ms"),this._config.connectionErrorCode),this.onerror&&this.onerror(this._error)):this._open&&!this._timedout&&(this._error=(0,Ns.newError)("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror)&&this.onerror(this._error)},As.prototype.write=function(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof Is.default))throw(0,Ns.newError)("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(1===this._ws.readyState)throw e;this._handleConnectionError()}}},As.prototype.close=function(){var r=this;return null===this._closingPromise&&(this._closingPromise=new Promise(function(e,t){r._clearConnectionTimeout(),r._ws&&3!==r._ws.readyState?(r._open=!1,r.stopReceiveTimeout(),r._ws.onclose=function(){e()},r._ws.close()):e()})),this._closingPromise},As.prototype.setupReceiveTimeout=function(e){this._receiveTimeout=e},As.prototype.stopReceiveTimeout=function(){null!==this._receiveTimeout&&this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!1,null!=this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=null)},As.prototype.startReceiveTimeout=function(){this._open&&null!==this._receiveTimeout&&!this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!0,this._resetTimeout())},As.prototype._resetTimeout=function(){var e=this;this._receiveTimeoutStarted&&(null!==this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=setTimeout(function(){e._receiveTimeoutId=null,e._timedout=!0,e.stopReceiveTimeout(),e._error=(0,Ns.newError)("Connection lost. Server didn't respond in ".concat(e._receiveTimeout,"ms"),e._config.connectionErrorCode),e.close(),e.onerror&&e.onerror(e._error)},this._receiveTimeout))},As.prototype._setupConnectionTimeout=function(){var e,t=this,r=this._config.connectionTimeout;return r?(e=this._ws,setTimeout(function(){1!==e.readyState&&(t._connectionTimeoutFired=!0,e.close())},r)):null},As.prototype._clearConnectionTimeout=function(){var e=this._connectionTimeoutId;!e&&0!==e||(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))},_.default=As;var Ms,y={},v=e&&e.__extends||(Ms=function(e,t){return(Ms=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ms(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(y,"__esModule",{value:!0});var Us,P=t.internal.resolver.BaseHostNameResolver,F=(v(Ls,Us=P),Ls.prototype.resolve=function(e){return this._resolveToItself(e)},Ls);function Ls(){return null!==Us&&Us.apply(this,arguments)||this}y.default=F;var xs,n={},Bs=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Fs=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},g=(Object.defineProperty(n,"__esModule",{value:!0}),n.default={load:function(t){return Bs(this,void 0,void 0,function(){return Fs(this,function(e){return[2,t]})})}},e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),R=(Object.defineProperty(u,"__esModule",{value:!0}),u.ClientCertificatesLoader=u.HostNameResolver=u.Channel=void 0,g(_)),m=g(y),f=g(n),h=(u.Channel=R.default,u.HostNameResolver=m.default,u.ClientCertificatesLoader=f.default,{}),c={},hn=e&&e.__extends||(xs=function(e,t){return(xs=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}xs(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(c,"__esModule",{value:!0});var qs,Hs=r,I=(qs=vt.BaseBuffer,hn(Vs,qs),Vs.prototype.getUInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getUInt8(e);e-=r.length}},Vs.prototype.getInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getInt8(e);e-=r.length}},Vs.prototype.getFloat64=function(e){for(var t=(0,Hs.alloc)(8),r=0;r<8;r++)t.putUInt8(r,this.getUInt8(e+r));return t.getFloat64(0)},Vs);function Vs(e){for(var t=this,r=0,n=0;n<e.length;n++)r+=e[n].length;return(t=qs.call(this,r)||this)._buffers=e,t}c.default=I;var zs,Ws,zr=e&&e.__extends||(zs=function(e,t){return(zs=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}zs(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),S=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},C=(Object.defineProperty(h,"__esModule",{value:!0}),h.Dechunker=h.Chunker=void 0,S(o)),Gs=r,Ks=S(c),w=(Ws=C.default,zr(Ys,Ws),Ys.prototype.putUInt8=function(e,t){this._ensure(1),this._buffer.writeUInt8(t)},Ys.prototype.putInt8=function(e,t){this._ensure(1),this._buffer.writeInt8(t)},Ys.prototype.putFloat64=function(e,t){this._ensure(8),this._buffer.writeFloat64(t)},Ys.prototype.putBytes=function(e,t){for(;0<t.remaining();)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this},Ys.prototype.flush=function(){var e;return 0<this._buffer.position&&(this._closeChunkIfOpen(),e=this._buffer,this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=(0,Gs.alloc)(this._bufferSize),this._chunkOpen=!1),this},Ys.prototype.messageBoundary=function(){this._closeChunkIfOpen(),this._buffer.remaining()<2&&this.flush(),this._buffer.writeInt16(0)},Ys.prototype._ensure=function(e){e=this._chunkOpen?e:e+2;this._buffer.remaining()<e&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+2,this._chunkOpen=!0)},Ys.prototype._closeChunkIfOpen=function(){var e;this._chunkOpen&&(e=this._buffer.position-(this._currentChunkStart+2),this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1)},Ys);function Ys(e,t){var r=Ws.call(this,0)||this;return r._bufferSize=t||1400,r._ch=e,r._buffer=(0,Gs.alloc)(r._bufferSize),r._currentChunkStart=0,r._chunkOpen=!1,r}function Zs(){this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}h.Chunker=w,Zs.prototype.AWAITING_CHUNK=function(e){return 2<=e.remaining()?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)},Zs.prototype.IN_HEADER=function(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))},Zs.prototype.IN_CHUNK=function(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)},Zs.prototype.CLOSED=function(e){},Zs.prototype._onHeader=function(e){if(0!==e)return this._chunkSize=e,this.IN_CHUNK;var t=void 0;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:t=this._currentMessage[0];break;default:t=new Ks.default(this._currentMessage)}return this._currentMessage=[],this.onmessage(t),this.AWAITING_CHUNK},Zs.prototype.write=function(e){for(;e.hasRemaining();)this._state=this._state(e)},h.Dechunker=Zs;var b={},Qs=(Object.defineProperty(b,"__esModule",{value:!0}),t),T=Qs.internal.util,E=T.ENCRYPTION_OFF,v=T.ENCRYPTION_ON,Xs=Qs.error.SERVICE_UNAVAILABLE,Js=[null,void 0,!0,!1,v,E],$s=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"];b.default=function(e,t,r,n){this.address=e,this.encrypted=function(e){e=e.encrypted;if(-1!==Js.indexOf(e))return e;throw(0,Qs.newError)("Illegal value of the encrypted setting ".concat(e,". Expected one of ").concat(Js))}(t),this.trust=function(e){e=e.trust;if(-1!==$s.indexOf(e))return e;throw(0,Qs.newError)("Illegal value of the trust setting ".concat(e,". Expected one of ").concat($s))}(t),this.trustedCertificates=t.trustedCertificates||[],this.knownHostsPath=t.knownHosts||null,this.connectionErrorCode=r||Xs,this.connectionTimeout=t.connectionTimeout,this.clientCertificate=n};var eu,tu,P={},F={},_={exports:{}};function ru(e,t){for(var r in e)t[r]=e[r]}function nu(e,t,r){return tu(e,t,r)}g=(y=_).exports,(tu=(eu=a).Buffer).from&&tu.alloc&&tu.allocUnsafe&&tu.allocUnsafeSlow?y.exports=eu:(ru(eu,g),g.Buffer=nu),nu.prototype=Object.create(tu.prototype),ru(tu,nu),nu.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return tu(e,t,r)},nu.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=tu(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},nu.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return tu(e)},nu.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return eu.SlowBuffer(e)};var ou=_.exports.Buffer,iu=ou.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function au(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"==typeof t||ou.isEncoding!==iu&&iu(e))return t||e;throw new Error("Unknown encoding: "+e)}function su(e){var t;switch(this.encoding=au(e),this.encoding){case"utf16le":this.text=lu,this.end=fu,t=4;break;case"utf8":this.fillLast=cu,t=4;break;case"base64":this.text=hu,this.end=pu,t=3;break;default:return this.write=du,void(this.end=_u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=ou.allocUnsafe(t)}function uu(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function cu(e){var t,r=this.lastTotal-this.lastNeed,n=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,""):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,""):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,""):void 0:void 0);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function lu(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function fu(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function hu(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function pu(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function du(e){return e.toString(this.encoding)}function _u(e){return e&&e.length?this.write(e):""}(F.StringDecoder=su).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},su.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"":e},su.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(!(n<r)){var o=uu(t[n]);if(0<=o)return 0<o&&(e.lastNeed=o-1),o;if(!(--n<r||-2===o)){if(0<=(o=uu(t[n])))return 0<o&&(e.lastNeed=o-2),o;if(!(--n<r||-2===o)&&0<=(o=uu(t[n])))return 0<o&&(2===o?o=0:e.lastNeed=o-3),o}}return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},su.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};var yu,bu,mu,gu,vu,n=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ou=(Object.defineProperty(P,"__esModule",{value:!0}),n(r)),wu=t,Eu=n(a),Tu=new F.StringDecoder("utf8");P.default={encode:function(e){return new Ou.default((e=e,"function"==typeof Eu.default.Buffer.from?Eu.default.Buffer.from(e,"utf8"):new Eu.default.Buffer(e,"utf8")))},decode:function(e,t){if(Object.prototype.hasOwnProperty.call(e,"_buffer"))return n=t,s=(r=e).position,n=s+n,r.position=Math.min(n,r.length),r._buffer.toString("utf8",s,n);var o,i,a,r,n,s;if(Object.prototype.hasOwnProperty.call(e,"_buffers"))return o=function(e){return Tu.write(e._buffer)},r=function(){return Tu.end()},i=t,a=(s=e).position,s._updatePos(Math.min(t,s.length-a)),s._buffers.reduce(function(e,t){var r,n;return i<=0?e:a>=t.length?(a-=t.length,""):(t._updatePos(a-t.position),r=Math.min(t.length-a,i),n=t.readSlice(r),t._updatePos(r),i=Math.max(i-n.length,0),a=0,e+o(n))},"")+r();throw(0,wu.newError)("Don't know how to decode strings from '".concat(e,"'"))}},R=O,yu=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),m=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||yu(t,e,r)},bu=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(R,"__esModule",{value:!0}),R.utf8=R.alloc=R.ChannelConfig=void 0,m(u,R),m(h,R),mu=b,Object.defineProperty(R,"ChannelConfig",{enumerable:!0,get:function(){return bu(mu).default}}),gu=r,Object.defineProperty(R,"alloc",{enumerable:!0,get:function(){return gu.alloc}}),vu=P,Object.defineProperty(R,"utf8",{enumerable:!0,get:function(){return bu(vu).default}}),Object.defineProperty(d,"__esModule",{value:!0});var Cu=O,Pu=t,Su=1616949271;function Ru(e,t){return{major:e,minor:t}}function Iu(){var e=[[Ru(5,7),Ru(5,0)],[Ru(4,4),Ru(4,2)],Ru(4,1),Ru(3,0)];if(4<e.length)throw(0,Pu.newError)("It should not have more than 4 versions of the protocol");var o=(0,Cu.alloc)(20);return o.writeInt32(Su),e.forEach(function(e){var t,r,n;e instanceof Array?(r=(n=e[0]).major,n=n.minor,t=e[1].minor,o.writeInt32(n-t<<16|n<<8|r)):(r=e.major,n=e.minor,o.writeInt32(n<<8|r))}),o.reset(),o}d.default=function(t,o){var i=this;return new Promise(function(r,n){function e(e){n(e)}t.onerror=e.bind(i),t._error&&e(t._error),t.onmessage=function(t){try{var e=function(e,t){if(72===(e=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()])[0]&&84===e[1]&&84===e[2]&&80===e[3])throw t.error("Handshake failed since server responded with HTTP."),(0,Pu.newError)("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");return Number(e[3]+"."+e[2])}(t,o);r({protocolVersion:e,consumeRemainingBuffer:function(e){t.hasRemaining()&&e(t.readSlice(t.remaining()))}})}catch(e){n(e)}},t.write(Iu())})};var Nu,f={},hn={},I={},o={},S={},c=e&&e.__extends||(Nu=function(e,t){return(Nu=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Nu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},zr=(Object.defineProperty(S,"__esModule",{value:!0}),C(t),ku.ofRecord=function(e){return null===e?ku.ofNull():new Bu(e)},ku.ofMessageResponse=function(e){return null===e?ku.ofNull():new Au(e)},ku.ofNull=function(){return new Uu},Object.defineProperty(ku.prototype,"ttl",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(ku.prototype,"db",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(ku.prototype,"servers",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(ku.prototype,"isNull",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),ku);function ku(){}S.default=zr;c(Du,ju=zr),Object.defineProperty(Du.prototype,"ttl",{get:function(){return this._response.rt.ttl},enumerable:!1,configurable:!0}),Object.defineProperty(Du.prototype,"servers",{get:function(){return this._response.rt.servers},enumerable:!1,configurable:!0}),Object.defineProperty(Du.prototype,"db",{get:function(){return this._response.rt.db},enumerable:!1,configurable:!0}),Object.defineProperty(Du.prototype,"isNull",{get:function(){return null===this._response},enumerable:!1,configurable:!0});var ju,Au=Du;function Du(e){var t=ju.call(this)||this;return t._response=e,t}c(Lu,Mu=zr),Object.defineProperty(Lu.prototype,"isNull",{get:function(){return!0},enumerable:!1,configurable:!0});var Mu,Uu=Lu;function Lu(){return null!==Mu&&Mu.apply(this,arguments)||this}c(Fu,xu=zr),Object.defineProperty(Fu.prototype,"ttl",{get:function(){return this._record.get("ttl")},enumerable:!1,configurable:!0}),Object.defineProperty(Fu.prototype,"servers",{get:function(){return this._record.get("servers")},enumerable:!1,configurable:!0}),Object.defineProperty(Fu.prototype,"db",{get:function(){return this._record.has("db")?this._record.get("db"):null},enumerable:!1,configurable:!0}),Object.defineProperty(Fu.prototype,"isNull",{get:function(){return null===this._record},enumerable:!1,configurable:!0});var xu,Bu=Fu;function Fu(e){var t=xu.call(this)||this;return t._record=e,t}var w={},T={},qu=(Object.defineProperty(T,"__esModule",{value:!0}),T.reuseOngoingRequest=T.identity=void 0,t);T.identity=function(e){return e},T.reuseOngoingRequest=function(o,i){void 0===i&&(i=null);var a=new Map;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,n=qu.json.stringify(e);return a.has(n)?a.get(n):(r=o.apply(i,e),a.set(n,r),r.finally(function(){a.delete(n)}))}};var v={},Hu=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(v,"__esModule",{value:!0}),v.equals=void 0,v.equals=function(e,t){var r,n;if(e!==t){if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;try{for(var a=Hu(o),s=a.next();!s.done;s=a.next()){var u=s.value;if(e[u]!==t[u])return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}return!0};var Vu,zu=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Wu=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),E=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&zu(t,e,r);return Wu(t,e),t},y=(Object.defineProperty(w,"__esModule",{value:!0}),w.object=w.functional=void 0,w.functional=E(T),w.object=E(v),e&&e.__extends||(Vu=function(e,t){return(Vu=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Vu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),g=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Gu=(Object.defineProperty(o,"__esModule",{value:!0}),o.TelemetryObserver=o.ProcedureRouteObserver=o.RouteObserver=o.CompletedObserver=o.FailedObserver=o.ResetObserver=o.LogoffObserver=o.LoginObserver=o.ResultStreamObserver=o.StreamObserver=void 0,t),Ku=g(S),Yu=w,Zu=Gu.internal.constants.FETCH_ALL,Qu=Gu.error.PROTOCOL_ERROR,_=(Xu.prototype.onNext=function(e){},Xu.prototype.onError=function(e){},Xu.prototype.onCompleted=function(e){},Xu);function Xu(){}o.StreamObserver=_;y($u,Ju=_),$u.prototype.pause=function(){this._paused=!0},$u.prototype.resume=function(){this._paused=!1,this._setupAutoPull(!0),this._state.pull(this)},$u.prototype.onNext=function(e){this._haveRecordStreamed=!0;var t=new Gu.Record(this._fieldKeys,e,this._fieldLookup);this._observers.some(function(e){return e.onNext})?this._observers.forEach(function(e){e.onNext&&e.onNext(t)}):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))},$u.prototype.onCompleted=function(e){this._state.onSuccess(this,e)},$u.prototype.onError=function(e){this._state.onError(this,e)},$u.prototype.cancel=function(){this._discard=!0},$u.prototype.prepareToHandleSingleResponse=function(){this._head=[],this._fieldKeys=[],this._setState(yc.STREAMING)},$u.prototype.markCompleted=function(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(yc.SUCCEEDED)},$u.prototype.subscribe=function(e){if(this._head&&e.onKeys&&e.onKeys(this._head),0<this._queuedRecords.length&&e.onNext)for(var t=0;t<this._queuedRecords.length;t++)e.onNext(this._queuedRecords[t]),this._queuedRecords.length-t-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===yc.READY)&&this._handleStreaming();this._tail&&e.onCompleted&&e.onCompleted(this._tail),this._error&&e.onError(this._error),this._observers.push(e),this._state===yc.READY&&this._handleStreaming()},$u.prototype._handleHasMore=function(e){this._setState(yc.READY),this._handleStreaming(),delete e.has_more},$u.prototype._handlePullSuccess=function(e){var t,r=this,n=this._enrichMetadata(Object.assign(this._server?{server:this._server}:{},this._meta,{stream_summary:{have_records_streamed:this._haveRecordStreamed,pulled:this._pulled,has_keys:0<this._fieldKeys.length}},e));[void 0,null,"r","w","rw","s"].includes(n.type)?(this._setState(yc.SUCCEEDED),e=null,t=function(){r._tail=n,r._observers.some(function(e){return e.onCompleted})&&r._observers.forEach(function(e){e.onCompleted&&e.onCompleted(n)}),r._afterComplete&&r._afterComplete(n)},(e=this._beforeComplete?this._beforeComplete(n):e)?Promise.resolve(e).then(t):t()):this.onError((0,Gu.newError)('Server returned invalid query type. Expected one of [undefined, null, "r", "w", "rw", "s"] but got \''.concat(n.type,"'"),Qu))},$u.prototype._handleRunSuccess=function(e,t){var r=this;if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},e.fields&&0<e.fields.length){this._fieldKeys=e.fields;for(var n=0;n<e.fields.length;n++)this._fieldLookup[e.fields[n]]=n}null!=e.fields&&delete e.fields,null!==e.qid&&void 0!==e.qid&&(this._queryId=e.qid,delete e.qid),this._storeMetadataForCompletion(e);var o=null,i=(this._beforeKeys&&(o=this._beforeKeys(this._fieldKeys)),function(){r._head=r._fieldKeys,r._observers.some(function(e){return e.onKeys})&&r._observers.forEach(function(e){e.onKeys&&e.onKeys(r._fieldKeys)}),r._afterKeys&&r._afterKeys(r._fieldKeys),t()});o?Promise.resolve(o).then(i):i()}},$u.prototype._handleError=function(t){function e(){r._observers.some(function(e){return e.onError})&&r._observers.forEach(function(e){e.onError&&e.onError(t)}),r._afterError&&r._afterError(t)}var r=this,n=(this._setState(yc.FAILED),this._error=t,null);this._beforeError&&(n=this._beforeError(t));n?Promise.resolve(n).then(e):e()},$u.prototype._handleStreaming=function(){this._head&&this._observers.some(function(e){return e.onNext||e.onCompleted})&&(this._paused||!this._discard&&!this._autoPull||this._more())},$u.prototype._more=function(){this._discard?this._discardFunction(this._queryId,this):(this._pulled=!0,this._moreFunction(this._queryId,this._fetchSize,this)),this._setState(yc.STREAMING)},$u.prototype._storeMetadataForCompletion=function(e){for(var t,r=Object.keys(e),n=r.length;n--;)t=r[n],this._meta[t]=e[t]},$u.prototype._setState=function(e){this._state=e},$u.prototype._setupAutoPull=function(){this._autoPull=!0};var Ju,n=$u;function $u(e){var e=void 0===e?{}:e,t=e.reactive,t=void 0!==t&&t,r=e.moreFunction,n=e.discardFunction,o=e.fetchSize,o=void 0===o?Zu:o,i=e.beforeError,a=e.afterError,s=e.beforeKeys,u=e.afterKeys,c=e.beforeComplete,l=e.afterComplete,f=e.server,h=e.highRecordWatermark,h=void 0===h?Number.MAX_VALUE:h,p=e.lowRecordWatermark,p=void 0===p?Number.MAX_VALUE:p,e=e.enrichMetadata,d=Ju.call(this)||this;return d._fieldKeys=null,d._fieldLookup=null,d._head=null,d._queuedRecords=[],d._tail=null,d._error=null,d._observers=[],d._meta={},d._server=f,d._beforeError=i,d._afterError=a,d._beforeKeys=s,d._afterKeys=u,d._beforeComplete=c,d._afterComplete=l,d._enrichMetadata=e||Yu.functional.identity,d._queryId=null,d._moreFunction=r,d._discardFunction=n,d._discard=!1,d._fetchSize=o,d._lowRecordWatermark=p,d._highRecordWatermark=h,d._setState(t?yc.READY:yc.READY_STREAMING),d._setupAutoPull(),d._paused=!1,d._pulled=!t,d._haveRecordStreamed=!1,d}o.ResultStreamObserver=n;y(tc,ec=_),tc.prototype.onNext=function(e){this.onError((0,Gu.newError)("Received RECORD when initializing "+Gu.json.stringify(e)))},tc.prototype.onError=function(e){this._onError&&this._onError(e)},tc.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)};var ec,a=tc;function tc(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=ec.call(this)||this;return r._onError=t,r._onCompleted=e,r}o.LoginObserver=a;y(nc,rc=_),nc.prototype.onNext=function(e){this.onError((0,Gu.newError)("Received RECORD when logging off "+Gu.json.stringify(e)))},nc.prototype.onError=function(e){this._onError&&this._onError(e)},nc.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)};var rc,F=nc;function nc(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=rc.call(this)||this;return r._onError=t,r._onCompleted=e,r}o.LogoffObserver=F;y(ic,oc=_),ic.prototype.onNext=function(e){this.onError((0,Gu.newError)("Received RECORD when resetting: received record is: "+Gu.json.stringify(e),Qu))},ic.prototype.onError=function(e){e.code===Qu&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},ic.prototype.onCompleted=function(e){this._onComplete&&this._onComplete(e)};var oc,u=ic;function ic(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onComplete,n=oc.call(this)||this;return n._onProtocolError=t,n._onError=r,n._onComplete=e,n}o.ResetObserver=u;y(sc,ac=n),sc.prototype.onNext=function(e){this.onError((0,Gu.newError)("Received RECORD when sending telemetry "+Gu.json.stringify(e),Qu))},sc.prototype.onError=function(e){this._onError&&this._onError(e)},sc.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)};var ac,m=sc;function sc(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=ac.call(this)||this;return r._onError=t,r._onCompleted=e,r}o.TelemetryObserver=m;y(cc,uc=n);var uc,h=cc;function cc(e){var t=e.error,e=e.onError,e=uc.call(this,{beforeError:e})||this;return e.onError(t),e}o.FailedObserver=h;y(fc,lc=n);var lc,b=fc;function fc(){var e=lc.call(this)||this;return lc.prototype.markCompleted.call(e),e}o.CompletedObserver=b;y(pc,hc=_),pc.prototype.onNext=function(e){this._records.push(e)},pc.prototype.onError=function(e){e.code===Qu&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},pc.prototype.onCompleted=function(){null!==this._records&&1!==this._records.length?this.onError((0,Gu.newError)("Illegal response from router. Received "+this._records.length+" records but expected only one.\n"+Gu.json.stringify(this._records),Qu)):this._onCompleted&&this._onCompleted(Ku.default.ofRecord(this._records[0]))};var hc,r=pc;function pc(e){var t=e.resultObserver,r=e.onProtocolError,n=e.onError,e=e.onCompleted,o=hc.call(this)||this;return o._resultObserver=t,o._onError=n,o._onCompleted=e,o._records=[],o._onProtocolError=r,t.subscribe(o),o}o.ProcedureRouteObserver=r;y(_c,dc=_),_c.prototype.onNext=function(e){this.onError((0,Gu.newError)("Received RECORD when resetting: received record is: "+Gu.json.stringify(e),Qu))},_c.prototype.onError=function(e){e.code===Qu&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},_c.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(Ku.default.ofMessageResponse(e))};var dc,P=_c;function _c(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onCompleted,n=dc.call(this)||this;return n._onProtocolError=t,n._onError=r,n._onCompleted=e,n}o.RouteObserver=P;var yc={READY_STREAMING:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){e._setState(yc.STREAMING)})},onError:function(e,t){e._handleError(t)},name:function(){return"READY_STREAMING"},pull:function(){}},READY:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){return e._handleStreaming()})},onError:function(e,t){e._handleError(t)},name:function(){return"READY"},pull:function(e){return e._more()}},STREAMING:{onSuccess:function(e,t){t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:function(e,t){e._handleError(t)},name:function(){return"STREAMING"},pull:function(){}},FAILED:{onError:function(e){},name:function(){return"FAILED"},pull:function(){}},SUCCEEDED:{name:function(){return"SUCCEEDED"},pull:function(){}}},bc=(Object.defineProperty(I,"__esModule",{value:!0}),I.assertNotificationFilterIsEmpty=I.assertImpersonatedUserIsEmpty=I.assertTxConfigIsEmpty=I.assertDatabaseIsEmpty=void 0,t);I.assertTxConfigIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e&&!e.isEmpty())throw t((e=(0,bc.newError)("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality")).message),r.onError(e),e},I.assertDatabaseIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((e=(0,bc.newError)("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality")).message),r.onError(e),e},I.assertImpersonatedUserIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((t=(0,bc.newError)("Driver is connected to the database that does not support user impersonation. Please upgrade to neo4j 4.4.0 or later in order to use this functionality. "+"Trying to impersonate ".concat(e,"."))).message),r.onError(t),t},I.assertNotificationFilterIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),void 0!==e)throw t((t=(0,bc.newError)("Driver is connected to a database that does not support user notification filters. Please upgrade to Neo4j 5.7.0 or later in order to use this functionality. "+"Trying to set notifications to ".concat(bc.json.stringify(e),"."))).message),r.onError(t),t};var R={},C={},c={},mc=(Object.defineProperty(c,"__esModule",{value:!0}),c.verifyStructSize=c.Structure=void 0,t),gc=mc.error.PROTOCOL_ERROR,zr=(Object.defineProperty(vc.prototype,"size",{get:function(){return this.fields.length},enumerable:!1,configurable:!0}),vc.prototype.toString=function(){for(var e="",t=0;t<this.fields.length;t++)0<t&&(e+=", "),e+=this.fields[t];return"Structure("+this.signature+", ["+e+"])"},vc);function vc(e,t){this.signature=e,this.fields=t}c.Structure=zr,c.verifyStructSize=function(e,t,r){if(t!==r)throw(0,mc.newError)("Wrong struct size for ".concat(e,", expected ").concat(t," but was ").concat(r),gc)},c.default=zr,Object.defineProperty(C,"__esModule",{value:!0}),C.Unpacker=C.Packer=void 0;var Oc=O,wc=w,Ec=c,Tc=t,Cc=Tc.error.PROTOCOL_ERROR;function Pc(e){this._ch=e,this._byteArraysSupported=!0}function Sc(e,t){void 0===t&&(t=!1),this._disableLosslessIntegers=e=void 0===e?!1:e,this._useBigInt=t}Pc.prototype.packable=function(o,i){var e,a=this;void 0===i&&(i=wc.functional.identity);try{o=i(o)}catch(e){return function(){throw e}}if(null===o)return function(){return a._ch.writeUInt8(192)};if(!0===o)return function(){return a._ch.writeUInt8(195)};if(!1===o)return function(){return a._ch.writeUInt8(194)};if("number"==typeof o)return function(){return a.packFloat(o)};if("string"==typeof o)return function(){return a.packString(o)};if("bigint"==typeof o)return function(){return a.packInteger((0,Tc.int)(o))};if((0,Tc.isInt)(o))return function(){return a.packInteger(o)};if(o instanceof Int8Array)return function(){return a.packBytes(o)};if(o instanceof Array)return function(){a.packListHeader(o.length);for(var e=0;e<o.length;e++)a.packable(void 0===o[e]?null:o[e],i)()};if(null!=(e=o)&&"function"==typeof e[Symbol.iterator])return this.packableIterable(o,i);if(o instanceof Ec.Structure){for(var t=[],r=0;r<o.fields.length;r++)t[r]=this.packable(o.fields[r],i);return function(){return a.packStruct(o.signature,t)}}return"object"==typeof o?function(){for(var e=Object.keys(o),t=0,r=0;r<e.length;r++)void 0!==o[e[r]]&&t++;a.packMapHeader(t);for(r=0;r<e.length;r++){var n=e[r];void 0!==o[n]&&(a.packString(n),a.packable(o[n],i)())}}:this._nonPackableValue("Unable to pack the given value: ".concat(o))},Pc.prototype.packableIterable=function(t,e){try{var r=Array.from(t);return this.packable(r,e)}catch(e){throw(0,Tc.newError)("Cannot pack given iterable, ".concat(e.message,": ").concat(t))}},Pc.prototype.packStruct=function(e,t){this.packStructHeader((t=t||[]).length,e);for(var r=0;r<t.length;r++)t[r]()},Pc.prototype.packInteger=function(e){var t=e.high,r=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(r):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(200),this._ch.writeInt8(r)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(201),this._ch.writeInt16(r)):(e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?this._ch.writeUInt8(202):(this._ch.writeUInt8(203),this._ch.writeInt32(t)),this._ch.writeInt32(r))},Pc.prototype.packFloat=function(e){this._ch.writeUInt8(193),this._ch.writeFloat64(e)},Pc.prototype.packString=function(e){var e=Oc.utf8.encode(e),t=e.length;if(t<16)this._ch.writeUInt8(128|t);else if(t<256)this._ch.writeUInt8(208),this._ch.writeUInt8(t);else{if(t<65536)this._ch.writeUInt8(209),this._ch.writeUInt8(t/256>>0);else{if(!(t<4294967296))throw(0,Tc.newError)("UTF-8 strings of size "+t+" are not supported");this._ch.writeUInt8(210),this._ch.writeUInt8((t/16777216>>0)%256),this._ch.writeUInt8((t/65536>>0)%256),this._ch.writeUInt8((t/256>>0)%256)}this._ch.writeUInt8(t%256)}this._ch.writeBytes(e)},Pc.prototype.packListHeader=function(e){if(e<16)this._ch.writeUInt8(144|e);else if(e<256)this._ch.writeUInt8(212),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(213);else{if(!(e<4294967296))throw(0,Tc.newError)("Lists of size "+e+" are not supported");this._ch.writeUInt8(214),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},Pc.prototype.packBytes=function(e){if(!this._byteArraysSupported)throw(0,Tc.newError)("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(e.length);for(var t=0;t<e.length;t++)this._ch.writeInt8(e[t])},Pc.prototype.packBytesHeader=function(e){if(e<256)this._ch.writeUInt8(204),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(205);else{if(!(e<4294967296))throw(0,Tc.newError)("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(206),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},Pc.prototype.packMapHeader=function(e){if(e<16)this._ch.writeUInt8(160|e);else if(e<256)this._ch.writeUInt8(216),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(217),this._ch.writeUInt8(e/256>>0);else{if(!(e<4294967296))throw(0,Tc.newError)("Maps of size "+e+" are not supported");this._ch.writeUInt8(218),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256)}this._ch.writeUInt8(e%256)}},Pc.prototype.packStructHeader=function(e,t){if(e<16)this._ch.writeUInt8(176|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(220),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw(0,Tc.newError)("Structures of size "+e+" are not supported");this._ch.writeUInt8(221),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}},Pc.prototype.disableByteArrays=function(){this._byteArraysSupported=!1},Pc.prototype._nonPackableValue=function(e){return function(){throw(0,Tc.newError)(e,Cc)}},C.Packer=Pc,Sc.prototype.unpack=function(e,t){void 0===t&&(t=wc.functional.identity);var r=e.readUInt8(),n=240&r,o=15&r;if(192===r)return null;var i=this._unpackBoolean(r);if(null!==i)return i;i=this._unpackNumberOrInteger(r,e);if(null!==i){if((0,Tc.isInt)(i)){if(this._useBigInt)return i.toBigInt();if(this._disableLosslessIntegers)return i.toNumberOrInfinity()}return i}i=this._unpackString(r,n,o,e);if(null!==i)return i;i=this._unpackList(r,n,o,e,t);if(null!==i)return i;i=this._unpackByteArray(r,e);if(null!==i)return i;i=this._unpackMap(r,n,o,e,t);if(null!==i)return i;i=this._unpackStruct(r,n,o,e,t);if(null!==i)return i;throw(0,Tc.newError)("Unknown packed value with marker "+r.toString(16))},Sc.prototype.unpackInteger=function(e){var t=e.readUInt8(),e=this._unpackInteger(t,e);if(null==e)throw(0,Tc.newError)("Unable to unpack integer value with marker "+t.toString(16));return e},Sc.prototype._unpackBoolean=function(e){return 195===e||194!==e&&null},Sc.prototype._unpackNumberOrInteger=function(e,t){return 193===e?t.readFloat64():this._unpackInteger(e,t)},Sc.prototype._unpackInteger=function(e,t){var r;return 0<=e&&e<128?(0,Tc.int)(e):240<=e&&e<256?(0,Tc.int)(e-256):200===e?(0,Tc.int)(t.readInt8()):201===e?(0,Tc.int)(t.readInt16()):202===e?(r=t.readInt32(),(0,Tc.int)(r)):203===e?(r=t.readInt32(),e=t.readInt32(),new Tc.Integer(e,r)):null},Sc.prototype._unpackString=function(e,t,r,n){return 128===t?Oc.utf8.decode(n,r):208===e?Oc.utf8.decode(n,n.readUInt8()):209===e?Oc.utf8.decode(n,n.readUInt16()):210===e?Oc.utf8.decode(n,n.readUInt32()):null},Sc.prototype._unpackList=function(e,t,r,n,o){return 144===t?this._unpackListWithSize(r,n,o):212===e?this._unpackListWithSize(n.readUInt8(),n,o):213===e?this._unpackListWithSize(n.readUInt16(),n,o):214===e?this._unpackListWithSize(n.readUInt32(),n,o):null},Sc.prototype._unpackListWithSize=function(e,t,r){for(var n=[],o=0;o<e;o++)n.push(this.unpack(t,r));return n},Sc.prototype._unpackByteArray=function(e,t){return 204===e?this._unpackByteArrayWithSize(t.readUInt8(),t):205===e?this._unpackByteArrayWithSize(t.readUInt16(),t):206===e?this._unpackByteArrayWithSize(t.readUInt32(),t):null},Sc.prototype._unpackByteArrayWithSize=function(e,t){for(var r=new Int8Array(e),n=0;n<e;n++)r[n]=t.readInt8();return r},Sc.prototype._unpackMap=function(e,t,r,n,o){return 160===t?this._unpackMapWithSize(r,n,o):216===e?this._unpackMapWithSize(n.readUInt8(),n,o):217===e?this._unpackMapWithSize(n.readUInt16(),n,o):218===e?this._unpackMapWithSize(n.readUInt32(),n,o):null},Sc.prototype._unpackMapWithSize=function(e,t,r){for(var n={},o=0;o<e;o++)n[this.unpack(t,r)]=this.unpack(t,r);return n},Sc.prototype._unpackStruct=function(e,t,r,n,o){return 176===t?this._unpackStructWithSize(r,n,o):220===e?this._unpackStructWithSize(n.readUInt8(),n,o):221===e?this._unpackStructWithSize(n.readUInt16(),n,o):null},Sc.prototype._unpackStructWithSize=function(e,t,r){for(var n=t.readUInt8(),o=new Ec.Structure(n,[]),i=0;i<e;i++)o.fields.push(this.unpack(t,r));return r(o)},C.Unpacker=Sc;var Rc,Ic,E={},v=e&&e.__extends||(Rc=function(e,t){return(Rc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Rc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Nc=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),kc=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),g=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Nc(t,e,r);return kc(t,e),t},a=(Object.defineProperty(E,"__esModule",{value:!0}),E.Unpacker=E.Packer=void 0,g(C)),F=(Ic=a.Packer,v(jc,Ic),jc.prototype.disableByteArrays=function(){throw new Error("Bolt V2 should always support byte arrays")},jc);function jc(){return null!==Ic&&Ic.apply(this,arguments)||this}E.Packer=F;Ac=a.Unpacker,v(Dc,Ac);var Ac,u=Dc;function Dc(e,t){return Ac.call(this,e=void 0===e?!1:e,t=void 0===t?!1:t)||this}E.Unpacker=u;var Mc=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Uc=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),m=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Mc(t,e,r);return Uc(t,e),t},h=(Object.defineProperty(R,"__esModule",{value:!0}),R.structure=R.v2=R.v1=void 0,m(C)),n=(R.v1=h,m(E)),b=(R.v2=n,m(c)),r=(R.structure=b,R.default=n,{}),Lc=(Object.defineProperty(r,"__esModule",{value:!0}),r.SIGNATURES=void 0,t),y=Lc.internal.constants,xc=y.ACCESS_MODE_READ,Bc=y.FETCH_ALL,Fc=Lc.internal.util.assertString,_=Object.freeze({INIT:1,RESET:15,RUN:16,PULL_ALL:63,HELLO:1,GOODBYE:2,BEGIN:17,COMMIT:18,ROLLBACK:19,TELEMETRY:84,ROUTE:102,LOGON:106,LOGOFF:107,DISCARD:47,PULL:63}),P=(r.SIGNATURES=_,j.init=function(e,t){return new j(1,[e,t],function(){return"INIT ".concat(e," {...}")})},j.run=function(e,t){return new j(16,[e,t],function(){return"RUN ".concat(e," ").concat(Lc.json.stringify(t))})},j.pullAll=function(){return Wc},j.reset=function(){return Gc},j.hello=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);t=Object.assign({user_agent:e},t);return r&&(t.routing=r),n&&(t.patch_bolt=n),new j(1,[t],function(){return"HELLO {user_agent: '".concat(e,"', ...}")})},j.hello5x1=function(e,t){var r={user_agent:e};return(t=void 0===t?null:t)&&(r.routing=t),new j(1,[r],function(){return"HELLO {user_agent: '".concat(e,"', ...}")})},j.hello5x2=function(e,t,r){void 0===r&&(r=null);var n={user_agent:e};return Vc(n,t=void 0===t?null:t),r&&(n.routing=r),new j(1,[n],function(){return"HELLO ".concat(Lc.json.stringify(n))})},j.hello5x3=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var o={};return e&&(o.user_agent=e),t&&(o.bolt_agent={product:t.product,platform:t.platform,language:t.language,language_details:t.languageDetails}),Vc(o,r),n&&(o.routing=n),new j(1,[o],function(){return"HELLO ".concat(Lc.json.stringify(o))})},j.hello5x5=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var o={};return e&&(o.user_agent=e),t&&(o.bolt_agent={product:t.product,platform:t.platform,language:t.language,language_details:t.languageDetails}),zc(o,r),n&&(o.routing=n),new j(1,[o],function(){return"HELLO ".concat(Lc.json.stringify(o))})},j.logon=function(e){return new j(106,[e],function(){return"LOGON { ... }"})},j.logoff=function(){return new j(107,[],function(){return"LOGOFF"})},j.begin=function(e){var e=void 0===e?{}:e,t=qc(e.bookmarks,e.txConfig,e.database,e.mode,e.impersonatedUser,e.notificationFilter);return new j(17,[t],function(){return"BEGIN ".concat(Lc.json.stringify(t))})},j.begin5x5=function(e){var e=void 0===e?{}:e,t=qc(e.bookmarks,e.txConfig,e.database,e.mode,e.impersonatedUser,e.notificationFilter,{appendNotificationFilter:zc});return new j(17,[t],function(){return"BEGIN ".concat(Lc.json.stringify(t))})},j.commit=function(){return Kc},j.rollback=function(){return Yc},j.runWithMetadata=function(e,t,r){var r=void 0===r?{}:r,n=qc(r.bookmarks,r.txConfig,r.database,r.mode,r.impersonatedUser,r.notificationFilter);return new j(16,[e,t,n],function(){return"RUN ".concat(e," ").concat(Lc.json.stringify(t)," ").concat(Lc.json.stringify(n))})},j.runWithMetadata5x5=function(e,t,r){var r=void 0===r?{}:r,n=qc(r.bookmarks,r.txConfig,r.database,r.mode,r.impersonatedUser,r.notificationFilter,{appendNotificationFilter:zc});return new j(16,[e,t,n],function(){return"RUN ".concat(e," ").concat(Lc.json.stringify(t)," ").concat(Lc.json.stringify(n))})},j.goodbye=function(){return Zc},j.pull=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?-1:t,e=e.n,r=Hc(null==t?-1:t,(void 0===e?Bc:e)||Bc);return new j(63,[r],function(){return"PULL ".concat(Lc.json.stringify(r))})},j.discard=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?-1:t,e=e.n,r=Hc(null==t?-1:t,(void 0===e?Bc:e)||Bc);return new j(47,[r],function(){return"DISCARD ".concat(Lc.json.stringify(r))})},j.telemetry=function(e){var e=e.api,t=(0,Lc.int)(e);return new j(84,[t],function(){return"TELEMETRY ".concat(t.toString())})},j.route=function(e,t,r){return new j(102,[e=void 0===e?{}:e,t=void 0===t?[]:t,r=void 0===r?null:r],function(){return"ROUTE ".concat(Lc.json.stringify(e)," ").concat(Lc.json.stringify(t)," ").concat(r)})},j.routeV4x4=function(e,t,r){void 0===e&&(e={}),void 0===t&&(t=[]);var n={};return(r=void 0===r?{}:r).databaseName&&(n.db=r.databaseName),r.impersonatedUser&&(n.imp_user=r.impersonatedUser),new j(102,[e,t,n],function(){return"ROUTE ".concat(Lc.json.stringify(e)," ").concat(Lc.json.stringify(t)," ").concat(Lc.json.stringify(n))})},j);function j(e,t,r){this.signature=e,this.fields=t,this.toString=r}function qc(e,t,r,n,o,i,a){void 0===a&&(a={});var s={};return e.isEmpty()||(s.bookmarks=e.values()),null!==t.timeout&&(s.tx_timeout=t.timeout),t.metadata&&(s.tx_metadata=t.metadata),r&&(s.db=Fc(r,"database")),o&&(s.imp_user=Fc(o,"impersonatedUser")),n===xc&&(s.mode="r"),(null!=(e=a.appendNotificationFilter)?e:Vc)(s,i),s}function Hc(e,t){t={n:(0,Lc.int)(t)};return-1!==e&&(t.qid=(0,Lc.int)(e)),t}function Vc(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_categories=t.disabledCategories),t.disabledClassifications)&&(e.notifications_disabled_categories=t.disabledClassifications)}function zc(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_classifications=t.disabledCategories),t.disabledClassifications)&&(e.notifications_disabled_classifications=t.disabledClassifications)}var Wc=new(r.default=P)(63,[],function(){return"PULL_ALL"}),Gc=new P(15,[],function(){return"RESET"}),Kc=new P(18,[],function(){return"COMMIT"}),Yc=new P(19,[],function(){return"ROLLBACK"}),Zc=new P(2,[],function(){return"GOODBYE"}),zr={},g={},Qc=(Object.defineProperty(g,"__esModule",{value:!0}),g.TypeTransformer=void 0,R),Xc=t.internal.objectUtil;function Jc(e){this._transformers=e,this._transformersPerSignature=new Map(e.map(function(e){return[e.signature,e]})),this.fromStructure=this.fromStructure.bind(this),this.toStructure=this.toStructure.bind(this),Object.freeze(this)}function $c(e){var t=e.signature,r=e.fromStructure,n=e.toStructure,e=e.isTypeInstance;this.signature=t,this.isTypeInstance=e,this.fromStructure=r,this.toStructure=n,Object.freeze(this)}Jc.prototype.fromStructure=function(e){try{return e instanceof Qc.structure.Structure&&this._transformersPerSignature.has(e.signature)?(0,this._transformersPerSignature.get(e.signature).fromStructure)(e):e}catch(e){return Xc.createBrokenObject(e)}},Jc.prototype.toStructure=function(t){var e=this._transformers.find(function(e){return(0,e.isTypeInstance)(t)});return void 0!==e?e.toStructure(t):t},g.default=Jc,$c.prototype.extendsWith=function(e){var t=e.signature,r=e.fromStructure,n=e.toStructure,e=e.isTypeInstance;return new $c({signature:t||this.signature,fromStructure:r||this.fromStructure,toStructure:n||this.toStructure,isTypeInstance:e||this.isTypeInstance})},g.TypeTransformer=$c;var el=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},tl=(Object.defineProperty(zr,"__esModule",{value:!0}),t),rl=R,nl=g,ol=tl.error.PROTOCOL_ERROR;zr.default={createNodeTransformer:function(){return new nl.TypeTransformer({signature:78,isTypeInstance:function(e){return e instanceof tl.Node},toStructure:function(e){throw(0,tl.newError)("It is not allowed to pass nodes in query parameters, given: ".concat(e),ol)},fromStructure:function(e){rl.structure.verifyStructSize("Node",3,e.size);var e=el(e.fields,3),t=e[0],r=e[1],e=e[2];return new tl.Node(t,r,e)}})},createRelationshipTransformer:function(){return new nl.TypeTransformer({signature:82,isTypeInstance:function(e){return e instanceof tl.Relationship},toStructure:function(e){throw(0,tl.newError)("It is not allowed to pass relationships in query parameters, given: ".concat(e),ol)},fromStructure:function(e){rl.structure.verifyStructSize("Relationship",5,e.size);var e=el(e.fields,5),t=e[0],r=e[1],n=e[2],o=e[3],e=e[4];return new tl.Relationship(t,r,n,o,e)}})},createUnboundRelationshipTransformer:function(){return new nl.TypeTransformer({signature:114,isTypeInstance:function(e){return e instanceof tl.UnboundRelationship},toStructure:function(e){throw(0,tl.newError)("It is not allowed to pass unbound relationships in query parameters, given: ".concat(e),ol)},fromStructure:function(e){rl.structure.verifyStructSize("UnboundRelationship",3,e.size);var e=el(e.fields,3),t=e[0],r=e[1],e=e[2];return new tl.UnboundRelationship(t,r,e)}})},createPathTransformer:function(){return new nl.TypeTransformer({signature:80,isTypeInstance:function(e){return e instanceof tl.Path},toStructure:function(e){throw(0,tl.newError)("It is not allowed to pass paths in query parameters, given: ".concat(e),ol)},fromStructure:function(e){rl.structure.verifyStructSize("Path",3,e.size);for(var e=el(e.fields,3),t=e[0],r=e[1],n=e[2],o=[],i=t[0],a=0;a<n.length;a+=2){var s=t[n[a+1]],u=(0,tl.toNumber)(n[a]),c=void 0;0<u?(c=r[u-1])instanceof tl.UnboundRelationship&&(r[u-1]=c=c.bindTo(i,s)):(c=r[-u-1])instanceof tl.UnboundRelationship&&(r[-u-1]=c=c.bindTo(s,i)),o.push(new tl.PathSegment(i,c,s)),i=s}return new tl.Path(t[0],t[t.length-1],o)}})}};var il=e&&e.__assign||function(){return(il=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},al=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),sl=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),F=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&al(t,e,r);return sl(t,e),t},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ul=(Object.defineProperty(hn,"__esModule",{value:!0}),I),cl=R,ll=F(r),fl=o,hl=t,pl=a(zr),dl=a(g),_l=hl.internal.bookmarks.Bookmarks,v=hl.internal.constants,yl=v.ACCESS_MODE_WRITE,bl=v.BOLT_PROTOCOL_V1,ml=(hl.internal.logger.Logger,hl.internal.txConfig.TxConfig),gl=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),u=(Object.defineProperty(A.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new dl.default(Object.values(pl.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"version",{get:function(){return bl},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"supportsReAuth",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"initialized",{get:function(){return!!this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"authToken",{get:function(){return this._authToken},enumerable:!1,configurable:!0}),A.prototype.packer=function(){return this._packer},A.prototype.packable=function(e){return this._packer.packable(e,this.transformer.toStructure)},A.prototype.unpacker=function(){return this._unpacker},A.prototype.unpack=function(e){return this._unpacker.unpack(e,this.transformer.fromStructure)},A.prototype.transformMetadata=function(e){return e},A.prototype.enrichErrorMetadata=function(e){return il(il({},e),{diagnostic_record:null!==e.diagnostic_record?il(il({},gl),e.diagnostic_record):null})},A.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,e=new fl.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,a)}});return(0,ul.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(ll.default.init(r,n),e,!0),e},A.prototype.logoff=function(e){var e=void 0===e?{}:e,t=e.onComplete,r=e.onError,e=(e.flush,new fl.LogoffObserver({onCompleted:t,onError:r})),t=(0,hl.newError)("Driver is connected to a database that does not support logoff. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(t.message),e.onError(t),t},A.prototype.logon=function(e){var t=this,e=void 0===e?{}:e,r=e.authToken,n=e.onComplete,o=e.onError,e=(e.flush,new fl.LoginObserver({onCompleted:function(){return t._onLoginCompleted({},r,n)},onError:function(e){return t._onLoginError(e,o)}})),i=(0,hl.newError)("Driver is connected to a database that does not support logon. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(i.message),e.onError(i),i},A.prototype.prepareToClose=function(){},A.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete;return this.run("BEGIN",t?t.asBeginTransactionParameters():{},{bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i,notificationFilter:a,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e,flush:!1})},A.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete;return this.run("COMMIT",{},{bookmarks:_l.empty(),txConfig:ml.empty(),mode:yl,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e})},A.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete;return this.run("ROLLBACK",{},{bookmarks:_l.empty(),txConfig:ml.empty(),mode:yl,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e})},A.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=(r.bookmarks,r.txConfig),o=r.database,i=(r.mode,r.impersonatedUser),a=r.notificationFilter,s=r.beforeKeys,u=r.afterKeys,c=r.beforeError,l=r.afterError,f=r.beforeComplete,h=r.afterComplete,p=r.flush,p=void 0===p||p,d=r.highRecordWatermark,d=void 0===d?Number.MAX_VALUE:d,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,s=new fl.ResultStreamObserver({server:this._server,beforeKeys:s,afterKeys:u,beforeError:c,afterError:l,beforeComplete:f,afterComplete:h,highRecordWatermark:d,lowRecordWatermark:r});return(0,ul.assertTxConfigIsEmpty)(n,this._onProtocolError,s),(0,ul.assertDatabaseIsEmpty)(o,this._onProtocolError,s),(0,ul.assertImpersonatedUserIsEmpty)(i,this._onProtocolError,s),(0,ul.assertNotificationFilterIsEmpty)(a,this._onProtocolError,s),this.write(ll.default.run(e,t),s,!1),this.write(ll.default.pullAll(),s,p),s},Object.defineProperty(A.prototype,"currentFailure",{get:function(){return this._responseHandler.currentFailure},enumerable:!1,configurable:!0}),A.prototype.reset=function(e){var e=void 0===e?{}:e,t=e.onError,e=e.onComplete,t=new fl.ResetObserver({onProtocolError:this._onProtocolError,onError:t,onComplete:e});return this.write(ll.default.reset(),t,!0),t},A.prototype.telemetry=function(e,t){e.api;e=void 0===t?{}:t,e.onError,t=e.onCompleted,e=new fl.CompletedObserver;return t&&t(),e},A.prototype._createPacker=function(e){return new cl.v1.Packer(e)},A.prototype._createUnpacker=function(e,t){return new cl.v1.Unpacker(e,t)},A.prototype.write=function(e,t,r){this.queueObserverIfProtocolIsNotBroken(t)&&(this._log.isDebugEnabled()&&this._log.debug("C: ".concat(e)),this._lastMessageSignature=e.signature,t=new cl.structure.Structure(e.signature,e.fields),this.packable(t)(),this._chunker.messageBoundary(),r)&&this._chunker.flush()},A.prototype.isLastMessageLogon=function(){return this._lastMessageSignature===ll.SIGNATURES.HELLO||this._lastMessageSignature===ll.SIGNATURES.LOGON},A.prototype.isLastMessageReset=function(){return this._lastMessageSignature===ll.SIGNATURES.RESET},A.prototype.notifyFatalError=function(e){return this._fatalError=e,this._responseHandler._notifyErrorToObservers(e)},A.prototype.updateCurrentObserver=function(){return this._responseHandler._updateCurrentObserver()},A.prototype.hasOngoingObservableRequests=function(){return this._responseHandler.hasOngoingObservableRequests()},A.prototype.queueObserverIfProtocolIsNotBroken=function(e){return this.isBroken()?(this.notifyFatalErrorToObserver(e),!1):this._responseHandler._queueObserver(e)},A.prototype.isBroken=function(){return!!this._fatalError},A.prototype.notifyFatalErrorToObserver=function(e){e&&e.onError&&e.onError(this._fatalError)},A.prototype.resetFailure=function(){this._responseHandler._resetFailure()},A.prototype._onLoginCompleted=function(e,t,r){this._initialized=!0,this._authToken=t,e&&(t=e.server,this._server.version||(this._server.version=t)),r&&r(e)},A.prototype._onLoginError=function(e,t){this._onProtocolError(e.message),t&&t(e)},A);function A(e,t,r,n,o,i){var r=void 0===r?{}:r,a=r.disableLosslessIntegers,r=r.useBigInt;void 0===n&&(n=function(){return null}),this._server=e||{},this._chunker=t,this._packer=this._createPacker(t),this._unpacker=this._createUnpacker(a,r),this._responseHandler=n(this),this._log=o,this._onProtocolError=i,this._fatalError=null,this._lastMessageSignature=null,this._config={disableLosslessIntegers:a,useBigInt:r}}hn.default=u;var C={},h={},E={},vl=(Object.defineProperty(E,"__esModule",{value:!0}),E.epochSecondAndNanoToLocalDateTime=E.nanoOfDayToLocalTime=E.epochDayToDate=void 0,t),m=vl.internal.temporalUtil,Ol=m.DAYS_0000_TO_1970,wl=m.DAYS_PER_400_YEAR_CYCLE,El=m.NANOS_PER_HOUR,Tl=m.NANOS_PER_MINUTE,Cl=m.NANOS_PER_SECOND,Pl=m.SECONDS_PER_DAY,Sl=m.floorDiv,Rl=m.floorMod;function Il(e){var e=(e=(0,vl.int)(e)).add(Ol).subtract(60),t=(0,vl.int)(0),r=(e.lessThan(0)&&(t=(r=e.add(1).div(wl).subtract(1)).multiply(400),e=e.add(r.multiply(-wl))),e.multiply(400).add(591).div(wl)),n=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400))),e=(n.lessThan(0)&&(r=r.subtract(1),n=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400)))),r=r.add(t),n),t=e.multiply(5).add(2).div(153),n=t.add(2).modulo(12).add(1),e=e.subtract(t.multiply(306).add(5).div(10)).add(1),r=r.add(t.div(10));return new vl.Date(r,n,e)}function Nl(e){var t=(e=(0,vl.int)(e)).div(El),r=(e=e.subtract(t.multiply(El))).div(Tl),n=(e=e.subtract(r.multiply(Tl))).div(Cl),e=e.subtract(n.multiply(Cl));return new vl.LocalTime(t,r,n,e)}E.epochDayToDate=Il,E.nanoOfDayToLocalTime=Nl,E.epochSecondAndNanoToLocalDateTime=function(e,t){var r=Sl(e,Pl),e=Rl(e,Pl).multiply(Cl).add(t),t=Il(r),r=Nl(e);return new vl.LocalDateTime(t.year,t.month,t.day,r.hour,r.minute,r.second,r.nanosecond)};var kl=e&&e.__assign||function(){return(kl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},jl=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},c=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Al=(Object.defineProperty(h,"__esModule",{value:!0}),t),Dl=R,Ml=g,Ul=E,b=c(zr),n=Al.internal.temporalUtil,Ll=n.dateToEpochDay,xl=n.localDateTimeToEpochSecond,Bl=n.localTimeToNanoOfDay;function Fl(e,t,r){if(!t&&!r)return e;var n,o,i,a=Object.create(Object.getPrototypeOf(e));for(n in e)!0===Object.prototype.hasOwnProperty.call(e,n)&&(o=e[n],a[n]=(0,Al.isInt)(o)?(i=o,r?i.toBigInt():i.toNumberOrInfinity()):o);return Object.freeze(a),a}h.default=kl(kl({},b.default),{createPoint2DTransformer:function(){return new Ml.TypeTransformer({signature:88,isTypeInstance:function(e){return(0,Al.isPoint)(e)&&(null===e.z||void 0===e.z)},toStructure:function(e){return new Dl.structure.Structure(88,[(0,Al.int)(e.srid),e.x,e.y])},fromStructure:function(e){Dl.structure.verifyStructSize("Point2D",3,e.size);var e=jl(e.fields,3),t=e[0],r=e[1],e=e[2];return new Al.Point(t,r,e,void 0)}})},createPoint3DTransformer:function(){return new Ml.TypeTransformer({signature:89,isTypeInstance:function(e){return(0,Al.isPoint)(e)&&null!==e.z&&void 0!==e.z},toStructure:function(e){return new Dl.structure.Structure(89,[(0,Al.int)(e.srid),e.x,e.y,e.z])},fromStructure:function(e){Dl.structure.verifyStructSize("Point3D",4,e.size);var e=jl(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Al.Point(t,r,n,e)}})},createDurationTransformer:function(){return new Ml.TypeTransformer({signature:69,isTypeInstance:Al.isDuration,toStructure:function(e){var t=(0,Al.int)(e.months),r=(0,Al.int)(e.days),n=(0,Al.int)(e.seconds),e=(0,Al.int)(e.nanoseconds);return new Dl.structure.Structure(69,[t,r,n,e])},fromStructure:function(e){Dl.structure.verifyStructSize("Duration",4,e.size);var e=jl(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Al.Duration(t,r,n,e)}})},createLocalTimeTransformer:function(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new Ml.TypeTransformer({signature:116,isTypeInstance:Al.isLocalTime,toStructure:function(e){e=Bl(e.hour,e.minute,e.second,e.nanosecond);return new Dl.structure.Structure(116,[e])},fromStructure:function(e){Dl.structure.verifyStructSize("LocalTime",1,e.size);e=jl(e.fields,1)[0];return Fl((0,Ul.nanoOfDayToLocalTime)(e),t,r)}})},createTimeTransformer:function(e){var r=e.disableLosslessIntegers,n=e.useBigInt;return new Ml.TypeTransformer({signature:84,isTypeInstance:Al.isTime,toStructure:function(e){var t=Bl(e.hour,e.minute,e.second,e.nanosecond),e=(0,Al.int)(e.timeZoneOffsetSeconds);return new Dl.structure.Structure(84,[t,e])},fromStructure:function(e){Dl.structure.verifyStructSize("Time",2,e.size);var e=jl(e.fields,2),t=e[0],e=e[1],t=(0,Ul.nanoOfDayToLocalTime)(t);return Fl(new Al.Time(t.hour,t.minute,t.second,t.nanosecond,e),r,n)}})},createDateTransformer:function(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new Ml.TypeTransformer({signature:68,isTypeInstance:Al.isDate,toStructure:function(e){e=Ll(e.year,e.month,e.day);return new Dl.structure.Structure(68,[e])},fromStructure:function(e){Dl.structure.verifyStructSize("Date",1,e.size);e=jl(e.fields,1)[0];return Fl((0,Ul.epochDayToDate)(e),t,r)}})},createLocalDateTimeTransformer:function(e){var r=e.disableLosslessIntegers,n=e.useBigInt;return new Ml.TypeTransformer({signature:100,isTypeInstance:Al.isLocalDateTime,toStructure:function(e){var t=xl(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),e=(0,Al.int)(e.nanosecond);return new Dl.structure.Structure(100,[t,e])},fromStructure:function(e){Dl.structure.verifyStructSize("LocalDateTime",2,e.size);var e=jl(e.fields,2),t=e[0],e=e[1];return Fl((0,Ul.epochSecondAndNanoToLocalDateTime)(t,e),r,n)}})},createDateTimeWithZoneIdTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return new Ml.TypeTransformer({signature:102,isTypeInstance:function(e){return(0,Al.isDateTime)(e)&&null!=e.timeZoneId},toStructure:function(e){var t=xl(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,Al.int)(e.nanosecond),e=e.timeZoneId;return new Dl.structure.Structure(102,[t,r,e])},fromStructure:function(e){Dl.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var e=jl(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,Ul.epochSecondAndNanoToLocalDateTime)(t,r);return Fl(new Al.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,null,e),n,o)}})},createDateTimeWithOffsetTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return new Ml.TypeTransformer({signature:70,isTypeInstance:function(e){return(0,Al.isDateTime)(e)&&null==e.timeZoneId},toStructure:function(e){var t=xl(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,Al.int)(e.nanosecond),e=(0,Al.int)(e.timeZoneOffsetSeconds);return new Dl.structure.Structure(70,[t,r,e])},fromStructure:function(e){Dl.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var e=jl(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,Ul.epochSecondAndNanoToLocalDateTime)(t,r);return Fl(new Al.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),n,o)}})}});var ql,Hl,y=e&&e.__extends||(ql=function(e,t){return(ql=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ql(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},P=(Object.defineProperty(C,"__esModule",{value:!0}),_(hn)),Vl=_(R),F=t,zl=_(h),Wl=_(g),Gl=F.internal.constants.BOLT_PROTOCOL_V2,a=(Hl=P.default,y(Kl,Hl),Kl.prototype._createPacker=function(e){return new Vl.default.Packer(e)},Kl.prototype._createUnpacker=function(e,t){return new Vl.default.Unpacker(e,t)},Object.defineProperty(Kl.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Wl.default(Object.values(zl.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(Kl.prototype,"version",{get:function(){return Gl},enumerable:!1,configurable:!0}),Kl);function Kl(){return null!==Hl&&Hl.apply(this,arguments)||this}C.default=a;var Yl,Zl,v={},u={},Ql=e&&e.__assign||function(){return(Ql=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},m=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(u,"__esModule",{value:!0}),m(h)),zr=(u.default=Ql({},c.default),e&&e.__extends||(Yl=function(e,t){return(Yl=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Yl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),Xl=e&&e.__assign||function(){return(Xl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},b=(Object.defineProperty(v,"__esModule",{value:!0}),n(C)),Jl=n(r),$l=I,ef=o,tf=n(u),rf=n(g),nf=(t.internal.bookmarks.Bookmarks,t.internal.constants.BOLT_PROTOCOL_V3),of=t.internal.txConfig.TxConfig,af="context",sf="CALL dbms.cluster.routing.getRoutingTable($".concat(af,")"),uf=new ef.StreamObserver,_=(Zl=b.default,zr(cf,Zl),Object.defineProperty(cf.prototype,"version",{get:function(){return nf},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new rf.default(Object.values(tf.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),cf.prototype.transformMetadata=function(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e},cf.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,e=new ef.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,n,a)}});return(0,$l.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(Jl.default.hello(r,n),e,!0),e},cf.prototype.prepareToClose=function(){this.write(Jl.default.goodbye(),uf,!0)},cf.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.impersonatedUser,i=e.notificationFilter,a=e.mode,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new ef.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,$l.assertDatabaseIsEmpty)(n,this._onProtocolError,s),(0,$l.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,s),(0,$l.assertNotificationFilterIsEmpty)(i,this._onProtocolError,s),this.write(Jl.default.begin({bookmarks:t,txConfig:r,mode:a}),s,!0),s},cf.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete,t=new ef.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(Jl.default.commit(),t,!0),t},cf.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete,t=new ef.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(Jl.default.rollback(),t,!0),t},cf.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,a=r.impersonatedUser,s=r.notificationFilter,u=r.mode,c=r.beforeKeys,l=r.afterKeys,f=r.beforeError,h=r.afterError,p=r.beforeComplete,d=r.afterComplete,_=r.flush,_=void 0===_||_,y=r.highRecordWatermark,y=void 0===y?Number.MAX_VALUE:y,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new ef.ResultStreamObserver({server:this._server,beforeKeys:c,afterKeys:l,beforeError:f,afterError:h,beforeComplete:p,afterComplete:d,highRecordWatermark:y,lowRecordWatermark:r});return(0,$l.assertDatabaseIsEmpty)(i,this._onProtocolError,c),(0,$l.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,c),(0,$l.assertNotificationFilterIsEmpty)(s,this._onProtocolError,c),this.write(Jl.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,mode:u}),c,!1),this.write(Jl.default.pullAll(),c,_),c},cf.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,n=e.sessionContext,n=void 0===n?{}:n,o=e.onError,e=e.onCompleted,r=this.run(sf,((t={})[af]=void 0===r?{}:r,t),Xl(Xl({},n),{txConfig:of.empty()}));return new ef.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:o,onCompleted:e})},cf);function cf(){return null!==Zl&&Zl.apply(this,arguments)||this}v.default=_;var lf,ff,F={},P={},hf=e&&e.__assign||function(){return(hf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=(Object.defineProperty(P,"__esModule",{value:!0}),y(u)),m=(P.default=hf({},a.default),e&&e.__extends||(lf=function(e,t){return(lf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}lf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),pf=e&&e.__assign||function(){return(pf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},h=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(F,"__esModule",{value:!0}),h(v)),df=h(r),_f=I,yf=o,bf=h(P),mf=h(g),n=(t.internal.bookmarks.Bookmarks,t.internal.constants),gf=n.BOLT_PROTOCOL_V4_0,vf=n.FETCH_ALL,Of=t.internal.txConfig.TxConfig,wf="context",Ef="database",Tf="CALL dbms.routing.getRoutingTable($".concat(wf,", $").concat(Ef,")"),b=(ff=c.default,m(Cf,ff),Object.defineProperty(Cf.prototype,"version",{get:function(){return gf},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new mf.default(Object.values(bf.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Cf.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.impersonatedUser,i=e.notificationFilter,a=e.mode,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new yf.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,_f.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,s),(0,_f.assertNotificationFilterIsEmpty)(i,this._onProtocolError,s),this.write(df.default.begin({bookmarks:t,txConfig:r,database:n,mode:a}),s,!0),s},Cf.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,a=r.impersonatedUser,s=r.notificationFilter,u=r.mode,c=r.beforeKeys,l=r.afterKeys,f=r.beforeError,h=r.afterError,p=r.beforeComplete,d=r.afterComplete,_=r.flush,_=void 0===_||_,y=r.reactive,y=void 0!==y&&y,b=r.fetchSize,b=void 0===b?vf:b,m=r.highRecordWatermark,m=void 0===m?Number.MAX_VALUE:m,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new yf.ResultStreamObserver({server:this._server,reactive:y,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:f,afterError:h,beforeComplete:p,afterComplete:d,highRecordWatermark:m,lowRecordWatermark:r}),l=((0,_f.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,c),(0,_f.assertNotificationFilterIsEmpty)(s,this._onProtocolError,c),y);return this.write(df.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,database:i,mode:u}),c,l&&_),y||this.write(df.default.pull({n:b}),c,_),c},Cf.prototype._requestMore=function(e,t,r){this.write(df.default.pull({stmtId:e,n:t}),r,!0)},Cf.prototype._requestDiscard=function(e,t){this.write(df.default.discard({stmtId:e}),t,!0)},Cf.prototype._noOp=function(){},Cf.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,n=e.databaseName,n=void 0===n?null:n,o=e.sessionContext,o=void 0===o?{}:o,i=e.onError,e=e.onCompleted,r=this.run(Tf,((t={})[wf]=void 0===r?{}:r,t[Ef]=n,t),pf(pf({},o),{txConfig:Of.empty()}));return new yf.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:i,onCompleted:e})},Cf);function Cf(){return null!==ff&&ff.apply(this,arguments)||this}F.default=b;var Pf,Sf,zr={},_={},Rf=e&&e.__assign||function(){return(Rf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=(Object.defineProperty(_,"__esModule",{value:!0}),y(P)),a=(_.default=Rf({},u.default),e&&e.__extends||(Pf=function(e,t){return(Pf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Pf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),h=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(zr,"__esModule",{value:!0}),h(F)),If=h(r),Nf=o,c=t,kf=I,jf=h(_),Af=h(g),Df=c.internal.constants.BOLT_PROTOCOL_V4_1,m=(Sf=n.default,a(Mf,Sf),Object.defineProperty(Mf.prototype,"version",{get:function(){return Df},enumerable:!1,configurable:!0}),Object.defineProperty(Mf.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Af.default(Object.values(jf.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Mf.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,e=new Nf.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,n,a)}});return(0,kf.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(If.default.hello(r,n,this._serversideRouting),e,!0),e},Mf);function Mf(e,t,r,n,o,i,a){e=Sf.call(this,e,t,r,n=void 0===n?function(){return null}:n,o,i)||this;return e._serversideRouting=a,e}zr.default=m;var Uf,Lf,b={},y={},xf=e&&e.__assign||function(){return(xf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},P=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=(Object.defineProperty(y,"__esModule",{value:!0}),P(_)),h=(y.default=xf({},u.default),e&&e.__extends||(Uf=function(e,t){return(Uf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Uf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),c=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(b,"__esModule",{value:!0}),c(zr)),a=t,Bf=c(y),Ff=c(g),qf=a.internal.constants.BOLT_PROTOCOL_V4_2,m=(Lf=n.default,h(Hf,Lf),Object.defineProperty(Hf.prototype,"version",{get:function(){return qf},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Ff.default(Object.values(Bf.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Hf);function Hf(){return null!==Lf&&Lf.apply(this,arguments)||this}b.default=m;var P={},_={},Vf=e&&e.__assign||function(){return(Vf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(_,"__esModule",{value:!0}),u(y)),a=(_.default=Vf({},c.default),{}),n={},zf=e&&e.__assign||function(){return(zf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},h=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},m=(Object.defineProperty(n,"__esModule",{value:!0}),h(_)),Wf=(n.default=zf({},m.default),e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}),u=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Gf=(Object.defineProperty(a,"__esModule",{value:!0}),R),Kf=t,Yf=u(n),Zf=E,Qf=T,Xf=Kf.internal.temporalUtil.localDateTimeToEpochSecond;var Jf=new Map;function $f(e,t,r){e=e,Jf.has(e)||(n=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,era:"narrow"}),Jf.set(e,n));var n=Jf.get(e),e=(0,Kf.int)(t).multiply(1e3).add((0,Kf.int)(r).div(1e6)).toNumber(),r=n.formatToParts(e).reduce(function(e,t){return"era"===t.type?e.adjustEra="B"===t.value.toUpperCase()?function(e){return e.subtract(1).negate()}:Qf.identity:"hour"===t.type?e.hour=(0,Kf.int)(t.value).modulo(24):"literal"!==t.type&&(e[t.type]=(0,Kf.int)(t.value)),e},{}),e=(r.year=r.adjustEra(r.year),Xf(r.year,r.month,r.day,r.hour,r.minute,r.second,r.nanosecond));return r.timeZoneOffsetSeconds=e.subtract(t),r.hour=r.hour.modulo(24),r}function eh(e,t,r){if(!t&&!r)return e;var n,o,i,a=Object.create(Object.getPrototypeOf(e));for(n in e)!0===Object.prototype.hasOwnProperty.call(e,n)&&(o=e[n],a[n]=(0,Kf.isInt)(o)?(i=o,r?i.toBigInt():i.toNumberOrInfinity()):o);return Object.freeze(a),a}a.default={createDateTimeWithZoneIdTransformer:function(e,a){var n=e.disableLosslessIntegers,o=e.useBigInt;return Yf.default.createDateTimeWithZoneIdTransformer(e).extendsWith({signature:105,fromStructure:function(e){Gf.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var e=Wf(e.fields,3),t=e[0],r=e[1],e=e[2],t=$f(e,t,r);return eh(new Kf.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,(0,Kf.int)(r),t.timeZoneOffsetSeconds,e),n,o)},toStructure:function(e){var t=Xf(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=null!=e.timeZoneOffsetSeconds?e.timeZoneOffsetSeconds:(r=e.timeZoneId,i=t,o=e.nanosecond,n=$f(r,i,o),n=Xf(n.year,n.month,n.day,n.hour,n.minute,n.second,o).subtract(i),i=i.subtract(n),n=$f(r,i,o),Xf(n.year,n.month,n.day,n.hour,n.minute,n.second,o).subtract(i)),n=(null==e.timeZoneOffsetSeconds&&a.warn('DateTime objects without "timeZoneOffsetSeconds" property are prune to bugs related to ambiguous times. For instance, 2022-10-30T2:30:00[Europe/Berlin] could be GMT+1 or GMT+2.'),t.subtract(r)),o=(0,Kf.int)(e.nanosecond),i=e.timeZoneId;return new Gf.structure.Structure(105,[n,o,i])}})},createDateTimeWithOffsetTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return Yf.default.createDateTimeWithOffsetTransformer(e).extendsWith({signature:73,toStructure:function(e){var t=Xf(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,Kf.int)(e.nanosecond),e=(0,Kf.int)(e.timeZoneOffsetSeconds),t=t.subtract(e);return new Gf.structure.Structure(73,[t,r,e])},fromStructure:function(e){Gf.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var e=Wf(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,Kf.int)(t).add(e),t=(0,Zf.epochSecondAndNanoToLocalDateTime)(t,r);return eh(new Kf.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),n,o)}})}};var th,rh,y=e&&e.__extends||(th=function(e,t){return(th=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}th(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),nh=e&&e.__assign||function(){return(nh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},h=(Object.defineProperty(P,"__esModule",{value:!0}),c(b)),oh=c(r),ih=o,ah=I,sh=c(_),uh=c(a),ch=c(g),lh=t.internal.bookmarks.Bookmarks,fh=t.internal.constants.BOLT_PROTOCOL_V4_3,m=(rh=h.default,y(hh,rh),Object.defineProperty(hh.prototype,"version",{get:function(){return fh},enumerable:!1,configurable:!0}),Object.defineProperty(hh.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new ch.default(Object.values(sh.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),hh.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,n=e.sessionContext,n=void 0===n?{}:n,o=e.onError,e=e.onCompleted,o=new ih.RouteObserver({onProtocolError:this._onProtocolError,onError:o,onCompleted:e}),e=n.bookmarks||lh.empty();return this.write(oh.default.route(t,e.values(),r),o,!0),o},hh.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,e=new ih.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return void 0!==e.patch_bolt&&t._applyPatches(e.patch_bolt),t._onLoginCompleted(e,n,a)}});return(0,ah.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(oh.default.hello(r,n,this._serversideRouting,["utc"]),e,!0),e},hh.prototype._applyPatches=function(e){e.includes("utc")&&this._applyUtcPatch()},hh.prototype._applyUtcPatch=function(){var t=this;this._transformer=new ch.default(Object.values(nh(nh({},sh.default),uh.default)).map(function(e){return e(t._config,t._log)}))},hh);function hh(){return null!==rh&&rh.apply(this,arguments)||this}P.default=m;var ph,dh,u={},E=e&&e.__extends||(ph=function(e,t){return(ph=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ph(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),_h=e&&e.__assign||function(){return(_h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(u,"__esModule",{value:!0}),T(P)),c=t,yh=T(r),bh=o,mh=I,gh=T(n),vh=T(a),Oh=T(g),h=c.internal.constants,wh=h.BOLT_PROTOCOL_V4_4,Eh=h.FETCH_ALL,Th=c.internal.bookmarks.Bookmarks,y=(dh=_.default,E(Ch,dh),Object.defineProperty(Ch.prototype,"version",{get:function(){return wh},enumerable:!1,configurable:!0}),Object.defineProperty(Ch.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Oh.default(Object.values(gh.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Ch.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,n=e.impersonatedUser,n=void 0===n?null:n,o=e.sessionContext,o=void 0===o?{}:o,i=e.onError,e=e.onCompleted,i=new bh.RouteObserver({onProtocolError:this._onProtocolError,onError:i,onCompleted:e}),e=o.bookmarks||Th.empty();return this.write(yh.default.routeV4x4(t,e.values(),{databaseName:r,impersonatedUser:n}),i,!0),i},Ch.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,f=r.beforeError,h=r.afterError,p=r.beforeComplete,d=r.afterComplete,_=r.flush,_=void 0===_||_,y=r.reactive,y=void 0!==y&&y,b=r.fetchSize,b=void 0===b?Eh:b,m=r.highRecordWatermark,m=void 0===m?Number.MAX_VALUE:m,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new bh.ResultStreamObserver({server:this._server,reactive:y,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:f,afterError:h,beforeComplete:p,afterComplete:d,highRecordWatermark:m,lowRecordWatermark:r}),l=((0,mh.assertNotificationFilterIsEmpty)(u,this._onProtocolError,c),y);return this.write(yh.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,database:i,mode:a,impersonatedUser:s}),c,l&&_),y||this.write(yh.default.pull({n:b}),c,_),c},Ch.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new bh.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,mh.assertNotificationFilterIsEmpty)(a,this._onProtocolError,s),this.write(yh.default.begin({bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i}),s,!0),s},Ch.prototype._applyUtcPatch=function(){var t=this;this._transformer=new Oh.default(Object.values(_h(_h({},gh.default),vh.default)).map(function(e){return e(t._config,t._log)}))},Ch);function Ch(){return null!==dh&&dh.apply(this,arguments)||this}u.default=y;var m={},T={},Ph=e&&e.__assign||function(){return(Ph=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Sh=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},h=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Rh=(Object.defineProperty(T,"__esModule",{value:!0}),R),Ih=t,Nh=h(n),c=h(a);T.default=Ph(Ph(Ph({},Nh.default),c.default),{createNodeTransformer:function(e){return Nh.default.createNodeTransformer(e).extendsWith({fromStructure:function(e){Rh.structure.verifyStructSize("Node",4,e.size);var e=Sh(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Ih.Node(t,r,n,e)}})},createRelationshipTransformer:function(e){return Nh.default.createRelationshipTransformer(e).extendsWith({fromStructure:function(e){Rh.structure.verifyStructSize("Relationship",8,e.size);var e=Sh(e.fields,8),t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],a=e[5],s=e[6],e=e[7];return new Ih.Relationship(t,r,n,o,i,a,s,e)}})},createUnboundRelationshipTransformer:function(e){return Nh.default.createUnboundRelationshipTransformer(e).extendsWith({fromStructure:function(e){Rh.structure.verifyStructSize("UnboundRelationship",4,e.size);var e=Sh(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Ih.UnboundRelationship(t,r,n,e)}})}});var kh,jh,_=e&&e.__extends||(kh=function(e,t){return(kh=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}kh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},y=(Object.defineProperty(m,"__esModule",{value:!0}),E(u)),Ah=I,Dh=E(T),Mh=E(g),Uh=E(r),Lh=o,xh=t.internal.constants.BOLT_PROTOCOL_V5_0,n=(jh=y.default,_(Bh,jh),Object.defineProperty(Bh.prototype,"version",{get:function(){return xh},enumerable:!1,configurable:!0}),Object.defineProperty(Bh.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Mh.default(Object.values(Dh.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Bh.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,e=new Lh.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,n,a)}});return(0,Ah.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(Uh.default.hello(r,n,this._serversideRouting),e,!0),e},Bh);function Bh(){return null!==jh&&jh.apply(this,arguments)||this}m.default=n;var Fh,qh,h={},a={},Hh=e&&e.__assign||function(){return(Hh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},E=(Object.defineProperty(a,"__esModule",{value:!0}),c(T)),y=(a.default=Hh({},E.default),e&&e.__extends||(Fh=function(e,t){return(Fh=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Fh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),Vh=e&&e.__assign||function(){return(Vh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(h,"__esModule",{value:!0}),_(m)),zh=I,Wh=_(a),Gh=_(g),Kh=_(r),Yh=o,Zh=t.internal.constants.BOLT_PROTOCOL_V5_1,c=(qh=n.default,y(Qh,qh),Object.defineProperty(Qh.prototype,"version",{get:function(){return Zh},enumerable:!1,configurable:!0}),Object.defineProperty(Qh.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Gh.default(Object.values(Wh.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(Qh.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),Qh.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,s={},e=new Yh.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return s.metadata=e,t._onLoginCompleted(e)}});return(0,zh.assertNotificationFilterIsEmpty)(o,this._onProtocolError,e),this.write(Kh.default.hello5x1(r,this._serversideRouting),e,!1),this.logon({authToken:n,onComplete:function(e){return a(Vh(Vh({},e),s.metadata))},onError:i,flush:!0})},Qh.prototype.logon=function(e){var t=this,e=void 0===e?{}:e,r=e.authToken,n=e.onComplete,o=e.onError,e=e.flush,i=new Yh.LoginObserver({onCompleted:function(){return t._onLoginCompleted(null,r,n)},onError:function(e){return t._onLoginError(e,o)}});return this.write(Kh.default.logon(r),i,e),i},Qh.prototype.logoff=function(e){var e=void 0===e?{}:e,t=e.onComplete,r=e.onError,e=e.flush,t=new Yh.LogoffObserver({onCompleted:t,onError:r});return this.write(Kh.default.logoff(),t,e),t},Qh);function Qh(){return null!==qh&&qh.apply(this,arguments)||this}h.default=c;var Xh,Jh,T={},E={},$h=e&&e.__assign||function(){return($h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(E,"__esModule",{value:!0}),I(a)),n=(E.default=$h({},_.default),e&&e.__extends||(Xh=function(e,t){return(Xh=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Xh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),ep=e&&e.__assign||function(){return(ep=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(T,"__esModule",{value:!0}),y(h)),tp=y(E),rp=y(g),np=y(r),op=o,I=t.internal.constants,ip=I.BOLT_PROTOCOL_V5_2,ap=I.FETCH_ALL,a=(Jh=c.default,n(sp,Jh),Object.defineProperty(sp.prototype,"version",{get:function(){return ip},enumerable:!1,configurable:!0}),Object.defineProperty(sp.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new rp.default(Object.values(tp.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(sp.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),sp.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=(e.boltAgent,e.authToken),o=e.notificationFilter,i=e.onError,a=e.onComplete,s={},e=new op.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return s.metadata=e,t._onLoginCompleted(e)}});return this.write(np.default.hello5x2(r,o,this._serversideRouting),e,!1),this.logon({authToken:n,onComplete:function(e){return a(ep(ep({},e),s.metadata))},onError:i,flush:!0})},sp.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new op.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),this.write(np.default.begin({bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i,notificationFilter:a}),s,!0),s},sp.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,f=r.beforeError,h=r.afterError,p=r.beforeComplete,d=r.afterComplete,_=r.flush,_=void 0===_||_,y=r.reactive,y=void 0!==y&&y,b=r.fetchSize,b=void 0===b?ap:b,m=r.highRecordWatermark,m=void 0===m?Number.MAX_VALUE:m,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new op.ResultStreamObserver({server:this._server,reactive:y,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:f,afterError:h,beforeComplete:p,afterComplete:d,highRecordWatermark:m,lowRecordWatermark:r}),l=y;return this.write(np.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,database:i,mode:a,impersonatedUser:s,notificationFilter:u}),c,l&&_),y||this.write(np.default.pull({n:b}),c,_),c},sp);function sp(){return null!==Jh&&Jh.apply(this,arguments)||this}T.default=a;var up,cp,_={},y={},lp=e&&e.__assign||function(){return(lp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},c=(Object.defineProperty(y,"__esModule",{value:!0}),I(E)),n=(y.default=lp({},c.default),e&&e.__extends||(up=function(e,t){return(up=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}up(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),fp=e&&e.__assign||function(){return(fp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},I=(Object.defineProperty(_,"__esModule",{value:!0}),a(T)),hp=a(y),pp=a(g),dp=a(r),_p=o,yp=t.internal.constants.BOLT_PROTOCOL_V5_3,E=(cp=I.default,n(bp,cp),Object.defineProperty(bp.prototype,"version",{get:function(){return yp},enumerable:!1,configurable:!0}),Object.defineProperty(bp.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new pp.default(Object.values(hp.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),bp.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.boltAgent,o=e.authToken,i=e.notificationFilter,a=e.onError,s=e.onComplete,u={},e=new _p.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return u.metadata=e,t._onLoginCompleted(e)}});return this.write(dp.default.hello5x3(r,n,i,this._serversideRouting),e,!1),this.logon({authToken:o,onComplete:function(e){return s(fp(fp({},e),u.metadata))},onError:a,flush:!0})},bp);function bp(){return null!==cp&&cp.apply(this,arguments)||this}_.default=E;var mp,gp,c={},a={},vp=e&&e.__assign||function(){return(vp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(a,"__esModule",{value:!0}),I(y)),E=(a.default=vp({},n.default),e&&e.__extends||(mp=function(e,t){return(mp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}mp(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},y=(Object.defineProperty(c,"__esModule",{value:!0}),I(_)),Op=I(a),wp=I(r),Ep=o,Tp=I(g),Cp=t.internal.constants.BOLT_PROTOCOL_V5_4,n=(gp=y.default,E(Pp,gp),Object.defineProperty(Pp.prototype,"version",{get:function(){return Cp},enumerable:!1,configurable:!0}),Object.defineProperty(Pp.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Tp.default(Object.values(Op.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Pp.prototype.telemetry=function(e,t){var e=e.api,t=void 0===t?{}:t,r=t.onError,t=t.onCompleted,t=new Ep.TelemetryObserver({onCompleted:t,onError:r});return this.write(wp.default.telemetry({api:e}),t,!1),t},Pp);function Pp(){return null!==gp&&gp.apply(this,arguments)||this}c.default=n;var Sp,Rp,I={},y={},Ip=e&&e.__assign||function(){return(Ip=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(y,"__esModule",{value:!0}),E(a)),E=(y.default=Ip({},n.default),e&&e.__extends||(Sp=function(e,t){return(Sp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Sp(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),Np=e&&e.__assign||function(){return(Np=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(I,"__esModule",{value:!0}),a(c)),kp=a(y),jp=a(g),Ap=a(r),Dp=o,a=t.internal.constants,Mp=a.BOLT_PROTOCOL_V5_5,Up=a.FETCH_ALL,Lp=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),r=(Rp=n.default,E(xp,Rp),Object.defineProperty(xp.prototype,"version",{get:function(){return Mp},enumerable:!1,configurable:!0}),Object.defineProperty(xp.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new jp.default(Object.values(kp.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),xp.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.boltAgent,o=e.authToken,i=e.notificationFilter,a=e.onError,s=e.onComplete,u={},e=new Dp.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return u.metadata=e,t._onLoginCompleted(e)}});return this.write(Ap.default.hello5x5(r,n,i,this._serversideRouting),e,!1),this.logon({authToken:o,onComplete:function(e){return s(Np(Np({},e),u.metadata))},onError:a,flush:!0})},xp.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new Dp.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),this.write(Ap.default.begin5x5({bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i,notificationFilter:a}),s,!0),s},xp.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,f=r.beforeError,h=r.afterError,p=r.beforeComplete,d=r.afterComplete,_=r.flush,_=void 0===_||_,y=r.reactive,y=void 0!==y&&y,b=r.fetchSize,b=void 0===b?Up:b,m=r.highRecordWatermark,m=void 0===m?Number.MAX_VALUE:m,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new Dp.ResultStreamObserver({server:this._server,reactive:y,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:f,afterError:h,beforeComplete:p,afterComplete:d,highRecordWatermark:m,lowRecordWatermark:r,enrichMetadata:this._enrichMetadata}),l=y;return this.write(Ap.default.runWithMetadata5x5(e,t,{bookmarks:n,txConfig:o,database:i,mode:a,impersonatedUser:s,notificationFilter:u}),c,l&&_),y||this.write(Ap.default.pull({n:b}),c,_),c},xp.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map(function(e){return Np(Np({},e),{description:null!=e.neo4j_code?e.status_description:e.description,diagnostic_record:null!==e.diagnostic_record?Np(Np({},Lp),e.diagnostic_record):null})})),e},xp);function xp(){return null!==Rp&&Rp.apply(this,arguments)||this}I.default=r;var Bp,Fp,a={},n=e&&e.__extends||(Bp=function(e,t){return(Bp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Bp(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),qp=e&&e.__assign||function(){return(qp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=(Object.defineProperty(a,"__esModule",{value:!0}),E(I)),Hp=E(y),Vp=E(g),zp=t.internal.constants.BOLT_PROTOCOL_V5_6,Wp=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),E=(Fp=r.default,n(Gp,Fp),Object.defineProperty(Gp.prototype,"version",{get:function(){return zp},enumerable:!1,configurable:!0}),Object.defineProperty(Gp.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Vp.default(Object.values(Hp.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Gp.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map(function(e){return qp(qp({},e),{diagnostic_record:null!==e.diagnostic_record?qp(qp({},Wp),e.diagnostic_record):null})})),e},Gp);function Gp(){return null!==Fp&&Fp.apply(this,arguments)||this}a.default=E;var Kp,Yp,r={},n=e&&e.__extends||(Kp=function(e,t){return(Kp=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Kp(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Zp=e&&e.__assign||function(){return(Zp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Qp=(Object.defineProperty(r,"__esModule",{value:!0}),E(a)),Xp=E(y),Jp=E(g),$p=t.internal.constants.BOLT_PROTOCOL_V5_7,ed=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),y=(Yp=Qp.default,n(td,Yp),Object.defineProperty(td.prototype,"version",{get:function(){return $p},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Jp.default(Object.values(Xp.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),td.prototype.enrichErrorMetadata=function(e){return Zp(Zp({},e),{cause:null!==e.cause&&void 0!==e.cause?this.enrichErrorMetadata(e.cause):null,code:e.neo4j_code,diagnostic_record:null!==e.diagnostic_record?Zp(Zp({},ed),e.diagnostic_record):null})},td);function td(){return null!==Yp&&Yp.apply(this,arguments)||this}r.default=y;var E={},rd=(Object.defineProperty(E,"__esModule",{value:!0}),t);function nd(){}function od(e){return e}var id={onNext:nd,onCompleted:nd,onError:nd};function ad(e){var e=void 0===e?{}:e,t=e.transformMetadata,r=e.enrichErrorMetadata,n=e.log,e=e.observer;this._pendingObservers=[],this._log=n,this._transformMetadata=t||od,this._enrichErrorMetadata=r||od,this._observer=Object.assign({onObserversCountChange:nd,onError:nd,onFailure:nd,onErrorApplyTransformation:od},e)}Object.defineProperty(ad.prototype,"currentFailure",{get:function(){return this._currentFailure},enumerable:!1,configurable:!0}),ad.prototype.handleResponse=function(e){var t=e.fields[0];switch(e.signature){case 113:this._log.isDebugEnabled()&&this._log.debug("S: RECORD ".concat(rd.json.stringify(e))),this._currentObserver.onNext(t);break;case 112:this._log.isDebugEnabled()&&this._log.debug("S: SUCCESS ".concat(rd.json.stringify(e)));try{var r=this._transformMetadata(t);this._currentObserver.onCompleted(r)}finally{this._updateCurrentObserver()}break;case 127:this._log.isDebugEnabled()&&this._log.debug("S: FAILURE ".concat(rd.json.stringify(e)));try{this._currentFailure=this._handleErrorPayload(this._enrichErrorMetadata(t)),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._observer.onFailure(this._currentFailure)}break;case 126:this._log.isDebugEnabled()&&this._log.debug("S: IGNORED ".concat(rd.json.stringify(e)));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError((0,rd.newError)("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._observer.onError((0,rd.newError)("Unknown Bolt protocol message: "+e))}},ad.prototype._updateCurrentObserver=function(){this._currentObserver=this._pendingObservers.shift(),this._observer.onObserversCountChange(this._observersCount)},Object.defineProperty(ad.prototype,"_observersCount",{get:function(){return null==this._currentObserver?this._pendingObservers.length:this._pendingObservers.length+1},enumerable:!1,configurable:!0}),ad.prototype._queueObserver=function(e){return(e=e||id).onCompleted=e.onCompleted||nd,e.onError=e.onError||nd,e.onNext=e.onNext||nd,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),this._observer.onObserversCountChange(this._observersCount),!0},ad.prototype._notifyErrorToObservers=function(e){for(this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(e);0<this._pendingObservers.length;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(e)}},ad.prototype.hasOngoingObservableRequests=function(){return null!=this._currentObserver||0<this._pendingObservers.length},ad.prototype._resetFailure=function(){this._currentFailure=null},ad.prototype._handleErrorPayload=function(e){var t=function(e){{if("Neo.TransientError.Transaction.Terminated"===e)return"Neo.ClientError.Transaction.Terminated";if("Neo.TransientError.Transaction.LockClientStopped"===e)return"Neo.ClientError.Transaction.LockClientStopped"}return e}(e.code),r=null!=e.cause?this._handleErrorCause(e.cause):void 0,t=(0,rd.newError)(e.message,t,r,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(t)},ad.prototype._handleErrorCause=function(e){var t=null!=e.cause?this._handleErrorCause(e.cause):void 0,t=(0,rd.newGQLError)(e.message,t,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(t)},E.default=ad;var sd,g=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ud=(Object.defineProperty(f,"__esModule",{value:!0}),t),cd=g(hn),ld=g(C),fd=g(v),hd=g(F),pd=g(zr),dd=g(b),_d=g(P),yd=g(u),bd=g(m),md=g(h),gd=g(T),vd=g(_),Od=g(c),wd=g(I),Ed=g(a),Td=g(r),Cd=g(E);f.default=function(e){var t=(e=void 0===e?{}:e).version,r=e.chunker,n=e.dechunker,o=e.channel,i=e.disableLosslessIntegers,a=e.useBigInt,s=e.serversideRouting,u=e.server,c=e.log,l=e.observer,f=t,h=u,p=r,d={disableLosslessIntegers:i,useBigInt:a},_=s,y=function(t){var r=new Cd.default({transformMetadata:t.transformMetadata.bind(t),enrichErrorMetadata:t.enrichErrorMetadata.bind(t),log:c,observer:l});return o.onerror=l.onError.bind(l),o.onmessage=function(e){return n.write(e)},n.onmessage=function(e){try{r.handleResponse(t.unpack(e))}catch(e){return l.onError(e)}},r},b=l.onProtocolError.bind(l),m=c;switch(f){case 1:return new cd.default(h,p,d,y,m,b);case 2:return new ld.default(h,p,d,y,m,b);case 3:return new fd.default(h,p,d,y,m,b);case 4:return new hd.default(h,p,d,y,m,b);case 4.1:return new pd.default(h,p,d,y,m,b,_);case 4.2:return new dd.default(h,p,d,y,m,b,_);case 4.3:return new _d.default(h,p,d,y,m,b,_);case 4.4:return new yd.default(h,p,d,y,m,b,_);case 5:return new bd.default(h,p,d,y,m,b,_);case 5.1:return new md.default(h,p,d,y,m,b,_);case 5.2:return new gd.default(h,p,d,y,m,b,_);case 5.3:return new vd.default(h,p,d,y,m,b,_);case 5.4:return new Od.default(h,p,d,y,m,b,_);case 5.5:return new wd.default(h,p,d,y,m,b,_);case 5.6:return new Ed.default(h,p,d,y,m,b,_);case 5.7:return new Td.default(h,p,d,y,m,b,_);default:throw(0,ud.newError)("Unknown Bolt protocol version: "+f)}},Qp=Ar,sd=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),n=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||sd(t,e,r)},y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.RawRoutingTable=Qp.BoltProtocol=void 0,hn=y(d),C=y(f),v=y(P),y=y(S),n(o,Qp),Qp.BoltProtocol=v.default,Qp.RawRoutingTable=y.default,Qp.default={handshake:hn.default,create:C.default};var Pd,F={},zr={},b=e&&e.__extends||(Pd=function(e,t){return(Pd=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Pd(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(zr,"__esModule",{value:!0});b(Rd,Sd=t.ConnectionProvider),Rd.prototype.acquireConnection=function(e){e=void 0===e?{}:e,e.accessMode,e.database,e.bookmarks,e=this._connection;return this._connection=null,Promise.resolve(e)};var Sd,u=Rd;function Rd(e){var t=Sd.call(this)||this;return t._connection=e,t}zr.default=u;var Id,m={},h={},T={},_=e&&e.__extends||(Id=function(e,t){return(Id=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Id(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(T,"__esModule",{value:!0});_(kd,Nd=t.Connection),Object.defineProperty(kd.prototype,"id",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"databaseId",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"authToken",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"supportsReAuth",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"creationTimestamp",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"idleTimestamp",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),kd.prototype.protocol=function(){throw new Error("not implemented")},Object.defineProperty(kd.prototype,"address",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"version",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"server",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),kd.prototype.connect=function(e,t,r,n){throw new Error("not implemented")},kd.prototype.write=function(e,t,r){throw new Error("not implemented")},kd.prototype.close=function(){throw new Error("not implemented")},kd.prototype.handleAndTransformError=function(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t,this):e};var Nd,c=kd;function kd(e){var t=Nd.call(this)||this;return t._errorHandler=e,t}T.default=c;var jd,I={},a=e&&e.__extends||(jd=function(e,t){return(jd=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}jd(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Ad=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Dd=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},r=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Md=(Object.defineProperty(I,"__esModule",{value:!0}),I.createChannelConnection=void 0,O),Ud=t,g=r(T),Ld=r(Ar),xd=Ud.error.PROTOCOL_ERROR,Bd=Ud.internal.logger.Logger,Fd=0;I.createChannelConnection=function(i,a,s,u,e,c,t){void 0===c&&(c=null);var l=(t=void 0===t?function(e){return new Md.Channel(e)}:t)(new Md.ChannelConfig(i,a,s.errorCode(),e));return Ld.default.handshake(l,u).then(function(e){var r=e.protocolVersion,e=e.consumeRemainingBuffer,n=new Md.Chunker(l),o=new Md.Dechunker,t=new Hd(l,s,i,u,a.disableLosslessIntegers,c,n,a.notificationFilter,function(t){return Ld.default.create({version:r,channel:l,chunker:n,dechunker:o,disableLosslessIntegers:a.disableLosslessIntegers,useBigInt:a.useBigInt,serversideRouting:c,server:t.server,log:t.logger,observer:{onObserversCountChange:t._handleOngoingRequestsNumberChange.bind(t),onError:t._handleFatalError.bind(t),onFailure:t._resetOnFailure.bind(t),onProtocolError:t._handleProtocolError.bind(t),onErrorApplyTransformation:function(e){return t.handleAndTransformError(e,t._address)}}})},a.telemetryDisabled);return e(function(e){return o.write(e)}),t}).catch(function(e){return l.close().then(function(){throw e})})};qd=g.default,a(D,qd),D.prototype.beginTransaction=function(e){return this._sendTelemetryIfEnabled(e),this._protocol.beginTransaction(e)},D.prototype.run=function(e,t,r){return this._sendTelemetryIfEnabled(r),this._protocol.run(e,t,r)},D.prototype._sendTelemetryIfEnabled=function(e){this._telemetryDisabledConnection||this._telemetryDisabledDriverConfig||null==e||null==e.apiTelemetryConfig||this._protocol.telemetry({api:e.apiTelemetryConfig.api},{onCompleted:e.apiTelemetryConfig.onTelemetrySuccess,onError:e.beforeError})},D.prototype.commitTransaction=function(e){return this._protocol.commitTransaction(e)},D.prototype.rollbackTransaction=function(e){return this._protocol.rollbackTransaction(e)},D.prototype.getProtocolVersion=function(){return this._protocol.version},Object.defineProperty(D.prototype,"authToken",{get:function(){return this._authToken},set:function(e){this._authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"supportsReAuth",{get:function(){return this._protocol.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"databaseId",{get:function(){return this._dbConnectionId},set:function(e){this._dbConnectionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"idleTimestamp",{get:function(){return this._idleTimestamp},set:function(e){this._idleTimestamp=e},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"creationTimestamp",{get:function(){return this._creationTimestamp},enumerable:!1,configurable:!0}),D.prototype.connect=function(t,n,o,i){return Ad(this,void 0,void 0,function(){var r=this;return Dd(this,function(e){switch(e.label){case 0:if(this._protocol.initialized&&!this._protocol.supportsReAuth)throw(0,Ud.newError)("Connection does not support re-auth");return this._authToken=o,this._protocol.initialized?[3,2]:[4,this._initialize(t,n,o)];case 1:return[2,e.sent()];case 2:return i?[4,new Promise(function(e,t){r._protocol.logoff({onError:t}),r._protocol.logon({authToken:o,onError:t,onComplete:function(){return e(r)},flush:!0})})]:[3,4];case 3:return[2,e.sent()];case 4:return this._protocol.logoff(),this._protocol.logon({authToken:o,flush:!0}),[2,this]}})})},D.prototype._initialize=function(e,n,o){var i=this,a=this;return new Promise(function(r,t){i._protocol.initialize({userAgent:e,boltAgent:n,authToken:o,notificationFilter:i._notificationFilter,onError:function(e){return t(e)},onComplete:function(e){var t;e&&(t=e.server,i.version&&!t||(i.version=t),t=e.connection_id,i.databaseId||(i.databaseId=t),e.hints)&&(null!=(t=e.hints["connection.recv_timeout_seconds"])&&(t=(0,Ud.toNumber)(t),Number.isInteger(t)&&0<t?i._ch.setupReceiveTimeout(1e3*t):i._log.info("Server located at ".concat(i._address," supplied an invalid connection receive timeout value (").concat(t,"). ")+"Please, verify the server configuration and status because this can be the symptom of a bigger issue.")),!0===e.hints["telemetry.enabled"])&&(i._telemetryDisabledConnection=!1),r(a)}})})},D.prototype.protocol=function(){return this._protocol},Object.defineProperty(D.prototype,"address",{get:function(){return this._address},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"version",{get:function(){return this._server.version},set:function(e){this._server.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"server",{get:function(){return this._server},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"logger",{get:function(){return this._log},enumerable:!1,configurable:!0}),D.prototype._handleFatalError=function(e){this._isBroken=!0,this._error=this.handleAndTransformError(this._protocol.currentFailure||e,this._address),this._log.isErrorEnabled()&&this._log.error("experienced a fatal error caused by ".concat(this._error," (").concat(Ud.json.stringify(this._error),")")),this._protocol.notifyFatalError(this._error)},D.prototype._setIdle=function(e){this._idle=!0,this._ch.stopReceiveTimeout(),this._protocol.queueObserverIfProtocolIsNotBroken(e)},D.prototype._unsetIdle=function(){this._idle=!1,this._updateCurrentObserver()},D.prototype._queueObserver=function(e){return this._protocol.queueObserverIfProtocolIsNotBroken(e)},D.prototype.hasOngoingObservableRequests=function(){return!this._idle&&this._protocol.hasOngoingObservableRequests()},D.prototype.resetAndFlush=function(){var r=this;return new Promise(function(e,t){r._reset({onError:function(e){r._isBroken?t(e):(e=r._handleProtocolError("Received FAILURE as a response for RESET: ".concat(e)),t(e))},onComplete:function(){e()}})})},D.prototype._resetOnFailure=function(){var e=this;this.isOpen()&&this._reset({onError:function(){e._protocol.resetFailure()},onComplete:function(){e._protocol.resetFailure()}})},D.prototype._reset=function(t){var e,r=this;this._reseting?this._protocol.isLastMessageReset()?this._resetObservers.push(t):this._protocol.reset({onError:function(e){t.onError(e)},onComplete:function(){t.onComplete()}}):(this._resetObservers.push(t),this._reseting=!0,e=function(e){r._reseting=!1;var t=r._resetObservers;r._resetObservers=[],t.forEach(e)},this._protocol.reset({onError:function(t){e(function(e){return e.onError(t)})},onComplete:function(){e(function(e){return e.onComplete()})}}))},D.prototype._updateCurrentObserver=function(){this._protocol.updateCurrentObserver()},D.prototype.isOpen=function(){return!this._isBroken&&this._ch._open},D.prototype._handleOngoingRequestsNumberChange=function(e){this._idle||(0===e?this._ch.stopReceiveTimeout():this._ch.startReceiveTimeout())},D.prototype.close=function(){return Ad(this,void 0,void 0,function(){return Dd(this,function(e){switch(e.label){case 0:return this._log.isDebugEnabled()&&this._log.debug("closing"),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),[4,this._ch.close()];case 1:return e.sent(),this._log.isDebugEnabled()&&this._log.debug("closed"),[2]}})})},D.prototype.toString=function(){return"Connection [".concat(this.id,"][").concat(this.databaseId||"","]")},D.prototype._handleProtocolError=function(e){this._protocol.resetFailure(),this._updateCurrentObserver();e=(0,Ud.newError)(e,xd);return this._handleFatalError(e),e};var qd,Hd=D;function D(e,t,r,n,o,i,a,s,u,c){void 0===o&&(o=!1),void 0===i&&(i=null);var l,f,t=qd.call(this,t)||this;return t._authToken=null,t._idle=!1,t._reseting=!1,t._resetObservers=[],t._id=Fd++,t._address=r,t._server={address:r.asHostPort()},t._creationTimestamp=Date.now(),t._disableLosslessIntegers=o,t._ch=e,t._chunker=a,t._log=(l=t,new Bd((f=n)._level,function(e,t){return f._loggerFunction(e,"".concat(l," ").concat(t))})),t._serversideRouting=i,t._notificationFilter=s,t._telemetryDisabledDriverConfig=!0===c,t._telemetryDisabledConnection=!0,t._dbConnectionId=null,t._protocol=u(t),t._isBroken=!1,t._log.isDebugEnabled()&&t._log.debug("created towards ".concat(r)),t}I.default=Hd;var Vd,zd,E={},d=e&&e.__extends||(Vd=function(e,t){return(Vd=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Vd(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},P=(Object.defineProperty(E,"__esModule",{value:!0}),f(T)),S=(zd=P.default,d(Wd,zd),Wd.prototype.beginTransaction=function(e){return this._delegate.beginTransaction(e)},Wd.prototype.run=function(e,t,r){return this._delegate.run(e,t,r)},Wd.prototype.commitTransaction=function(e){return this._delegate.commitTransaction(e)},Wd.prototype.rollbackTransaction=function(e){return this._delegate.rollbackTransaction(e)},Wd.prototype.getProtocolVersion=function(){return this._delegate.getProtocolVersion()},Object.defineProperty(Wd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"databaseId",{get:function(){return this._delegate.databaseId},set:function(e){this._delegate.databaseId=e},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"server",{get:function(){return this._delegate.server},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"authToken",{get:function(){return this._delegate.authToken},set:function(e){this._delegate.authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"supportsReAuth",{get:function(){return this._delegate.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"address",{get:function(){return this._delegate.address},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"version",{get:function(){return this._delegate.version},set:function(e){this._delegate.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"creationTimestamp",{get:function(){return this._delegate.creationTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(Wd.prototype,"idleTimestamp",{get:function(){return this._delegate.idleTimestamp},set:function(e){this._delegate.idleTimestamp=e},enumerable:!1,configurable:!0}),Wd.prototype.isOpen=function(){return this._delegate.isOpen()},Wd.prototype.protocol=function(){return this._delegate.protocol()},Wd.prototype.connect=function(e,t,r,n){return this._delegate.connect(e,t,r,n)},Wd.prototype.write=function(e,t,r){return this._delegate.write(e,t,r)},Wd.prototype.resetAndFlush=function(){return this._delegate.resetAndFlush()},Wd.prototype.hasOngoingObservableRequests=function(){return this._delegate.hasOngoingObservableRequests()},Wd.prototype.close=function(){return this._delegate.close()},Wd.prototype.release=function(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate.release()},Wd);function Wd(e,t){var r=zd.call(this,t)||this;return t&&(r._originalErrorHandler=e._errorHandler,e._errorHandler=r._errorHandler),r._delegate=e,r}E.default=S;n={};Object.defineProperty(n,"__esModule",{value:!0});var Gd,Kd,Yd,Zd=t.error.SERVICE_UNAVAILABLE,Qd=t.error.SESSION_EXPIRED;function Xd(e,t,r,n){this._errorCode=e,this._handleUnavailability=t||Jd,this._handleWriteFailure=r||Jd,this._handleSecurityError=n||Jd}function Jd(e){return e}Xd.create=function(e){return new Xd(e.errorCode,e.handleUnavailability,e.handleWriteFailure,e.handleSecurityError)},Xd.prototype.errorCode=function(){return this._errorCode},Xd.prototype.handleAndTransformError=function(e,t,r){var n;return null!=(n=e)&&null!=n.code&&n.code.startsWith("Neo.ClientError.Security.")?this._handleSecurityError(e,t,r):function(e){if(e)return e.code===Qd||e.code===Zd||"Neo.TransientError.General.DatabaseUnavailable"===e.code;return}(e)?this._handleUnavailability(e,t,r):function(e){if(e)return"Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code;return}(e)?this._handleWriteFailure(e,t,r):e},n.default=Xd,o=h,Gd=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Kd=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Gd(t,e,r);return Kd(t,e),t},y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(o,"__esModule",{value:!0}),o.createChannelConnection=o.ConnectionErrorHandler=o.DelegateConnection=o.ChannelConnection=o.Connection=void 0,Qp=y(T),o.Connection=Qp.default,Yd=v(I),o.ChannelConnection=Yd.default,Object.defineProperty(o,"createChannelConnection",{enumerable:!0,get:function(){return Yd.createChannelConnection}}),v=y(E),o.DelegateConnection=v.default,v=y(n),o.ConnectionErrorHandler=v.default,o.default=Qp.default;var hn={},$d=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},e_=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},t_=(Object.defineProperty(hn,"__esModule",{value:!0}),t),r_=w;function n_(e){var t=e.authTokenManager,r=e.userAgent,e=e.boltAgent;this._authTokenManager=t||(0,t_.staticAuthTokenManager)({}),this._userAgent=r,this._boltAgent=e}n_.prototype.authenticate=function(e){var r=e.connection,n=e.auth,o=e.skipReAuth,i=e.waitReAuth,a=e.forceReAuth;return $d(this,void 0,void 0,function(){var t;return e_(this,function(e){switch(e.label){case 0:return null==n?[3,3]:(t=!0===r.supportsReAuth&&(!r_.object.equals(r.authToken,n)&&!0!==o||!0===a),null==r.authToken||t?[4,r.connect(this._userAgent,this._boltAgent,n,i||!1)]:[3,2]);case 1:return[2,e.sent()];case 2:return[2,r];case 3:return[4,this._authTokenManager.getToken()];case 4:return t=e.sent(),r_.object.equals(t,r.authToken)?[3,6]:[4,r.connect(this._userAgent,this._boltAgent,t,!1)];case 5:return[2,e.sent()];case 6:return[2,r]}})})},n_.prototype.handleError=function(e){var t=e.connection,e=e.code;return!(!t||!e.startsWith("Neo.ClientError.Security."))&&this._authTokenManager.handleSecurityException(t.authToken,e)},hn.default=n_;var C={},o_=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},i_=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function a_(e){e=e.connectionLivenessCheckTimeout;this._connectionLivenessCheckTimeout=e}Object.defineProperty(C,"__esModule",{value:!0}),a_.prototype.check=function(r){return o_(this,void 0,void 0,function(){var t;return i_(this,function(e){switch(e.label){case 0:return this._isCheckDisabled||this._isNewlyCreatedConnection(r)?[2,!0]:(t=Date.now()-r.idleTimestamp,0===this._connectionLivenessCheckTimeout||t>this._connectionLivenessCheckTimeout?[4,r.resetAndFlush().then(function(){return!0})]:[3,2]);case 1:return[2,e.sent()];case 2:return[2,!0]}})})},Object.defineProperty(a_.prototype,"_isCheckDisabled",{get:function(){return null==this._connectionLivenessCheckTimeout||this._connectionLivenessCheckTimeout<0},enumerable:!1,configurable:!0}),a_.prototype._isNewlyCreatedConnection=function(e){return null==e.authToken},C.default=a_;var b={},s_=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},u_=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},c_=(Object.defineProperty(b,"__esModule",{value:!0}),O);function l_(e){var t=e.clientCertificateProvider,e=e.loader;this._clientCertificateProvider=t,this._loader=e||c_.ClientCertificatesLoader,this._clientCertificate=null}l_.prototype.getClientCertificate=function(){return s_(this,void 0,void 0,function(){var t,r,n=this;return u_(this,function(e){switch(e.label){case 0:return(t=null!=this._clientCertificateProvider)?(r=null==this._clientCertificate)?[3,2]:[4,this._clientCertificateProvider.hasUpdate()]:[3,3];case 1:r=e.sent(),e.label=2;case 2:t=r,e.label=3;case 3:return t&&(this._clientCertificate=Promise.resolve(this._clientCertificateProvider.getClientCertificate()).then(this._loader.load).then(function(e){return n._clientCertificate=e,n._clientCertificate}).catch(function(e){throw n._clientCertificate=null,e})),[2,this._clientCertificate]}})})},b.default=l_;var f_,h_,u=e&&e.__extends||(f_=function(e,t){return(f_=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}f_(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),p_=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},d_=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},y_=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},b_=(Object.defineProperty(m,"__esModule",{value:!0}),h),m_=t,g_=_(hn),v_=w,O_=_(C),w_=_(b),E_=m_.error.SERVICE_UNAVAILABLE,T_=["Neo.ClientError.Security.CredentialsExpired","Neo.ClientError.Security.Forbidden","Neo.ClientError.Security.TokenExpired","Neo.ClientError.Security.Unauthorized"],c=m_.internal.pool,C_=c.Pool,P_=c.PoolConfig,r=(h_=m_.ConnectionProvider,u(S_,h_),S_.prototype._createConnectionErrorHandler=function(){return new b_.ConnectionErrorHandler(E_)},S_.prototype._getClientCertificate=function(){return p_(this,void 0,void 0,function(){return d_(this,function(e){return[2,this._config.clientCertificate.getClientCertificate()]})})},S_.prototype._createConnection=function(e,r,n){var o=this,i=e.auth;return this._createChannelConnection(r).then(function(t){return t.release=function(){return t.idleTimestamp=Date.now(),n(r,t)},o._openConnections[t.id]=t,o._authenticationProvider.authenticate({connection:t,auth:i}).catch(function(e){throw o._destroyConnection(t),e})})},S_.prototype._validateConnectionOnAcquire=function(e,r){var n=e.auth,o=e.skipReAuth;return p_(this,void 0,void 0,function(){var t;return d_(this,function(e){switch(e.label){case 0:if(!this._validateConnection(r))return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._livenessCheckProvider.check(r)];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),this._log.debug("The connection ".concat(r.id," is not alive because of an error ").concat(t.code," '").concat(t.message,"'")),[2,!1];case 4:return e.trys.push([4,6,,7]),[4,this._authenticationProvider.authenticate({connection:r,auth:n,skipReAuth:o})];case 5:return e.sent(),[2,!0];case 6:return t=e.sent(),this._log.debug("The connection ".concat(r.id," is not valid because of an error ").concat(t.code," '").concat(t.message,"'")),[2,!1];case 7:return[2]}})})},S_.prototype._validateConnectionOnRelease=function(e){return!0!==e._sticky&&this._validateConnection(e)},S_.prototype._validateConnection=function(e){return!(!e.isOpen()||this._config.maxConnectionLifetime<Date.now()-e.creationTimestamp)},S_.prototype._destroyConnection=function(e){return delete this._openConnections[e.id],e.close()},S_.prototype._verifyConnectivityAndGetServerVersion=function(e){var n=e.address;return p_(this,void 0,void 0,function(){var t,r;return d_(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.acquire({},n)];case 1:t=e.sent(),r=new m_.ServerInfo(t.server,t.protocol().version),e.label=2;case 2:return e.trys.push([2,,5,7]),t.protocol().isLastMessageLogon()?[3,4]:[4,t.resetAndFlush()];case 3:e.sent(),e.label=4;case 4:return[3,7];case 5:return[4,t.release()];case 6:return e.sent(),[7];case 7:return[2,r]}})})},S_.prototype._verifyAuthentication=function(e){var a=e.getAddress,s=e.auth;return p_(this,void 0,void 0,function(){var t,r,n,o,i;return d_(this,function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return e.trys.push([1,8,9,11]),[4,a()];case 2:return r=e.sent(),[4,this._connectionPool.acquire({auth:s,skipReAuth:!0},r)];case 3:if(n=e.sent(),t.push(n),o=!n.protocol().isLastMessageLogon(),n.supportsReAuth)return o&&n.supportsReAuth?[4,this._authenticationProvider.authenticate({connection:n,auth:s,waitReAuth:!0,forceReAuth:!0})]:[3,5];throw(0,m_.newError)("Driver is connected to a database that does not support user switch.");case 4:return e.sent(),[3,7];case 5:return!o||n.supportsReAuth?[3,7]:[4,this._connectionPool.acquire({auth:s},r,{requireNew:!0})];case 6:(i=e.sent())._sticky=!0,t.push(i),e.label=7;case 7:return[2,!0];case 8:if(i=e.sent(),T_.includes(i.code))return[2,!1];throw i;case 9:return[4,Promise.all(t.map(function(e){return e.release()}))];case 10:return e.sent(),[7];case 11:return[2]}})})},S_.prototype._verifyStickyConnection=function(e){var n=e.auth,o=e.connection;return e.address,p_(this,void 0,void 0,function(){var t,r;return d_(this,function(e){switch(e.label){case 0:return(t=v_.object.equals(n,o.authToken),r=!t,o._sticky=t&&!o.supportsReAuth,r||o._sticky)?[4,o.release()]:[3,2];case 1:throw e.sent(),(0,m_.newError)("Driver is connected to a database that does not support user switch.");case 2:return[2]}})})},S_.prototype.close=function(){return p_(this,void 0,void 0,function(){return d_(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.close()];case 1:return e.sent(),[4,Promise.all(Object.values(this._openConnections).map(function(e){return e.close()}))];case 2:return e.sent(),[2]}})})},S_._installIdleObserverOnConnection=function(e,t){e._setIdle(t)},S_._removeIdleObserverOnConnection=function(e){e._unsetIdle()},S_.prototype._handleSecurityError=function(e,t,r){return this._authenticationProvider.handleError({connection:r,code:e.code})&&(e.retriable=!0),"Neo.ClientError.Security.AuthorizationExpired"===e.code&&this._connectionPool.apply(t,function(e){e.authToken=null}),r&&r.close().catch(function(){}),e},S_);function S_(e,t){var r=e.id,n=e.config,o=e.log,i=e.userAgent,a=e.boltAgent,s=e.authTokenManager,e=e.newPool,e=void 0===e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(C_.bind.apply(C_,y_([void 0],__(e),!1)))}:e,u=(void 0===t&&(t=null),h_.call(this)||this);return u._id=r,u._config=n,u._log=o,u._clientCertificateHolder=new w_.default({clientCertificateProvider:u._config.clientCertificate}),u._authenticationProvider=new g_.default({authTokenManager:s,userAgent:i,boltAgent:a}),u._livenessCheckProvider=new O_.default({connectionLivenessCheckTimeout:n.connectionLivenessCheckTimeout}),u._userAgent=i,u._boltAgent=a,u._createChannelConnection=t||function(n){return p_(u,void 0,void 0,function(){var t,r;return d_(this,function(e){switch(e.label){case 0:return t=b_.createChannelConnection,r=[n,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,r.concat([e.sent()]))]}})})},u._connectionPool=e({create:u._createConnection.bind(u),destroy:u._destroyConnection.bind(u),validateOnAcquire:u._validateConnectionOnAcquire.bind(u),validateOnRelease:u._validateConnectionOnRelease.bind(u),installIdleObserver:S_._installIdleObserverOnConnection.bind(u),removeIdleObserver:S_._removeIdleObserverOnConnection.bind(u),config:P_.fromDriverConfig(n),log:u._log}),u._openConnections={},u}m.default=r;var R_,I_,g={},a=e&&e.__extends||(R_=function(e,t){return(R_=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}R_(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),N_=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},k_=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},P=(Object.defineProperty(g,"__esModule",{value:!0}),f(m)),j_=h,d=t.internal.constants,A_=d.BOLT_PROTOCOL_V3,D_=d.BOLT_PROTOCOL_V4_0,M_=d.BOLT_PROTOCOL_V4_4,U_=d.BOLT_PROTOCOL_V5_1,L_=t.error.SERVICE_UNAVAILABLE,S=(I_=P.default,a(x_,I_),x_.prototype.acquireConnection=function(e){var e=void 0===e?{}:e,o=(e.accessMode,e.database),i=(e.bookmarks,e.auth),a=e.forceReAuth;return N_(this,void 0,void 0,function(){var t,r,n=this;return k_(this,function(e){switch(e.label){case 0:return t=j_.ConnectionErrorHandler.create({errorCode:L_,handleSecurityError:function(e,t,r){return n._handleSecurityError(e,t,r,o)}}),[4,this._connectionPool.acquire({auth:i,forceReAuth:a},this._address)];case 1:return(r=e.sent(),i)?[4,this._verifyStickyConnection({auth:i,connection:r,address:this._address})]:[3,3];case 2:return e.sent(),[2,r];case 3:return[2,new j_.DelegateConnection(r,t)]}})})},x_.prototype._handleSecurityError=function(e,t,r,n){return this._log.warn("Direct driver ".concat(this._id," will close connection to ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),I_.prototype._handleSecurityError.call(this,e,t,r)},x_.prototype._hasProtocolVersion=function(n){return N_(this,void 0,void 0,function(){var t,r;return k_(this,function(e){switch(e.label){case 0:return[4,this._createChannelConnection(this._address)];case 1:return t=e.sent(),r=t.protocol()?t.protocol().version:null,[4,t.close()];case 2:return e.sent(),r?[2,n(r)]:[2,!1]}})})},x_.prototype.supportsMultiDb=function(){return N_(this,void 0,void 0,function(){return k_(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return D_<=e})];case 1:return[2,e.sent()]}})})},x_.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},x_.prototype.supportsTransactionConfig=function(){return N_(this,void 0,void 0,function(){return k_(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return A_<=e})];case 1:return[2,e.sent()]}})})},x_.prototype.supportsUserImpersonation=function(){return N_(this,void 0,void 0,function(){return k_(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return M_<=e})];case 1:return[2,e.sent()]}})})},x_.prototype.supportsSessionAuth=function(){return N_(this,void 0,void 0,function(){return k_(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return U_<=e})];case 1:return[2,e.sent()]}})})},x_.prototype.verifyAuthentication=function(e){var r=e.auth;return N_(this,void 0,void 0,function(){var t=this;return k_(this,function(e){return[2,this._verifyAuthentication({auth:r,getAddress:function(){return t._address}})]})})},x_.prototype.verifyConnectivityAndGetServerInfo=function(){return N_(this,void 0,void 0,function(){return k_(this,function(e){switch(e.label){case 0:return[4,this._verifyConnectivityAndGetServerVersion({address:this._address})];case 1:return[2,e.sent()]}})})},x_);function x_(e){var t=e.id,r=e.config,n=e.log,o=e.address,i=e.userAgent,a=e.boltAgent,s=e.authTokenManager,e=e.newPool,t=I_.call(this,{id:t,config:r,log:n,userAgent:i,boltAgent:a,authTokenManager:s,newPool:e})||this;return t._address=o,t}g.default=S;var T={},I={},E={},y={},B_=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},F_=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},q_=(Object.defineProperty(y,"__esModule",{value:!0}),y.createValidRoutingTable=void 0,t),n=q_.internal.constants,H_=n.ACCESS_MODE_WRITE,V_=n.ACCESS_MODE_READ,z_=q_.internal.serverAddress.ServerAddress,W_=q_.error.PROTOCOL_ERROR,G_=(K_.fromRawRoutingTable=Z_,K_.prototype.forget=function(e){this.readers=Y_(this.readers,e),this.writers=Y_(this.writers,e)},K_.prototype.forgetRouter=function(e){this.routers=Y_(this.routers,e)},K_.prototype.forgetWriter=function(e){this.writers=Y_(this.writers,e)},K_.prototype.isStaleFor=function(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<1||e===V_&&0===this.readers.length||e===H_&&0===this.writers.length},K_.prototype.isExpiredFor=function(e){return this.expirationTime.add(e).lessThan(Date.now())},K_.prototype.allServers=function(){return F_(F_(F_([],B_(this.routers),!1),B_(this.readers),!1),B_(this.writers),!1)},K_.prototype.toString=function(){return"RoutingTable["+"database=".concat(this.databaseName,", ")+"expirationTime=".concat(this.expirationTime,", ")+"currentTime=".concat(Date.now(),", ")+"routers=[".concat(this.routers,"], ")+"readers=[".concat(this.readers,"], ")+"writers=[".concat(this.writers,"]]")},K_);function K_(e){var e=void 0===e?{}:e,t=e.database,r=e.routers,n=e.readers,o=e.writers,i=e.expirationTime,e=e.ttl;this.database=t||null,this.databaseName=t||"default database",this.routers=r||[],this.readers=n||[],this.writers=o||[],this.expirationTime=i||(0,q_.int)(0),this.ttl=e}function Y_(e,t){return e.filter(function(e){return e.asKey()!==t.asKey()})}function Z_(e,t,r){var n=r.ttl,o=function(t,r){try{var e=(0,q_.int)(Date.now()),n=(0,q_.int)(t.ttl).multiply(1e3).add(e);return n.lessThan(e)?q_.Integer.MAX_VALUE:n}catch(e){throw(0,q_.newError)("Unable to parse TTL entry from router ".concat(r," from raw routing table:\n").concat(q_.json.stringify(t),"\nError message: ").concat(e.message),W_)}}(r,t),i=function(t,r){try{var n=[],o=[],i=[];return t.servers.forEach(function(e){var t=e.role,e=e.addresses;"ROUTE"===t?n=X_(e).map(function(e){return z_.fromUrl(e)}):"WRITE"===t?i=X_(e).map(function(e){return z_.fromUrl(e)}):"READ"===t&&(o=X_(e).map(function(e){return z_.fromUrl(e)}))}),{routers:n,readers:o,writers:i}}catch(e){throw(0,q_.newError)("Unable to parse servers entry from router ".concat(r," from addresses:\n").concat(q_.json.stringify(t.servers),"\nError message: ").concat(e.message),W_)}}(r,t),a=i.routers,s=i.readers,i=i.writers;return Q_(a,"routers",t),Q_(s,"readers",t),new G_({database:e||r.db,routers:a,readers:s,writers:i,expirationTime:o,ttl:n})}function Q_(e,t,r){if(0===e.length)throw(0,q_.newError)("Received no "+t+" from router "+r,W_)}function X_(e){if(Array.isArray(e))return Array.from(e);throw new TypeError("Array expected but got: "+e)}y.default=G_,y.createValidRoutingTable=Z_;var v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},J_=(Object.defineProperty(E,"__esModule",{value:!0}),v(y));function $_(e){this._routingContext=e}$_.prototype.lookupRoutingTableOnRouter=function(t,r,n,o){var i=this;return t._acquireConnection(function(e){return i._requestRawRoutingTable(e,t,r,n,o).then(function(e){return e.isNull?null:J_.default.fromRawRoutingTable(r,n,e)})})},$_.prototype._requestRawRoutingTable=function(r,n,o,e,i){var a=this;return new Promise(function(e,t){r.protocol().requestRoutingInformation({routingContext:a._routingContext,databaseName:o,impersonatedUser:i,sessionContext:{bookmarks:n._lastBookmarks,mode:n._mode,database:n._database,afterComplete:n._onComplete},onCompleted:e,onError:t})})},E.default=$_;var ey,ty,o=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Qp=(Object.defineProperty(I,"__esModule",{value:!0}),I.RoutingTable=I.Rediscovery=void 0,o(E)),hn=(I.Rediscovery=Qp.default,o(y)),C=(I.RoutingTable=hn.default,I.default=Qp.default,e&&e.__extends||(ey=function(e,t){return(ey=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ey(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),ry=e&&e.__assign||function(){return(ry=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ny=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),oy=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),_=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ny(t,e,r);return oy(t,e),t},iy=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},ay=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},sy=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},uy=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},b=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},cy=(Object.defineProperty(T,"__esModule",{value:!0}),t),ly=_(I),fy=O,hy=b(zr),c=b(m),py=i,dy=h,_y=w,yy=cy.error.SERVICE_UNAVAILABLE,by=cy.error.SESSION_EXPIRED,my=cy.internal.bookmarks.Bookmarks,u=cy.internal.constants,gy=u.ACCESS_MODE_READ,vy=u.ACCESS_MODE_WRITE,Oy=u.BOLT_PROTOCOL_V3,wy=u.BOLT_PROTOCOL_V4_0,Ey=u.BOLT_PROTOCOL_V4_4,Ty=u.BOLT_PROTOCOL_V5_1,Cy=null,Py=(0,cy.int)(3e4),r=(ty=c.default,C(Sy,ty),Sy.prototype._createConnectionErrorHandler=function(){return new dy.ConnectionErrorHandler(by)},Sy.prototype._handleUnavailability=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forget(t,r||Cy),e},Sy.prototype._handleSecurityError=function(e,t,r,n){return this._log.warn("Routing driver ".concat(this._id," will close connections to ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),ty.prototype._handleSecurityError.call(this,e,t,r,n)},Sy.prototype._handleWriteFailure=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget writer ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forgetWriter(t,r||Cy),(0,cy.newError)("No longer possible to write to server at "+t,by,e)},Sy.prototype.acquireConnection=function(e){var e=void 0===e?{}:e,u=e.accessMode,c=e.database,l=e.bookmarks,f=e.impersonatedUser,h=e.onDatabaseNameResolved,p=e.auth;return iy(this,void 0,void 0,function(){var t,r,n,o,i,a,s=this;return ay(this,function(e){switch(e.label){case 0:return n={database:c||Cy},o=new dy.ConnectionErrorHandler(by,function(e,t){return s._handleUnavailability(e,t,n.database)},function(e,t){return s._handleWriteFailure(e,t,n.database)},function(e,t,r){return s._handleSecurityError(e,t,r,n.database)}),[4,this._freshRoutingTable({accessMode:u,database:n.database,bookmarks:l,impersonatedUser:f,auth:p,onDatabaseNameResolved:function(e){n.database=n.database||e,h&&h(e)}})];case 1:if(a=e.sent(),u===gy)r=this._loadBalancingStrategy.selectReader(a.readers),t="read";else{if(u!==vy)throw(0,cy.newError)("Illegal mode "+u);r=this._loadBalancingStrategy.selectWriter(a.writers),t="write"}if(!r)throw(0,cy.newError)("Failed to obtain connection towards ".concat(t," server. Known routing table is: ").concat(a),by);e.label=2;case 2:return e.trys.push([2,6,,7]),[4,this._connectionPool.acquire({auth:p},r)];case 3:return(i=e.sent(),p)?[4,this._verifyStickyConnection({auth:p,connection:i,address:r})]:[3,5];case 4:return e.sent(),[2,i];case 5:return[2,new dy.DelegateConnection(i,o)];case 6:throw a=e.sent(),o.handleAndTransformError(a,r);case 7:return[2]}})})},Sy.prototype._hasProtocolVersion=function(a){return iy(this,void 0,void 0,function(){var t,r,n,o,i;return ay(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(this._seedRouter)];case 1:t=e.sent(),n=0,e.label=2;case 2:if(!(n<t.length))return[3,8];e.label=3;case 3:return e.trys.push([3,6,,7]),[4,this._createChannelConnection(t[n])];case 4:return i=e.sent(),o=i.protocol()?i.protocol().version:null,[4,i.close()];case 5:return e.sent(),o?[2,a(o)]:[2,!1];case 6:return i=e.sent(),r=i,[3,7];case 7:return n++,[3,2];case 8:if(r)throw r;return[2,!1]}})})},Sy.prototype.supportsMultiDb=function(){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return wy<=e})];case 1:return[2,e.sent()]}})})},Sy.prototype.supportsTransactionConfig=function(){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Oy<=e})];case 1:return[2,e.sent()]}})})},Sy.prototype.supportsUserImpersonation=function(){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Ey<=e})];case 1:return[2,e.sent()]}})})},Sy.prototype.supportsSessionAuth=function(){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Ty<=e})];case 1:return[2,e.sent()]}})})},Sy.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},Sy.prototype.verifyAuthentication=function(e){var n=e.database,o=e.accessMode,i=e.auth;return iy(this,void 0,void 0,function(){var t=this;return ay(this,function(e){return[2,this._verifyAuthentication({auth:i,getAddress:function(){return iy(t,void 0,void 0,function(){var t,r;return ay(this,function(e){switch(e.label){case 0:return t={database:n||Cy},[4,this._freshRoutingTable({accessMode:o,database:t.database,auth:i,onDatabaseNameResolved:function(e){t.database=t.database||e}})];case 1:if(r=e.sent(),0===(r=o===vy?r.writers:r.readers).length)throw(0,cy.newError)("No servers available for database '".concat(t.database,"' with access mode '").concat(o,"'"),yy);return[2,r[0]]}})})}})]})})},Sy.prototype.verifyConnectivityAndGetServerInfo=function(e){var l=e.database,f=e.accessMode;return iy(this,void 0,void 0,function(){var t,r,n,o,i,a,s,u,c;return ay(this,function(e){switch(e.label){case 0:return t={database:l||Cy},[4,this._freshRoutingTable({accessMode:f,database:t.database,onDatabaseNameResolved:function(e){t.database=t.database||e}})];case 1:r=e.sent(),r=f===vy?r.writers:r.readers,n=(0,cy.newError)("No servers available for database '".concat(t.database,"' with access mode '").concat(f,"'"),yy),e.label=2;case 2:e.trys.push([2,9,10,11]),o=sy(r),i=o.next(),e.label=3;case 3:if(i.done)return[3,8];a=i.value,e.label=4;case 4:return e.trys.push([4,6,,7]),[4,this._verifyConnectivityAndGetServerVersion({address:a})];case 5:return[2,e.sent()];case 6:return s=e.sent(),n=s,[3,7];case 7:return i=o.next(),[3,3];case 8:return[3,11];case 9:return s=e.sent(),u={error:s},[3,11];case 10:try{i&&!i.done&&(c=o.return)&&c.call(o)}finally{if(u)throw u.error}return[7];case 11:throw n}})})},Sy.prototype.forget=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forget(t)}}),this._connectionPool.purge(t).catch(function(){})},Sy.prototype.forgetWriter=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forgetWriter(t)}})},Sy.prototype._freshRoutingTable=function(e){var e=void 0===e?{}:e,t=e.accessMode,r=e.database,n=e.bookmarks,o=e.impersonatedUser,i=e.onDatabaseNameResolved,e=e.auth,a=this._routingTableRegistry.get(r,function(){return new ly.RoutingTable({database:r})});return a.isStaleFor(t)?(this._log.info('Routing table is stale for database: "'.concat(r,'" and access mode: "').concat(t,'": ').concat(a)),this._refreshRoutingTable(a,n,o,e).then(function(e){return i(e.database),e})):a},Sy.prototype._refreshRoutingTable=function(e,t,r,n){var o=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(o,e,t,r,n):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(o,e,t,r,n)},Sy.prototype._fetchRoutingTableFromSeedRouterFallbackToKnownRouters=function(a,s,u,c,l){return iy(this,void 0,void 0,function(){var t,r,n,o,i;return ay(this,function(e){switch(e.label){case 0:return t=[],[4,this._fetchRoutingTableUsingSeedRouter(t,this._seedRouter,s,u,c,l)];case 1:return(t=uy.apply(void 0,[e.sent(),2]),r=t[0],n=t[1],r)?(this._useSeedRouter=!1,[3,4]):[3,2];case 2:return[4,this._fetchRoutingTableUsingKnownRouters(a,s,u,c,l)];case 3:i=uy.apply(void 0,[e.sent(),2]),o=i[0],i=i[1],r=o,n=i||n,e.label=4;case 4:return[4,this._applyRoutingTableIfPossible(s,r,n)];case 5:return[2,e.sent()]}})})},Sy.prototype._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter=function(o,i,a,s,u){return iy(this,void 0,void 0,function(){var t,r,n;return ay(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTableUsingKnownRouters(o,i,a,s,u)];case 1:return r=uy.apply(void 0,[e.sent(),2]),t=r[0],r=r[1],t?[3,3]:[4,this._fetchRoutingTableUsingSeedRouter(o,this._seedRouter,i,a,s,u)];case 2:n=uy.apply(void 0,[e.sent(),2]),t=n[0],r=n[1],e.label=3;case 3:return[4,this._applyRoutingTableIfPossible(i,t,r)];case 4:return[2,e.sent()]}})})},Sy.prototype._fetchRoutingTableUsingKnownRouters=function(n,o,i,a,s){return iy(this,void 0,void 0,function(){var t,r;return ay(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTable(n,o,i,a,s)];case 1:return(t=uy.apply(void 0,[e.sent(),2]),r=t[0],t=t[1],r)?[2,[r,null]]:(r=n.length-1,Sy._forgetRouter(o,n,r),[2,[null,t]])}})})},Sy.prototype._fetchRoutingTableUsingSeedRouter=function(r,n,o,i,a,s){return iy(this,void 0,void 0,function(){var t;return ay(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(n)];case 1:return t=e.sent(),t=t.filter(function(e){return r.indexOf(e)<0}),[4,this._fetchRoutingTable(t,o,i,a,s)];case 2:return[2,e.sent()]}})})},Sy.prototype._resolveSeedRouter=function(n){return iy(this,void 0,void 0,function(){var t,r=this;return ay(this,function(e){switch(e.label){case 0:return[4,this._hostNameResolver.resolve(n)];case 1:return t=e.sent(),[4,Promise.all(t.map(function(e){return r._dnsResolver.resolve(e)}))];case 2:return t=e.sent(),[2,[].concat.apply([],t)]}})})},Sy.prototype._fetchRoutingTable=function(u,c,l,f,h){return iy(this,void 0,void 0,function(){var t=this;return ay(this,function(e){return[2,u.reduce(function(i,a,s){return iy(t,void 0,void 0,function(){var t,r,n,o;return ay(this,function(e){switch(e.label){case 0:return[4,i];case 1:return(t=uy.apply(void 0,[e.sent(),1]),t=t[0])?[2,[t,null]]:(Sy._forgetRouter(c,u,s-1),[4,this._createSessionForRediscovery(a,l,f,h)]);case 2:if(t=uy.apply(void 0,[e.sent(),2]),r=t[0],n=t[1],!r)return[3,8];e.label=3;case 3:return e.trys.push([3,5,6,7]),[4,this._rediscovery.lookupRoutingTableOnRouter(r,c.database,a,f)];case 4:return[2,[e.sent(),null]];case 5:return o=e.sent(),[2,this._handleRediscoveryError(o,a)];case 6:return r.close(),[7];case 7:return[3,9];case 8:return[2,[null,n]];case 9:return[2]}})})},Promise.resolve([null,null]))]})})},Sy.prototype._createSessionForRediscovery=function(o,i,a,s){return iy(this,void 0,void 0,function(){var t,r,n=this;return ay(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this._connectionPool.acquire({auth:s},o)];case 1:return(t=e.sent(),s)?[4,this._verifyStickyConnection({auth:s,connection:t,address:o})]:[3,3];case 2:e.sent(),e.label=3;case 3:return r=dy.ConnectionErrorHandler.create({errorCode:by,handleSecurityError:function(e,t,r){return n._handleSecurityError(e,t,r)}}),r=t._sticky?new dy.DelegateConnection(t):new dy.DelegateConnection(t,r),r=new hy.default(r),t.protocol().version<4?[2,[new cy.Session({mode:vy,bookmarks:my.empty(),connectionProvider:r}),null]]:[2,[new cy.Session({mode:gy,database:"system",bookmarks:i,connectionProvider:r,impersonatedUser:a}),null]];case 4:return r=e.sent(),[2,this._handleRediscoveryError(r,o)];case 5:return[2]}})})},Sy.prototype._handleRediscoveryError=function(e,t){if(["Neo.ClientError.Database.DatabaseNotFound","Neo.ClientError.Transaction.InvalidBookmark","Neo.ClientError.Transaction.InvalidBookmarkMixture","Neo.ClientError.Statement.ArgumentError","Neo.ClientError.Request.Invalid","Neo.ClientError.Statement.TypeError","N/A"].includes(e.code)||(r=e).code.startsWith("Neo.ClientError.Security.")&&!["Neo.ClientError.Security.AuthorizationExpired"].includes(r.code))throw e;if("Neo.ClientError.Procedure.ProcedureNotFound"===e.code)throw(0,cy.newError)("Server at ".concat(t.asHostPort()," can't perform routing. Make sure you are connecting to a causal cluster"),yy,e);var r;return this._log.warn("unable to fetch routing table because of an error ".concat(e)),[null,e]},Sy.prototype._applyRoutingTableIfPossible=function(t,r,n){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:if(r)return 0===r.writers.length&&(this._useSeedRouter=!0),[4,this._updateRoutingTable(r)];throw(0,cy.newError)("Could not perform discovery. No routing servers available. Known routing table: ".concat(t),yy,n);case 1:return e.sent(),[2,r]}})})},Sy.prototype._updateRoutingTable=function(t){return iy(this,void 0,void 0,function(){return ay(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.keepAll(t.allServers())];case 1:return e.sent(),this._routingTableRegistry.removeExpired(),this._routingTableRegistry.register(t),this._log.info("Updated routing table ".concat(t)),[2]}})})},Sy._forgetRouter=function(e,t,r){t=t[r];e&&t&&e.forgetRouter(t)},Sy);function Sy(e){var t=e.id,r=e.address,n=e.routingContext,o=e.hostNameResolver,i=e.config,a=e.log,s=e.userAgent,u=e.boltAgent,c=e.authTokenManager,l=e.routingTablePurgeDelay,e=e.newPool,f=ty.call(this,{id:t,config:i,log:a,userAgent:s,boltAgent:u,authTokenManager:c,newPool:e},function(n){return iy(f,void 0,void 0,function(){var t,r;return ay(this,function(e){switch(e.label){case 0:return t=dy.createChannelConnection,r=[n,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,r.concat([e.sent(),this._routingContext]))]}})})})||this;return f._routingContext=ry(ry({},n),{address:r.toString()}),f._seedRouter=r,f._rediscovery=new ly.default(f._routingContext),f._loadBalancingStrategy=new py.LeastConnectedLoadBalancingStrategy(f._connectionPool),f._hostNameResolver=o,f._dnsResolver=new fy.HostNameResolver,f._log=a,f._useSeedRouter=!0,f._routingTableRegistry=new Gy(l?(0,cy.int)(l):Py),f._refreshRoutingTable=_y.functional.reuseOngoingRequest(f._refreshRoutingTable,f),f}T.default=r;Ky.prototype.register=function(e){return this._tables.set(e.database,e),this},Ky.prototype.apply=function(e,t){var t=void 0===t?{}:t,r=t.applyWhenExists,t=t.applyWhenDontExists,t=void 0===t?function(){}:t;return this._tables.has(e)?r(this._tables.get(e)):"string"==typeof e||null===e?t():this._forEach(r),this},Ky.prototype.get=function(e,t){return this._tables.has(e)?this._tables.get(e):"function"==typeof t?t():t},Ky.prototype.removeExpired=function(){var t=this;return this._removeIf(function(e){return e.isExpiredFor(t._routingTablePurgeDelay)})},Ky.prototype._forEach=function(e){var t,r;try{for(var n=sy(this._tables),o=n.next();!o.done;o=n.next())e(uy(o.value,2)[1])}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this},Ky.prototype._remove=function(e){return this._tables.delete(e),this},Ky.prototype._removeIf=function(e){var t,r;try{for(var n=sy(this._tables),o=n.next();!o.done;o=n.next()){var i=uy(o.value,2),a=i[0];e(i[1])&&this._remove(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this};var Ry,Iy,Ny,ky,jy,Ay,Dy,My,Uy,Ly,xy,M,By,Fy,qy,Hy,Vy,zy,Wy,hn,Gy=Ky;function Ky(e){this._tables=new Map,this._routingTablePurgeDelay=e}function Yy(e,t,r){void 0===r&&(r={}),qy(e,"Bolt URL");var n,o,i=zy.parseDatabaseUrl(e),a=r,s=!1,u=!1;switch(i.scheme){case"bolt":break;case"bolt+s":u=!0,o="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":u=!0,o="TRUST_ALL_CERTIFICATES";break;case"neo4j":s=!0;break;case"neo4j+s":o="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",s=u=!0;break;case"neo4j+ssc":o="TRUST_ALL_CERTIFICATES",s=u=!0;break;default:throw new Error("Unknown scheme: ".concat(null!=(n=i.scheme)?n:"null"))}if(u){if("encrypted"in a||"trust"in a)throw new Error("Encryption/trust can only be configured either through URL or config, not both");a.encrypted=Fy,a.trust=o,a.clientCertificate=(0,M.resolveCertificateProvider)(r.clientCertificate)}var c="object"==typeof(t=r=t)&&null!=t&&"getToken"in t&&"handleSecurityException"in t&&"function"==typeof t.getToken&&"function"==typeof t.handleSecurityException?r:((t=null!=(t=r)?t:{}).scheme=null!=(r=t.scheme)?r:"none",(0,M.staticAuthTokenManager)({authToken:t})),l=(a.userAgent=null!=(r=a.userAgent)?r:Wy,a.boltAgent=M.internal.boltAgent.fromVersion(Ly.default),Vy.fromUrl(i.hostAndPort)),t={address:l,typename:s?"Routing":"Direct",routing:s};return new M.Driver(t,a,function(){{if(s)return function(e,t,r,n){return new By.RoutingConnectionProvider({id:e,config:t,log:r,hostNameResolver:n,authTokenManager:c,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent,routingContext:i.query})};if(Hy(i.query))return function(e,t,r){return new By.DirectConnectionProvider({id:e,config:t,log:r,authTokenManager:c,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent})};throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"))}}())}function Zy(r,n){return My(this,void 0,void 0,function(){var t;return Uy(this,function(e){switch(e.label){case 0:t=Yy(r,{scheme:"none",principal:"",credentials:""},n),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,t.getNegotiatedProtocolVersion()];case 2:return e.sent(),[2,!0];case 3:return[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})}return f=F,Ry=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(f,"__esModule",{value:!0}),f.RoutingConnectionProvider=f.DirectConnectionProvider=f.PooledConnectionProvider=f.SingleConnectionProvider=void 0,Iy=zr,Object.defineProperty(f,"SingleConnectionProvider",{enumerable:!0,get:function(){return Ry(Iy).default}}),Ny=m,Object.defineProperty(f,"PooledConnectionProvider",{enumerable:!0,get:function(){return Ry(Ny).default}}),ky=g,Object.defineProperty(f,"DirectConnectionProvider",{enumerable:!0,get:function(){return Ry(ky).default}}),jy=T,Object.defineProperty(f,"RoutingConnectionProvider",{enumerable:!0,get:function(){return Ry(jy).default}}),d=G,Ay=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Dy=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),P=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Ay(t,e,r);return Dy(t,e),t},a=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Ay(t,e,r)},Object.defineProperty(d,"__esModule",{value:!0}),d.packstream=d.channel=d.buf=d.bolt=d.loadBalancing=void 0,d.loadBalancing=P(i),d.bolt=P(Ar),d.buf=P(vt),d.channel=P(O),d.packstream=P(R),a(F,d),S=L,My=e&&e.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((u=u.apply(e,a||[])).next())})},Uy=e&&e.__generator||function(n,o){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},n=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(S,"__esModule",{value:!0}),S.TransactionPromise=S.ManagedTransaction=S.Transaction=S.Session=S.ServerInfo=S.GqlStatusObject=S.Notification=S.QueryStatistics=S.ProfiledPlan=S.Plan=S.Integer=S.Path=S.PathSegment=S.UnboundRelationship=S.Relationship=S.Node=S.ResultSummary=S.Record=S.EagerResult=S.Result=S.Driver=S.temporal=S.spatial=S.graph=S.error=S.routing=S.session=S.types=S.logging=S.auth=S.isRetriableError=S.Neo4jError=S.integer=S.isUnboundRelationship=S.isRelationship=S.isPathSegment=S.isPath=S.isNode=S.isDateTime=S.isLocalDateTime=S.isDate=S.isTime=S.isLocalTime=S.isDuration=S.isPoint=S.isInt=S.int=S.hasReachableServer=S.driver=S.authTokenManagers=void 0,S.clientCertificateProviders=S.notificationFilterMinimumSeverityLevel=S.notificationFilterDisabledClassification=S.notificationFilterDisabledCategory=S.notificationSeverityLevel=S.notificationClassification=S.notificationCategory=S.resultTransformers=S.bookmarkManager=S.Connection=S.ConnectionProvider=S.DateTime=S.LocalDateTime=S.Date=S.Time=S.LocalTime=S.Duration=S.Point=void 0,Ly=n(x),xy=B,Object.defineProperty(S,"logging",{enumerable:!0,get:function(){return xy.logging}}),M=t,Object.defineProperty(S,"auth",{enumerable:!0,get:function(){return M.auth}}),Object.defineProperty(S,"authTokenManagers",{enumerable:!0,get:function(){return M.authTokenManagers}}),Object.defineProperty(S,"bookmarkManager",{enumerable:!0,get:function(){return M.bookmarkManager}}),Object.defineProperty(S,"Connection",{enumerable:!0,get:function(){return M.Connection}}),Object.defineProperty(S,"ConnectionProvider",{enumerable:!0,get:function(){return M.ConnectionProvider}}),Object.defineProperty(S,"Date",{enumerable:!0,get:function(){return M.Date}}),Object.defineProperty(S,"DateTime",{enumerable:!0,get:function(){return M.DateTime}}),Object.defineProperty(S,"Driver",{enumerable:!0,get:function(){return M.Driver}}),Object.defineProperty(S,"Duration",{enumerable:!0,get:function(){return M.Duration}}),Object.defineProperty(S,"EagerResult",{enumerable:!0,get:function(){return M.EagerResult}}),Object.defineProperty(S,"error",{enumerable:!0,get:function(){return M.error}}),Object.defineProperty(S,"int",{enumerable:!0,get:function(){return M.int}}),Object.defineProperty(S,"Integer",{enumerable:!0,get:function(){return M.Integer}}),Object.defineProperty(S,"isDate",{enumerable:!0,get:function(){return M.isDate}}),Object.defineProperty(S,"isDateTime",{enumerable:!0,get:function(){return M.isDateTime}}),Object.defineProperty(S,"isDuration",{enumerable:!0,get:function(){return M.isDuration}}),Object.defineProperty(S,"isInt",{enumerable:!0,get:function(){return M.isInt}}),Object.defineProperty(S,"isLocalDateTime",{enumerable:!0,get:function(){return M.isLocalDateTime}}),Object.defineProperty(S,"isLocalTime",{enumerable:!0,get:function(){return M.isLocalTime}}),Object.defineProperty(S,"isNode",{enumerable:!0,get:function(){return M.isNode}}),Object.defineProperty(S,"isPath",{enumerable:!0,get:function(){return M.isPath}}),Object.defineProperty(S,"isPathSegment",{enumerable:!0,get:function(){return M.isPathSegment}}),Object.defineProperty(S,"isPoint",{enumerable:!0,get:function(){return M.isPoint}}),Object.defineProperty(S,"isRelationship",{enumerable:!0,get:function(){return M.isRelationship}}),Object.defineProperty(S,"isRetriableError",{enumerable:!0,get:function(){return M.isRetriableError}}),Object.defineProperty(S,"isTime",{enumerable:!0,get:function(){return M.isTime}}),Object.defineProperty(S,"isUnboundRelationship",{enumerable:!0,get:function(){return M.isUnboundRelationship}}),Object.defineProperty(S,"LocalDateTime",{enumerable:!0,get:function(){return M.LocalDateTime}}),Object.defineProperty(S,"LocalTime",{enumerable:!0,get:function(){return M.LocalTime}}),Object.defineProperty(S,"ManagedTransaction",{enumerable:!0,get:function(){return M.ManagedTransaction}}),Object.defineProperty(S,"Neo4jError",{enumerable:!0,get:function(){return M.Neo4jError}}),Object.defineProperty(S,"Node",{enumerable:!0,get:function(){return M.Node}}),Object.defineProperty(S,"Notification",{enumerable:!0,get:function(){return M.Notification}}),Object.defineProperty(S,"GqlStatusObject",{enumerable:!0,get:function(){return M.GqlStatusObject}}),Object.defineProperty(S,"notificationCategory",{enumerable:!0,get:function(){return M.notificationCategory}}),Object.defineProperty(S,"notificationClassification",{enumerable:!0,get:function(){return M.notificationClassification}}),Object.defineProperty(S,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return M.notificationFilterDisabledCategory}}),Object.defineProperty(S,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return M.notificationFilterDisabledClassification}}),Object.defineProperty(S,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return M.notificationFilterMinimumSeverityLevel}}),Object.defineProperty(S,"notificationSeverityLevel",{enumerable:!0,get:function(){return M.notificationSeverityLevel}}),Object.defineProperty(S,"Path",{enumerable:!0,get:function(){return M.Path}}),Object.defineProperty(S,"PathSegment",{enumerable:!0,get:function(){return M.PathSegment}}),Object.defineProperty(S,"Plan",{enumerable:!0,get:function(){return M.Plan}}),Object.defineProperty(S,"Point",{enumerable:!0,get:function(){return M.Point}}),Object.defineProperty(S,"ProfiledPlan",{enumerable:!0,get:function(){return M.ProfiledPlan}}),Object.defineProperty(S,"QueryStatistics",{enumerable:!0,get:function(){return M.QueryStatistics}}),Object.defineProperty(S,"Record",{enumerable:!0,get:function(){return M.Record}}),Object.defineProperty(S,"Relationship",{enumerable:!0,get:function(){return M.Relationship}}),Object.defineProperty(S,"Result",{enumerable:!0,get:function(){return M.Result}}),Object.defineProperty(S,"ResultSummary",{enumerable:!0,get:function(){return M.ResultSummary}}),Object.defineProperty(S,"resultTransformers",{enumerable:!0,get:function(){return M.resultTransformers}}),Object.defineProperty(S,"routing",{enumerable:!0,get:function(){return M.routing}}),Object.defineProperty(S,"ServerInfo",{enumerable:!0,get:function(){return M.ServerInfo}}),Object.defineProperty(S,"Session",{enumerable:!0,get:function(){return M.Session}}),Object.defineProperty(S,"Time",{enumerable:!0,get:function(){return M.Time}}),Object.defineProperty(S,"Transaction",{enumerable:!0,get:function(){return M.Transaction}}),Object.defineProperty(S,"TransactionPromise",{enumerable:!0,get:function(){return M.TransactionPromise}}),Object.defineProperty(S,"UnboundRelationship",{enumerable:!0,get:function(){return M.UnboundRelationship}}),Object.defineProperty(S,"clientCertificateProviders",{enumerable:!0,get:function(){return M.clientCertificateProviders}}),By=G,n=M.driver.READ,v=M.driver.WRITE,E=M.internal.util,Fy=E.ENCRYPTION_ON,qy=E.assertString,Hy=E.isEmptyObjectOrNull,Vy=M.internal.serverAddress.ServerAddress,zy=M.internal.urlUtil,Wy="neo4j-javascript/"+Ly.default,S.driver=Yy,S.hasReachableServer=Zy,E={Node:M.Node,Relationship:M.Relationship,UnboundRelationship:M.UnboundRelationship,PathSegment:M.PathSegment,Path:M.Path,Result:M.Result,EagerResult:M.EagerResult,ResultSummary:M.ResultSummary,Record:M.Record,Point:M.Point,Date:M.Date,DateTime:M.DateTime,Duration:M.Duration,LocalDateTime:M.LocalDateTime,LocalTime:M.LocalTime,Time:M.Time,Integer:M.Integer},S.types=E,n={READ:n,WRITE:v},S.session=n,v={toNumber:M.toNumber,toString:M.toString,inSafeRange:M.inSafeRange},S.integer=v,o={isPoint:M.isPoint},S.spatial=o,y={isDuration:M.isDuration,isLocalTime:M.isLocalTime,isTime:M.isTime,isDate:M.isDate,isLocalDateTime:M.isLocalDateTime,isDateTime:M.isDateTime},S.temporal=y,hn={isNode:M.isNode,isPath:M.isPath,isPathSegment:M.isPathSegment,isRelationship:M.isRelationship,isUnboundRelationship:M.isUnboundRelationship},S.graph=hn,v={authTokenManagers:M.authTokenManagers,driver:Yy,hasReachableServer:Zy,int:M.int,isInt:M.isInt,isPoint:M.isPoint,isDuration:M.isDuration,isLocalTime:M.isLocalTime,isTime:M.isTime,isDate:M.isDate,isLocalDateTime:M.isLocalDateTime,isDateTime:M.isDateTime,isNode:M.isNode,isPath:M.isPath,isPathSegment:M.isPathSegment,isRelationship:M.isRelationship,isUnboundRelationship:M.isUnboundRelationship,integer:v,Neo4jError:M.Neo4jError,isRetriableError:M.isRetriableError,auth:M.auth,logging:xy.logging,types:E,session:n,routing:M.routing,error:M.error,graph:hn,spatial:o,temporal:y,Driver:M.Driver,Result:M.Result,EagerResult:M.EagerResult,Record:M.Record,ResultSummary:M.ResultSummary,Node:M.Node,Relationship:M.Relationship,UnboundRelationship:M.UnboundRelationship,PathSegment:M.PathSegment,Path:M.Path,Integer:M.Integer,Plan:M.Plan,ProfiledPlan:M.ProfiledPlan,QueryStatistics:M.QueryStatistics,Notification:M.Notification,GqlStatusObject:M.GqlStatusObject,ServerInfo:M.ServerInfo,Session:M.Session,Transaction:M.Transaction,ManagedTransaction:M.ManagedTransaction,TransactionPromise:M.TransactionPromise,Point:M.Point,Duration:M.Duration,LocalTime:M.LocalTime,Time:M.Time,Date:M.Date,LocalDateTime:M.LocalDateTime,DateTime:M.DateTime,ConnectionProvider:M.ConnectionProvider,Connection:M.Connection,bookmarkManager:M.bookmarkManager,resultTransformers:M.resultTransformers,notificationCategory:M.notificationCategory,notificationClassification:M.notificationClassification,notificationSeverityLevel:M.notificationSeverityLevel,notificationFilterDisabledCategory:M.notificationFilterDisabledCategory,notificationFilterDisabledClassification:M.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:M.notificationFilterMinimumSeverityLevel,clientCertificateProviders:M.clientCertificateProviders},S.default=v,U(L)});