!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).neo4j=t()}(this,function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L,x,B={},F={},H=(Object.defineProperty(F,"__esModule",{value:!0}),F.default="5.4.0",{}),t=(Object.defineProperty(H,"__esModule",{value:!0}),H.logging=void 0,H.logging={console:function(e){return{level:e,logger:function(e,t){return console.log("".concat(Date.now()," ").concat(e.toUpperCase()," ").concat(t))}}}},{}),r={},n=e&&e.__extends||(L=function(e,t){return(L=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}L(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),q=(Object.defineProperty(r,"__esModule",{value:!0}),r.PROTOCOL_ERROR=r.SESSION_EXPIRED=r.SERVICE_UNAVAILABLE=r.Neo4jError=r.isRetriableError=r.newError=void 0,"ServiceUnavailable"),V=(r.SERVICE_UNAVAILABLE=q,"SessionExpired"),z=(r.SESSION_EXPIRED=V,r.PROTOCOL_ERROR="ProtocolError",x=Error,n(W,x),W.isRetriable=function(e){return null!=e&&e instanceof W&&e.retriable},W);function W(e,t,r){e=x.call(this,e,null!=r?{cause:r}:void 0)||this;return e.constructor=W,e.__proto__=W.prototype,e.code=t,e.name="Neo4jError",e.retriable=(r=t)===q||r===V||"Neo.ClientError.Security.AuthorizationExpired"===r||function(e){return!0===(null==e?void 0:e.includes("TransientError"))}(r),e}r.Neo4jError=z,r.newError=function(e,t,r){return new z(e,null!=t?t:"N/A",r)};n=z.isRetriable;r.isRetriableError=n;var n={},G=(Object.defineProperty(n,"__esModule",{value:!0}),n.toString=n.toNumber=n.inSafeRange=n.isInt=n.int=void 0,r),K=new Map,o=(p.prototype.inSafeRange=function(){return this.greaterThanOrEqual(p.MIN_SAFE_VALUE)&&this.lessThanOrEqual(p.MAX_SAFE_VALUE)},p.prototype.toInt=function(){return this.low},p.prototype.toNumber=function(){return this.high*Y+(this.low>>>0)},p.prototype.toBigInt=function(){var e;return this.isZero()?BigInt(0):this.isPositive()?BigInt(this.high>>>0)*BigInt(Y)+BigInt(this.low>>>0):(e=this.negate(),BigInt(-1)*(BigInt(e.high>>>0)*BigInt(Y)+BigInt(e.low>>>0)))},p.prototype.toNumberOrInfinity=function(){return this.lessThan(p.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(p.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()},p.prototype.toString=function(e){if((e=null!=e?e:10)<2||36<e)throw RangeError("radix out of range: "+e.toString());if(this.isZero())return"0";var t,r,n;if(this.isNegative())return this.equals(p.MIN_VALUE)?(t=p.fromNumber(e),n=(r=this.div(t)).multiply(t).subtract(this),r.toString(e)+n.toInt().toString(e)):"-"+this.negate().toString(e);for(var o=p.fromNumber(Math.pow(e,6)),i=(n=this,"");;){var s=n.div(o),a=(n.subtract(s.multiply(o)).toInt()>>>0).toString(e);if((n=s).isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}},p.prototype.valueOf=function(){return this.toBigInt()},p.prototype.getHighBits=function(){return this.high},p.prototype.getLowBits=function(){return this.low},p.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(p.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!==this.high?this.high:this.low,t=0,t=31;0<t&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1},p.prototype.isZero=function(){return 0===this.high&&0===this.low},p.prototype.isNegative=function(){return this.high<0},p.prototype.isPositive=function(){return 0<=this.high},p.prototype.isOdd=function(){return 1==(1&this.low)},p.prototype.isEven=function(){return 0==(1&this.low)},p.prototype.equals=function(e){e=p.fromValue(e);return this.high===e.high&&this.low===e.low},p.prototype.notEquals=function(e){return!this.equals(e)},p.prototype.lessThan=function(e){return this.compare(e)<0},p.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},p.prototype.greaterThan=function(e){return 0<this.compare(e)},p.prototype.greaterThanOrEqual=function(e){return 0<=this.compare(e)},p.prototype.compare=function(e){var t,r,e=p.fromValue(e);return this.equals(e)?0:(t=this.isNegative(),r=e.isNegative(),t&&!r||(t||!r)&&this.subtract(e).isNegative()?-1:1)},p.prototype.negate=function(){return this.equals(p.MIN_VALUE)?p.MIN_VALUE:this.not().add(p.ONE)},p.prototype.add=function(e){var e=p.fromValue(e),t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=0,c=0,l=0,f=0;return c+=(l=l+((f+=o+(65535&e.low))>>>16)+(n+a))>>>16,p.fromBits((l&=65535)<<16|(f&=65535),((u+=(c+=r+s)>>>16)+(t+i)&65535)<<16|(c&=65535))},p.prototype.subtract=function(e){e=p.fromValue(e);return this.add(e.negate())},p.prototype.multiply=function(e){var t,r,n,o,i,s,a,u,c,l,f;return this.isZero()||(e=p.fromValue(e)).isZero()?p.ZERO:this.equals(p.MIN_VALUE)?e.isOdd()?p.MIN_VALUE:p.ZERO:e.equals(p.MIN_VALUE)?this.isOdd()?p.MIN_VALUE:p.ZERO:this.isNegative()?e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate():e.isNegative()?this.multiply(e.negate()).negate():this.lessThan(X)&&e.lessThan(X)?p.fromNumber(this.toNumber()*e.toNumber()):(t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,f=(f=l=c=u=0)+((c=c+((l+=o*(e=65535&e.low))>>>16)+n*e)>>>16)+((c=(c&65535)+o*a)>>>16),p.fromBits((c&=65535)<<16|(l&=65535),(u=(u=(u+=(f+=r*e)>>>16)+((f=(f&65535)+n*a)>>>16)+((f=(f&65535)+o*s)>>>16))+(t*e+r*a+n*s+o*i)&65535)<<16|(f&=65535)))},p.prototype.div=function(e){var t,r,n,o=p.fromValue(e);if(o.isZero())throw(0,G.newError)("division by zero");if(this.isZero())return p.ZERO;if(this.equals(p.MIN_VALUE))return o.equals(p.ONE)||o.equals(p.NEG_ONE)?p.MIN_VALUE:o.equals(p.MIN_VALUE)?p.ONE:(n=this.shiftRight(1).div(o).shiftLeft(1)).equals(p.ZERO)?o.isNegative()?p.ONE:p.NEG_ONE:(t=this.subtract(o.multiply(n)),n.add(t.div(o)));if(o.equals(p.MIN_VALUE))return p.ZERO;if(this.isNegative())return o.isNegative()?this.negate().div(o.negate()):this.negate().div(o).negate();if(o.isNegative())return this.div(o.negate()).negate();for(r=p.ZERO,t=this;t.greaterThanOrEqual(o);){n=Math.max(1,Math.floor(t.toNumber()/o.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),s=i<=48?1:Math.pow(2,i-48),a=p.fromNumber(n),u=a.multiply(o);u.isNegative()||u.greaterThan(t);)u=(a=p.fromNumber(n-=s)).multiply(o);a.isZero()&&(a=p.ONE),r=r.add(a),t=t.subtract(u)}return r},p.prototype.modulo=function(e){e=p.fromValue(e);return this.subtract(this.div(e).multiply(e))},p.prototype.not=function(){return p.fromBits(~this.low,~this.high)},p.prototype.and=function(e){e=p.fromValue(e);return p.fromBits(this.low&e.low,this.high&e.high)},p.prototype.or=function(e){e=p.fromValue(e);return p.fromBits(this.low|e.low,this.high|e.high)},p.prototype.xor=function(e){e=p.fromValue(e);return p.fromBits(this.low^e.low,this.high^e.high)},p.prototype.shiftLeft=function(e){e=p.toNumber(e);return 0==(e&=63)?p.ZERO:e<32?p.fromBits(this.low<<e,this.high<<e|this.low>>>32-e):p.fromBits(0,this.low<<e-32)},p.prototype.shiftRight=function(e){var t=p.toNumber(e);return 0==(t&=63)?p.ZERO:e<32?p.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):p.fromBits(this.high>>t-32,0<=this.high?0:-1)},p.isInteger=function(e){return!0===(null==e?void 0:e.__isInteger__)},p.fromInt=function(e){var t;return-128<=(e|=0)&&e<128&&null!=(t=K.get(e))||(t=new p(e,e<0?-1:0),-128<=e&&e<128&&K.set(e,t)),t},p.fromBits=function(e,t){return new p(e,t)},p.fromNumber=function(e){return isNaN(e)||!isFinite(e)?p.ZERO:e<=-Z?p.MIN_VALUE:Z<=e+1?p.MAX_VALUE:e<0?p.fromNumber(-e).negate():new p(e%Y|0,e/Y|0)},p.fromString=function(e,t,r){var n=(void 0===r?{}:r).strictStringValidation;if(0===e.length)throw(0,G.newError)("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return p.ZERO;if((t=null!=t?t:10)<2||36<t)throw(0,G.newError)("radix out of range: "+t.toString());if(0<(r=e.indexOf("-")))throw(0,G.newError)('number format error: interior "-" character: '+e);if(0===r)return p.fromString(e.substring(1),t).negate();for(var o,i,s=p.fromNumber(Math.pow(t,8)),a=p.ZERO,u=0;u<e.length;u+=8){var c,l=Math.min(8,e.length-u),f=e.substring(u,u+l),h=parseInt(f,t);if(!0===n&&(o=f,c=h,i=t,Number.isNaN(o)||Number.isNaN(c)||function(e,t,r){e=e.toString(t),t=Math.max(r-e.length,0),r="0".repeat(t);return"".concat(r).concat(e)}(c,i,o.length)!==o.toLowerCase()))throw(0,G.newError)('number format error: "'.concat(f,'" is NaN in radix ').concat(t,": ").concat(e));a=(l<8?(c=p.fromNumber(Math.pow(t,l)),a.multiply(c)):a=a.multiply(s)).add(p.fromNumber(h))}return a},p.fromValue=function(e,t){return void 0===t&&(t={}),e instanceof p?e:"number"==typeof e?p.fromNumber(e):"string"==typeof e?p.fromString(e,void 0,t):"bigint"==typeof e?p.fromString(e.toString()):new p(e.low,e.high)},p.toNumber=function(e){switch(typeof e){case"number":return e;case"bigint":return Number(e);default:return p.fromValue(e).toNumber()}},p.toString=function(e,t){return p.fromValue(e).toString(t)},p.inSafeRange=function(e){return p.fromValue(e).inSafeRange()},p.ZERO=p.fromInt(0),p.ONE=p.fromInt(1),p.NEG_ONE=p.fromInt(-1),p.MAX_VALUE=p.fromBits(-1,2147483647),p.MIN_VALUE=p.fromBits(0,-2147483648),p.MIN_SAFE_VALUE=p.fromBits(1,-2097152),p.MAX_SAFE_VALUE=p.fromBits(-1,2097151),p.__isInteger__=!0,p);function p(e,t){this.low=null!=e?e:0,this.high=null!=t?t:0}Object.defineProperty(o.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});var Y=4294967296,Z=Y*Y/2,X=o.fromInt(1<<24),i=o.fromValue,i=(n.int=i,o.isInteger),i=(n.isInt=i,o.inSafeRange),i=(n.inSafeRange=i,o.toNumber),i=(n.toNumber=i,o.toString),i=(n.toString=i,n.default=o,{}),o={},s={},a={},u={},Q=(Object.defineProperty(u,"__esModule",{value:!0}),u.getBrokenObjectReason=u.isBrokenObject=u.createBrokenObject=void 0,"__isBrokenObject__"),$="__reason__";u.createBrokenObject=function(r,e){function n(){throw r}return void 0===e&&(e={}),new Proxy(e,{get:function(e,t){return t===Q||(t===$?r:void("toJSON"!==t&&n()))},set:n,apply:n,construct:n,defineProperty:n,deleteProperty:n,getOwnPropertyDescriptor:n,getPrototypeOf:n,has:n,isExtensible:n,ownKeys:n,preventExtensions:n,setPrototypeOf:n})},u.isBrokenObject=function(e){return null!==e&&"object"==typeof e&&!0===e[Q]},u.getBrokenObjectReason=function(e){return e[$]},Object.defineProperty(a,"__esModule",{value:!0}),a.stringify=void 0;var J=u;a.stringify=function(e){return JSON.stringify(e,function(e,t){return(0,J.isBrokenObject)(t)?{__isBrokenObject__:!0,__reason__:(0,J.getBrokenObjectReason)(t)}:"bigint"==typeof t?"".concat(t,"n"):t})},Object.defineProperty(s,"__esModule",{value:!0}),s.ENCRYPTION_OFF=s.ENCRYPTION_ON=s.validateQueryAndParameters=s.assertValidDate=s.assertNumberOrInteger=s.assertNumber=s.assertString=s.assertObject=s.isString=s.isObject=s.isEmptyObjectOrNull=void 0;var c,ee,te,l,re,ne,oe=n,ie=a;s.ENCRYPTION_ON="ENCRYPTION_ON";function se(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function ae(e,t){if(ue(e))return e;throw new TypeError((0,ie.stringify)(t)+" expected to be string but was: "+(0,ie.stringify)(e))}function ue(e){return"[object String]"===Object.prototype.toString.call(e)}function ce(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=(0,l.int)(e),this._maxInteger=(0,l.int)(t)}function le(e,t,r){e=(0,l.int)(e),t=(0,l.int)(t),r=(0,l.int)(r);var n=e.multiply(365);return n=(n=(n=e.greaterThanOrEqual(0)?n.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):n.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(r.subtract(1)),(n=t.greaterThan(2)&&(n=n.subtract(1),!function(e){if((e=(0,l.int)(e)).modulo(4).equals(0)){if(e.modulo(100).equals(0))return!!e.modulo(400).equals(0);return 1}}(e))?n.subtract(1):n).subtract(c.DAYS_0000_TO_1970)}function fe(e,t,r){if((0,ne.assertNumberOrInteger)(e,r),t.contains(e))return e;throw(0,re.newError)("".concat(r," is expected to be in range ").concat(t.toString()," but was: ").concat(e.toString()))}function he(e,t){e=(0,l.int)(e),t=(0,l.int)(t);var r=e.div(t);return r=e.isPositive()!==t.isPositive()&&r.multiply(t).notEquals(e)?r.subtract(1):r}function pe(e,t){return e=(0,l.int)(e),t=(0,l.int)(t),e.subtract(he(e,t).multiply(t))}function de(e){return(e=(0,l.int)(e)).equals(0)?"":"."+_e(e,9)}function _e(e,t,r){var n=(e=(0,l.int)(e)).isNegative(),o=(e=n?e.negate():e).toString();if(null!=t)for(;o.length<t;)o="0"+o;return n?"-"+o:!0===(null==r?void 0:r.usePositiveSign)?"+"+o:o}s.ENCRYPTION_OFF="ENCRYPTION_OFF",s.isEmptyObjectOrNull=function(e){if(null!==e){if(!se(e))return!1;for(var t in e)if(void 0!==e[t])return!1}return!0},s.isObject=se,s.validateQueryAndParameters=function(e,t,r){var n="",t=null!=t?t:{},r=null!=(r=null==r?void 0:r.skipAsserts)&&r;if("string"==typeof e?n=e:e instanceof String?n=e.toString():"object"==typeof e&&null!=e.text&&(n=e.text,t=null!=(e=e.parameters)?e:{}),!r){e=n;if(ae(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.");r=t;if(!se(r))throw e=null!=r.constructor?" "+r.constructor.name:"",new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(e," ").concat(JSON.stringify(r)))}return{validatedQuery:n,params:t}},s.assertObject=function(e,t){if(se(e))return e;throw new TypeError(t+" expected to be an object but was: "+(0,ie.stringify)(e))},s.assertString=ae,s.assertNumber=function(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+(0,ie.stringify)(e));return e},s.assertNumberOrInteger=function(e,t){if("number"==typeof e||"bigint"==typeof e||(0,oe.isInt)(e))return e;throw new TypeError(t+" expected to be either a number or an Integer object but was: "+(0,ie.stringify)(e))},s.assertValidDate=function(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+(0,ie.stringify)(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+(0,ie.stringify)(e));return e},s.isString=ue,c=o,ee=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),te=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ee(t,e,r);return te(t,e),t},Object.defineProperty(c,"__esModule",{value:!0}),c.floorMod=c.floorDiv=c.assertValidZoneId=c.assertValidNanosecond=c.assertValidSecond=c.assertValidMinute=c.assertValidHour=c.assertValidDay=c.assertValidMonth=c.assertValidYear=c.timeZoneOffsetInSeconds=c.totalNanoseconds=c.newDate=c.toStandardDate=c.isoStringToStandardDate=c.dateToIsoString=c.timeZoneOffsetToIsoString=c.timeToIsoString=c.durationToIsoString=c.dateToEpochDay=c.localDateTimeToEpochSecond=c.localTimeToNanoOfDay=c.normalizeNanosecondsForDuration=c.normalizeSecondsForDuration=c.SECONDS_PER_DAY=c.DAYS_PER_400_YEAR_CYCLE=c.DAYS_0000_TO_1970=c.NANOS_PER_HOUR=c.NANOS_PER_MINUTE=c.NANOS_PER_MILLISECOND=c.NANOS_PER_SECOND=c.SECONDS_PER_HOUR=c.SECONDS_PER_MINUTE=c.MINUTES_PER_HOUR=c.NANOSECOND_OF_SECOND_RANGE=c.SECOND_OF_MINUTE_RANGE=c.MINUTE_OF_HOUR_RANGE=c.HOUR_OF_DAY_RANGE=c.DAY_OF_MONTH_RANGE=c.MONTH_OF_YEAR_RANGE=c.YEAR_RANGE=void 0,l=f(n),re=r,ne=s,ce.prototype.contains=function(e){var t;return(0,l.isInt)(e)&&e instanceof l.default?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):"bigint"==typeof e?(t=(0,l.int)(e)).greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber},ce.prototype.toString=function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")},f=ce,c.YEAR_RANGE=new f(-999999999,999999999),c.MONTH_OF_YEAR_RANGE=new f(1,12),c.DAY_OF_MONTH_RANGE=new f(1,31),c.HOUR_OF_DAY_RANGE=new f(0,23),c.MINUTE_OF_HOUR_RANGE=new f(0,59),c.SECOND_OF_MINUTE_RANGE=new f(0,59),c.NANOSECOND_OF_SECOND_RANGE=new f(0,999999999),c.MINUTES_PER_HOUR=60,c.SECONDS_PER_MINUTE=60,c.SECONDS_PER_HOUR=c.SECONDS_PER_MINUTE*c.MINUTES_PER_HOUR,c.NANOS_PER_SECOND=1e9,c.NANOS_PER_MILLISECOND=1e6,c.NANOS_PER_MINUTE=c.NANOS_PER_SECOND*c.SECONDS_PER_MINUTE,c.NANOS_PER_HOUR=c.NANOS_PER_MINUTE*c.MINUTES_PER_HOUR,c.DAYS_0000_TO_1970=719528,c.DAYS_PER_400_YEAR_CYCLE=146097,c.SECONDS_PER_DAY=86400,c.normalizeSecondsForDuration=function(e,t){return(0,l.int)(e).add(he(t,c.NANOS_PER_SECOND))},c.normalizeNanosecondsForDuration=function(e){return pe(e,c.NANOS_PER_SECOND)},c.localTimeToNanoOfDay=function(e,t,r,n){return e=(0,l.int)(e),t=(0,l.int)(t),r=(0,l.int)(r),n=(0,l.int)(n),(e=(e=(e=e.multiply(c.NANOS_PER_HOUR)).add(t.multiply(c.NANOS_PER_MINUTE))).add(r.multiply(c.NANOS_PER_SECOND))).add(n)},c.localDateTimeToEpochSecond=function(e,t,r,n,o,i,s){return e=le(e,t,r),t=function(e,t,r){e=(0,l.int)(e),t=(0,l.int)(t),r=(0,l.int)(r);e=e.multiply(c.SECONDS_PER_HOUR);return(e=e.add(t.multiply(c.SECONDS_PER_MINUTE))).add(r)}(n,o,i),e.multiply(c.SECONDS_PER_DAY).add(t)},c.dateToEpochDay=le,c.durationToIsoString=function(e,t,r,n){return e=_e(e),t=_e(t),r=function(e,t){e=(0,l.int)(e),t=(0,l.int)(t);var r,n=e.isNegative(),o=t.greaterThan(0);e=n&&o?e.equals(-1)?"-0":e.add(1).toString():e.toString();o&&(r=de((n?t.negate().add(2*c.NANOS_PER_SECOND):t.add(c.NANOS_PER_SECOND)).modulo(c.NANOS_PER_SECOND)));return null!=r?e+r:e}(r,n),"P".concat(e,"M").concat(t,"DT").concat(r,"S")},c.timeToIsoString=function(e,t,r,n){return e=_e(e,2),t=_e(t,2),r=_e(r,2),n=de(n),"".concat(e,":").concat(t,":").concat(r).concat(n)},c.timeZoneOffsetToIsoString=function(e){var t,r,n;return(e=(0,l.int)(e)).equals(0)?"Z":(t=(r=e.isNegative())?"-":"+",r=_e((e=r?e.multiply(-1):e).div(c.SECONDS_PER_HOUR),2),n=_e(e.div(c.SECONDS_PER_MINUTE).modulo(c.MINUTES_PER_HOUR),2),null!=(e=(e=e.modulo(c.SECONDS_PER_MINUTE)).equals(0)?null:_e(e,2))?"".concat(t).concat(r,":").concat(n,":").concat(e):"".concat(t).concat(r,":").concat(n))},c.dateToIsoString=function(e,t,r){return e=function(e){e=(0,l.int)(e);if(e.isNegative()||e.greaterThan(9999))return _e(e,6,{usePositiveSign:!0});return _e(e,4)}(e),t=_e(t,2),r=_e(r,2),"".concat(e,"-").concat(t,"-").concat(r)},c.isoStringToStandardDate=function(e){return new Date(e)},c.toStandardDate=function(e){return new Date(e)},c.newDate=function(e){return new Date(e)},c.totalNanoseconds=function(e,t){return t=null!=t?t:0,e=e.getMilliseconds()*c.NANOS_PER_MILLISECOND,t instanceof l.default?t.add(e):"bigint"==typeof t?t+BigInt(e):t+e},c.timeZoneOffsetInSeconds=function(e){var t=e.getSeconds()>=e.getUTCSeconds()?e.getSeconds()-e.getUTCSeconds():e.getSeconds()-e.getUTCSeconds()+60;return 0===(e=e.getTimezoneOffset())?0+t:-1*e*c.SECONDS_PER_MINUTE+t},c.assertValidYear=function(e){return fe(e,c.YEAR_RANGE,"Year")},c.assertValidMonth=function(e){return fe(e,c.MONTH_OF_YEAR_RANGE,"Month")},c.assertValidDay=function(e){return fe(e,c.DAY_OF_MONTH_RANGE,"Day")},c.assertValidHour=function(e){return fe(e,c.HOUR_OF_DAY_RANGE,"Hour")},c.assertValidMinute=function(e){return fe(e,c.MINUTE_OF_HOUR_RANGE,"Minute")},c.assertValidSecond=function(e){return fe(e,c.SECOND_OF_MINUTE_RANGE,"Second")},c.assertValidNanosecond=function(e){return fe(e,c.NANOSECOND_OF_SECOND_RANGE,"Nanosecond")},c.assertValidZoneId=function(t,r){try{Intl.DateTimeFormat(void 0,{timeZone:r})}catch(e){throw(0,re.newError)("".concat(t,' is expected to be a valid ZoneId but was: "').concat(r,'"'))}},c.floorDiv=he,c.floorMod=pe;var ye=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),be=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ye(t,e,r);return be(t,e),t},me=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},h=(Object.defineProperty(i,"__esModule",{value:!0}),i.isDateTime=i.DateTime=i.isLocalDateTime=i.LocalDateTime=i.isDate=i.Date=i.isTime=i.Time=i.isLocalTime=i.LocalTime=i.isDuration=i.Duration=void 0,f(o)),ge=s,ve=r,we=f(n),f={value:!0,enumerable:!1,configurable:!1,writable:!1},Oe="__isDuration__",Ee="__isLocalTime__",Te="__isTime__",Se="__isDate__",Pe="__isLocalDateTime__",Ce="__isDateTime__",d=(Ie.prototype.toString=function(){return h.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)},Ie);function Ie(e,t,r,n){this.months=(0,ge.assertNumberOrInteger)(e,"Months"),this.days=(0,ge.assertNumberOrInteger)(t,"Days"),(0,ge.assertNumberOrInteger)(r,"Seconds"),(0,ge.assertNumberOrInteger)(n,"Nanoseconds"),this.seconds=h.normalizeSecondsForDuration(r,n),this.nanoseconds=h.normalizeNanosecondsForDuration(n),Object.freeze(this)}i.Duration=d,Object.defineProperty(d.prototype,Oe,f),i.isDuration=function(e){return De(e,Oe)};Re.fromStandardDate=function(e,t){Me(e,t);t=h.totalNanoseconds(e,t);return new Re(e.getHours(),e.getMinutes(),e.getSeconds(),t instanceof we.default?t.toInt():"bigint"==typeof t?(0,we.int)(t).toInt():t)},Re.prototype.toString=function(){return h.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)};d=Re;function Re(e,t,r,n){this.hour=h.assertValidHour(e),this.minute=h.assertValidMinute(t),this.second=h.assertValidSecond(r),this.nanosecond=h.assertValidNanosecond(n),Object.freeze(this)}i.LocalTime=d,Object.defineProperty(d.prototype,Ee,f),i.isLocalTime=function(e){return De(e,Ee)};ke.fromStandardDate=function(e,t){return Me(e,t),new ke(e.getHours(),e.getMinutes(),e.getSeconds(),(0,we.toNumber)(h.totalNanoseconds(e,t)),h.timeZoneOffsetInSeconds(e))},ke.prototype.toString=function(){return h.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+h.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)};d=ke;function ke(e,t,r,n,o){this.hour=h.assertValidHour(e),this.minute=h.assertValidMinute(t),this.second=h.assertValidSecond(r),this.nanosecond=h.assertValidNanosecond(n),this.timeZoneOffsetSeconds=(0,ge.assertNumberOrInteger)(o,"Time zone offset in seconds"),Object.freeze(this)}i.Time=d,Object.defineProperty(d.prototype,Te,f),i.isTime=function(e){return De(e,Te)};Ne.fromStandardDate=function(e){return Me(e),new Ne(e.getFullYear(),e.getMonth()+1,e.getDate())},Ne.prototype.toStandardDate=function(){return h.isoStringToStandardDate(this.toString())},Ne.prototype.toString=function(){return h.dateToIsoString(this.year,this.month,this.day)};d=Ne;function Ne(e,t,r){this.year=h.assertValidYear(e),this.month=h.assertValidMonth(t),this.day=h.assertValidDay(r),Object.freeze(this)}i.Date=d,Object.defineProperty(d.prototype,Se,f),i.isDate=function(e){return De(e,Se)};je.fromStandardDate=function(e,t){return Me(e,t),new je(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,we.toNumber)(h.totalNanoseconds(e,t)))},je.prototype.toStandardDate=function(){return h.isoStringToStandardDate(this.toString())},je.prototype.toString=function(){return Ue(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)};d=je;function je(e,t,r,n,o,i,s){this.year=h.assertValidYear(e),this.month=h.assertValidMonth(t),this.day=h.assertValidDay(r),this.hour=h.assertValidHour(n),this.minute=h.assertValidMinute(o),this.second=h.assertValidSecond(i),this.nanosecond=h.assertValidNanosecond(s),Object.freeze(this)}i.LocalDateTime=d,Object.defineProperty(d.prototype,Pe,f),i.isLocalDateTime=function(e){return De(e,Pe)};Ae.fromStandardDate=function(e,t){return Me(e,t),new Ae(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,we.toNumber)(h.totalNanoseconds(e,t)),h.timeZoneOffsetInSeconds(e),null)},Ae.prototype.toStandardDate=function(){return h.toStandardDate(this._toUTC())},Ae.prototype.toString=function(){var e;return Ue(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?h.timeZoneOffsetToIsoString(null!=(e=this.timeZoneOffsetSeconds)?e:0):"")+(null!=this.timeZoneId?"[".concat(this.timeZoneId,"]"):"")},Ae.prototype._toUTC=function(){if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var e=h.localDateTimeToEpochSecond(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(null!=(e=this.timeZoneOffsetSeconds)?e:0);return(0,we.int)(e).multiply(1e3).add((0,we.int)(this.nanosecond).div(1e6)).toNumber()};d=Ae;function Ae(e,t,r,n,o,i,s,a,u){this.year=h.assertValidYear(e),this.month=h.assertValidMonth(t),this.day=h.assertValidDay(r),this.hour=h.assertValidHour(n),this.minute=h.assertValidMinute(o),this.second=h.assertValidSecond(i),this.nanosecond=h.assertValidNanosecond(s);e=me(function(e,t){var r=null!=e,n=null!=t&&""!==t;if(!r&&!n)throw(0,ve.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t));var o=[void 0,void 0];r&&((0,ge.assertNumberOrInteger)(e,"Time zone offset in seconds"),o[0]=e);n&&((0,ge.assertString)(t,"Time zone ID"),h.assertValidZoneId("Time zone ID",t),o[1]=t);return o}(a,u),2),t=e[0],r=e[1];this.timeZoneOffsetSeconds=t,this.timeZoneId=null!=r?r:void 0,Object.freeze(this)}function De(e,t){return null!=e&&!0===e[t]}function Ue(e,t,r,n,o,i,s){return h.dateToIsoString(e,t,r)+"T"+h.timeToIsoString(n,o,i,s)}function Me(e,t){(0,ge.assertValidDate)(e,"Standard date"),null!=t&&(0,ge.assertNumberOrInteger)(t,"Nanosecond")}i.DateTime=d,Object.defineProperty(d.prototype,Ce,f),i.isDateTime=function(e){return De(e,Ce)};var d={},Le=(Object.defineProperty(d,"__esModule",{value:!0}),d.isPathSegment=d.PathSegment=d.isPath=d.Path=d.isUnboundRelationship=d.UnboundRelationship=d.isRelationship=d.Relationship=d.isNode=d.Node=void 0,a),f={value:!0,enumerable:!1,configurable:!1,writable:!1},xe="__isNode__",Be="__isRelationship__",Fe="__isUnboundRelationship__",He="__isPath__",qe="__isPathSegment__";function Ve(e,t){return null!=e&&!0===e[t]}ze.prototype.toString=function(){for(var e="("+this.elementId,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var r=Object.keys(this.properties);if(0<r.length){e+=" {";for(t=0;t<r.length;t++)0<t&&(e+=","),e+=r[t]+":"+(0,Le.stringify)(this.properties[r[t]]);e+="}"}return e+=")"};var _=ze;function ze(e,t,r,n){this.identity=e,this.labels=t,this.properties=r,this.elementId=Xe(n,function(){return e.toString()})}d.Node=_,Object.defineProperty(_.prototype,xe,f),d.isNode=function(e){return Ve(e,xe)};Ge.prototype.toString=function(){var e="("+this.startNodeElementId+")-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,Le.stringify)(this.properties[t[r]]);e+="}"}return e+="]->("+this.endNodeElementId+")"};var We=Ge;function Ge(e,t,r,n,o,i,s,a){this.identity=e,this.start=t,this.end=r,this.type=n,this.properties=o,this.elementId=Xe(i,function(){return e.toString()}),this.startNodeElementId=Xe(s,function(){return t.toString()}),this.endNodeElementId=Xe(a,function(){return r.toString()})}d.Relationship=We,Object.defineProperty(We.prototype,Be,f),d.isRelationship=function(e){return Ve(e,Be)};Ke.prototype.bind=function(e,t){return new We(this.identity,e,t,this.type,this.properties,this.elementId)},Ke.prototype.bindTo=function(e,t){return new We(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)},Ke.prototype.toString=function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,Le.stringify)(this.properties[t[r]]);e+="}"}return e+="]->"};_=Ke;function Ke(e,t,r,n){this.identity=e,this.type=t,this.properties=r,this.elementId=Xe(n,function(){return e.toString()})}d.UnboundRelationship=_,Object.defineProperty(_.prototype,Fe,f),d.isUnboundRelationship=function(e){return Ve(e,Fe)};function Ye(e,t,r){this.start=e,this.relationship=t,this.end=r}d.PathSegment=Ye,Object.defineProperty(Ye.prototype,qe,f),d.isPathSegment=function(e){return Ve(e,qe)};function Ze(e,t,r){this.start=e,this.end=t,this.segments=r,this.length=r.length}function Xe(e,t){return null==e?t():e}d.Path=Ze,Object.defineProperty(Ze.prototype,He,f),d.isPath=function(e){return Ve(e,He)};var _={},Qe=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},$e=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Je=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},et=(Object.defineProperty(_,"__esModule",{value:!0}),r);function tt(e,t,r){var n;this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=null!=r?r:(n={},e.forEach(function(e,t){n[e]=t}),n)}tt.prototype.forEach=function(e){var t,r;try{for(var n=$e(this.entries()),o=n.next();!o.done;o=n.next()){var i=Je(o.value,2),s=i[0];e(i[1],s,this)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},tt.prototype.map=function(e){var t,r,n=[];try{for(var o=$e(this.entries()),i=o.next();!i.done;i=o.next()){var s=Je(i.value,2),a=s[0],u=s[1];n.push(e(u,a,this))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},tt.prototype.entries=function(){var t;return Qe(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,[this.keys[t],this._fields[t]]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},tt.prototype.values=function(){var t;return Qe(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},tt.prototype[Symbol.iterator]=function(){var t;return Qe(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},tt.prototype.toObject=function(){var t,e,r={};try{for(var n=$e(this.entries()),o=n.next();!o.done;o=n.next()){var i=Je(o.value,2),s=i[0],a=i[1];r[s]=a}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},tt.prototype.get=function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,et.newError)("This record has no field with key '".concat(e.toString(),"', available keys are: [")+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,et.newError)("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]},tt.prototype.has=function(e){return"number"==typeof e?0<=e&&e<this._fields.length:void 0!==this._fieldLookup[e]},_.default=tt;var f={},rt=(Object.defineProperty(f,"__esModule",{value:!0}),f.isPoint=f.Point=void 0,s),nt="__isPoint__",y=(ot.prototype.toString=function(){return null==this.z||isNaN(this.z)?"Point{srid=".concat(it(this.srid),", x=").concat(it(this.x),", y=").concat(it(this.y),"}"):"Point{srid=".concat(it(this.srid),", x=").concat(it(this.x),", y=").concat(it(this.y),", z=").concat(it(this.z),"}")},ot);function ot(e,t,r,n){this.srid=(0,rt.assertNumberOrInteger)(e,"SRID"),this.x=(0,rt.assertNumber)(t,"X coordinate"),this.y=(0,rt.assertNumber)(r,"Y coordinate"),this.z=null==n?n:(0,rt.assertNumber)(n,"Z coordinate"),Object.freeze(this)}function it(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}f.Point=y,Object.defineProperty(y.prototype,nt,{value:!0,enumerable:!1,configurable:!1,writable:!1}),f.isPoint=function(e){return null!=e&&!0===e[nt]};var y={},st=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),at=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ut=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&st(t,e,r);return at(t,e),t},ct=(Object.defineProperty(y,"__esModule",{value:!0}),y.Stats=y.QueryStatistics=y.ProfiledPlan=y.Plan=y.Notification=y.ServerInfo=y.queryType=void 0,ut(n)),ut=(lt.prototype._buildNotifications=function(e){return null==e?[]:e.map(function(e){return new yt(e)})},lt.prototype.hasPlan=function(){return this.plan instanceof ft},lt.prototype.hasProfile=function(){return this.profile instanceof ht},lt);function lt(e,t,r,n){this.query={text:e,parameters:t},this.queryType=r.type,this.counters=new dt(null!=(e=r.stats)?e:{}),this.updateStatistics=this.counters,this.plan=(null!=r.plan||null!=r.profile)&&new ft(null!=(t=r.plan)?t:r.profile),this.profile=null!=r.profile&&new ht(r.profile),this.notifications=this._buildNotifications(r.notifications),this.server=new mt(r.server,n),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:null!=(e=r.db)?e:null}}var ft=function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]},ht=(y.Plan=ft,pt.prototype.hasPageCacheStats=function(){return 0<this.pageCacheMisses||0<this.pageCacheHits||0<this.pageCacheHitRatio},pt);function pt(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.dbHits=vt("dbHits",e),this.rows=vt("rows",e),this.pageCacheMisses=vt("pageCacheMisses",e),this.pageCacheHits=vt("pageCacheHits",e),this.pageCacheHitRatio=vt("pageCacheHitRatio",e),this.time=vt("time",e),this.children=null!=e.children?e.children.map(function(e){return new pt(e)}):[]}y.ProfiledPlan=ht;y.Stats=function(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0},_t.prototype.containsUpdates=function(){var r=this;return void 0!==this._containsUpdates?this._containsUpdates:0<Object.keys(this._stats).reduce(function(e,t){return e+r._stats[t]},0)},_t.prototype.updates=function(){return this._stats},_t.prototype.containsSystemUpdates=function(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:0<this._systemUpdates},_t.prototype.systemUpdates=function(){return this._systemUpdates};var dt=_t;function _t(r){var n=this;this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(r).forEach(function(e){var t=e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()});t in n._stats?n._stats[t]=gt(r[e]):"systemUpdates"===t?n._systemUpdates=gt(r[e]):"containsSystemUpdates"===t?n._containsSystemUpdates=r[e]:"containsUpdates"===t&&(n._containsUpdates=r[e])}),this._stats=Object.freeze(this._stats)}y.QueryStatistics=dt;bt._constructPosition=function(e){return null==e?{}:{offset:gt(e.offset),line:gt(e.line),column:gt(e.column)}};var yt=bt;function bt(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=bt._constructPosition(e.position)}y.Notification=yt;var mt=function(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t};function gt(e){return e instanceof ct.default?e.toInt():"bigint"==typeof e?(0,ct.int)(e).toInt():e}function vt(e,t,r){return void 0===r&&(r=0),!1!==t&&e in t?gt(t[e]):r}y.ServerInfo=mt;y.queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},y.default=ut;var ut={},b={},m={},g=(Object.defineProperty(m,"__esModule",{value:!0}),m.FailedObserver=m.CompletedObserver=void 0,wt.prototype.subscribe=function(e){Et(e,e.onKeys,[]),Et(e,e.onCompleted,{})},wt.prototype.cancel=function(){},wt.prototype.pause=function(){},wt.prototype.resume=function(){},wt.prototype.prepareToHandleSingleResponse=function(){},wt.prototype.markCompleted=function(){},wt.prototype.onError=function(e){throw Error("CompletedObserver not supposed to call onError")},wt);function wt(){}function Ot(e){var t=e.error,e=e.onError;this._error=t,this._beforeError=e,this._observers=[],this.onError(t)}function Et(e,t,r){null!=t&&t.bind(e)(r)}m.CompletedObserver=g,Ot.prototype.subscribe=function(e){Et(e,e.onError,this._error),this._observers.push(e)},Ot.prototype.onError=function(t){Et(this,this._beforeError,t),this._observers.forEach(function(e){return Et(e,e.onError,t)})},Ot.prototype.cancel=function(){},Ot.prototype.pause=function(){},Ot.prototype.resume=function(){},Ot.prototype.markCompleted=function(){},Ot.prototype.prepareToHandleSingleResponse=function(){},m.FailedObserver=Ot;var g={},Tt=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),St=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Tt(t,e,r);return St(t,e),t},Pt=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},Ct=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},It=(Object.defineProperty(g,"__esModule",{value:!0}),g.Bookmarks=void 0,v(s)),v=(Rt.empty=function(){return kt},Rt.prototype.isEmpty=function(){return 0===this._values.length},Rt.prototype.values=function(){return this._values},Rt.prototype[Symbol.iterator]=function(){return this._values[Symbol.iterator]()},Rt.prototype.asBeginTransactionParameters=function(){var e;return this.isEmpty()?{}:((e={}).bookmarks=this._values,e)},Rt);function Rt(e){this._values=function(e){if(null==e||""===e)return[];if(It.isString(e))return[e];if(Array.isArray(e)){for(var t=new Set,r=function r(e){return e.reduce(function(e,t){return Array.isArray(t)?e.concat(r(t)):e.concat(t)},[])}(e),n=0;n<r.length;n++){var o=r[n];if(null!=o){if(!It.isString(o))throw new TypeError("Bookmark value should be a string, given: '".concat(o,"'"));t.add(o)}}return Ct([],Pt(t),!1)}throw new TypeError("Bookmarks should either be a string or a string array, given: '".concat(e,"'"))}(e)}var kt=new(g.Bookmarks=v)(null);var Nt,v={},w=(Object.defineProperty(v,"__esModule",{value:!0}),v.BOLT_PROTOCOL_V5_0=v.BOLT_PROTOCOL_V4_4=v.BOLT_PROTOCOL_V4_3=v.BOLT_PROTOCOL_V4_2=v.BOLT_PROTOCOL_V4_1=v.BOLT_PROTOCOL_V4_0=v.BOLT_PROTOCOL_V3=v.BOLT_PROTOCOL_V2=v.BOLT_PROTOCOL_V1=v.DEFAULT_POOL_MAX_SIZE=v.DEFAULT_POOL_ACQUISITION_TIMEOUT=v.DEFAULT_CONNECTION_TIMEOUT_MILLIS=v.ACCESS_MODE_WRITE=v.ACCESS_MODE_READ=v.FETCH_ALL=void 0,v.FETCH_ALL=-1,v.DEFAULT_POOL_ACQUISITION_TIMEOUT=6e4,v.DEFAULT_POOL_MAX_SIZE=100,v.DEFAULT_CONNECTION_TIMEOUT_MILLIS=3e4,v.ACCESS_MODE_READ="READ",v.ACCESS_MODE_WRITE="WRITE",v.BOLT_PROTOCOL_V1=1,v.BOLT_PROTOCOL_V2=2,v.BOLT_PROTOCOL_V3=3,v.BOLT_PROTOCOL_V4_0=4,v.BOLT_PROTOCOL_V4_1=4.1,v.BOLT_PROTOCOL_V4_2=4.2,v.BOLT_PROTOCOL_V4_3=4.3,v.BOLT_PROTOCOL_V4_4=4.4,v.BOLT_PROTOCOL_V5_0=5,{}),O=e&&e.__extends||(Nt=function(e,t){return(Nt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Nt(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),jt=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},At=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Dt=(Object.defineProperty(w,"__esModule",{value:!0}),w.EMPTY_CONNECTION_HOLDER=w.ReadOnlyConnectionHolder=w.ConnectionHolder=void 0,r),Ut=s,Mt=v,Lt=g,xt=(Bt.prototype.mode=function(){return this._mode},Bt.prototype.database=function(){return this._database},Bt.prototype.setDatabase=function(e){this._database=e},Bt.prototype.bookmarks=function(){return this._bookmarks},Bt.prototype.connectionProvider=function(){return this._connectionProvider},Bt.prototype.referenceCount=function(){return this._referenceCount},Bt.prototype.initializeConnection=function(){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider),this._referenceCount++,!0)},Bt.prototype._createConnectionPromise=function(o){return jt(this,void 0,void 0,function(){var t,r,n;return At(this,function(e){switch(e.label){case 0:return r=(t=o).acquireConnection,n={accessMode:this._mode,database:this._database},[4,this._getBookmarks()];case 1:return[4,r.apply(t,[(n.bookmarks=e.sent(),n.impersonatedUser=this._impersonatedUser,n.onDatabaseNameResolved=this._onDatabaseNameResolved,n)])];case 2:return[2,e.sent()]}})})},Bt.prototype._getBookmarks=function(){return jt(this,void 0,void 0,function(){return At(this,function(e){switch(e.label){case 0:return[4,this._getConnectionAcquistionBookmarks()];case 1:return[2,e.sent()]}})})},Bt.prototype.getConnection=function(){return this._connectionPromise},Bt.prototype.releaseConnection=function(){return 0!==this._referenceCount&&(this._referenceCount--,0===this._referenceCount)?this._releaseConnection():this._connectionPromise},Bt.prototype.close=function(e){return 0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))},Bt.prototype._releaseConnection=function(t){return this._connectionPromise=this._connectionPromise.then(function(e){return null!=e?e.isOpen()&&(e.hasOngoingObservableRequests()||!0===t)?e.resetAndFlush().catch(zt).then(function(){return e._release().then(function(){return null})}):e._release().then(function(){return null}):Promise.resolve(null)}).catch(zt),this._connectionPromise},Bt);function Bt(e){var e=void 0===e?{}:e,t=e.mode,t=void 0===t?Mt.ACCESS_MODE_WRITE:t,r=e.database,r=void 0===r?"":r,n=e.bookmarks,o=e.connectionProvider,i=e.impersonatedUser,s=e.onDatabaseNameResolved,e=e.getConnectionAcquistionBookmarks;this._mode=t,this._database=null!=r?(0,Ut.assertString)(r,"database"):"",this._bookmarks=null!=n?n:Lt.Bookmarks.empty(),this._connectionProvider=o,this._impersonatedUser=i,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=s,this._getConnectionAcquistionBookmarks=null!=e?e:function(){return Promise.resolve(Lt.Bookmarks.empty())}}w.ConnectionHolder=xt;O(qt,Ft=xt),qt.prototype.initializeConnection=function(){return 0!==this._connectionHolder.referenceCount()},qt.prototype.getConnection=function(){return this._connectionHolder.getConnection()},qt.prototype.releaseConnection=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},qt.prototype.close=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})};var Ft,Ht,E=qt;function qt(e){var t=Ft.call(this,{mode:e.mode(),database:e.database(),bookmarks:e.bookmarks(),getConnectionAcquistionBookmarks:e._getConnectionAcquistionBookmarks,connectionProvider:e.connectionProvider()})||this;return t._connectionHolder=e,t}function Vt(){return null!==Ht&&Ht.apply(this,arguments)||this}w.ReadOnlyConnectionHolder=E,w.default=E,O(Vt,Ht=xt),Vt.prototype.mode=function(){},Vt.prototype.database=function(){},Vt.prototype.initializeConnection=function(){return!0},Vt.prototype.getConnection=function(){return jt(this,void 0,void 0,function(){return At(this,function(e){switch(e.label){case 0:return[4,Promise.reject((0,Dt.newError)("This connection holder does not serve connections"))];case 1:return[2,e.sent()]}})})},Vt.prototype.releaseConnection=function(){return jt(this,void 0,void 0,function(){return At(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},Vt.prototype.close=function(){return jt(this,void 0,void 0,function(){return At(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})};E=new Vt;function zt(e){return null}w.EMPTY_CONNECTION_HOLDER=E;var O={},Wt=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Gt=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),xt=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Wt(t,e,r);return Gt(t,e),t},Kt=(Object.defineProperty(O,"__esModule",{value:!0}),O.TxConfig=void 0,xt(s)),Yt=r,Zt=n,E=(Xt.empty=function(){return Qt},Xt.prototype.isEmpty=function(){return Object.values(this).every(function(e){return null==e})},Xt);function Xt(e){var t;null!=(t=e)&&Kt.assertObject(t,"Transaction config"),this.timeout=function(e){if(Kt.isObject(e)&&null!=e.timeout){Kt.assertNumberOrInteger(e.timeout,"Transaction timeout");e=(0,Zt.int)(e.timeout);if(e.isNegative())throw(0,Yt.newError)("Transaction timeout should not be negative");return e}return null}(e),this.metadata=function(e){if(Kt.isObject(e)&&null!=e.metadata){e=e.metadata;if(Kt.assertObject(e,"config.metadata"),0!==Object.keys(e).length)return e}return null}(e)}var Qt=new(O.TxConfig=E)({});var xt={},$t=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Jt=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},er=(Object.defineProperty(xt,"__esModule",{value:!0}),xt.TransactionExecutor=void 0,r);function tr(e,t,r,n){this._maxRetryTimeMs=rr(e,3e4),this._initialRetryDelayMs=rr(t,1e3),this._multiplier=rr(r,2),this._jitterFactor=rr(n,.2),this._inFlightTimeoutIds=[],this._verifyAfterConstruction()}function rr(e,t){return null!=e?e:t}tr.prototype.execute=function(n,o,i){var s=this;return new Promise(function(e,t){s._executeTransactionInsidePromise(n,o,e,t,i).catch(t)}).catch(function(e){var t=Date.now(),r=s._initialRetryDelayMs;return s._retryTransactionPromise(n,o,e,t,r,i)})},tr.prototype.close=function(){this._inFlightTimeoutIds.forEach(function(e){return clearTimeout(e)}),this._inFlightTimeoutIds=[]},tr.prototype._retryTransactionPromise=function(o,i,e,r,s,a){var u=this;return Date.now()-r>this._maxRetryTimeMs||!(0,er.isRetriableError)(e)?Promise.reject(e):new Promise(function(e,t){var r=u._computeDelayWithJitter(s),n=setTimeout(function(){u._inFlightTimeoutIds=u._inFlightTimeoutIds.filter(function(e){return e!==n}),u._executeTransactionInsidePromise(o,i,e,t,a).catch(t)},r);u._inFlightTimeoutIds.push(n)}).catch(function(e){var t=s*u._multiplier;return u._retryTransactionPromise(o,i,e,r,t,a)})},tr.prototype._executeTransactionInsidePromise=function(o,i,s,a,u){return $t(this,void 0,void 0,function(){var t,r,n=this;return Jt(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,o()];case 1:return t=e.sent(),[3,3];case 2:return r=e.sent(),a(r),[2];case 3:return r=(null!=u?u:function(e){return e})(t),this._safeExecuteTransactionWork(r,i).then(function(e){return n._handleTransactionWorkSuccess(e,t,s,a)}).catch(function(e){return n._handleTransactionWorkFailure(e,t,a)}),[2]}})})},tr.prototype._safeExecuteTransactionWork=function(e,t){try{var r=t(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}},tr.prototype._handleTransactionWorkSuccess=function(e,t,r,n){t.isOpen()?t.commit().then(function(){r(e)}).catch(function(e){n(e)}):r(e)},tr.prototype._handleTransactionWorkFailure=function(e,t,r){t.isOpen()?t.rollback().catch(function(e){}).then(function(){return r(e)}).catch(r):r(e)},tr.prototype._computeDelayWithJitter=function(e){var t=e*this._jitterFactor,r=e-t,e=e+t;return Math.random()*(e-r)+r},tr.prototype._verifyAfterConstruction=function(){if(this._maxRetryTimeMs<0)throw(0,er.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw(0,er.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw(0,er.newError)("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||1<this._jitterFactor)throw(0,er.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())},xt.TransactionExecutor=tr;var nr,or,E={},T=e&&e.__extends||(nr=function(e,t){return(nr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}nr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ir=(Object.defineProperty(E,"__esModule",{value:!0}),E.Logger=void 0,r),sr="error",ar="warn",ur="info",cr="debug",lr=((S={})[sr]=0,S[ar]=1,S[ur]=2,S[cr]=3,S),S=(fr.create=function(e){return null!=(null==e?void 0:e.logging)?new fr(function(e){if(null==(null==e?void 0:e.level))return"info";var e=e.level,t=lr[e];if(null!=t||0===t)return e;throw(0,ir.newError)("Illegal logging level: ".concat(e,". Supported levels are: ").concat(Object.keys(lr).toString()))}(e=e.logging),function(e){if(null!=(null==e?void 0:e.logger)){var t=e.logger;if(null!=t&&"function"==typeof t)return t}throw(0,ir.newError)("Illegal logger function: ".concat(null!=(e=null==(t=null==e?void 0:e.logger)?void 0:t.toString())?e:"undefined"))}(e)):this.noOp()},fr.noOp=function(){return pr},fr.prototype.isErrorEnabled=function(){return dr(this._level,sr)},fr.prototype.error=function(e){this.isErrorEnabled()&&this._loggerFunction(sr,e)},fr.prototype.isWarnEnabled=function(){return dr(this._level,ar)},fr.prototype.warn=function(e){this.isWarnEnabled()&&this._loggerFunction(ar,e)},fr.prototype.isInfoEnabled=function(){return dr(this._level,ur)},fr.prototype.info=function(e){this.isInfoEnabled()&&this._loggerFunction(ur,e)},fr.prototype.isDebugEnabled=function(){return dr(this._level,cr)},fr.prototype.debug=function(e){this.isDebugEnabled()&&this._loggerFunction(cr,e)},fr);function fr(e,t){this._level=e,this._loggerFunction=t}function hr(){return or.call(this,ur,function(e,t){})||this}E.Logger=S,T(hr,or=S),hr.prototype.isErrorEnabled=function(){return!1},hr.prototype.error=function(e){},hr.prototype.isWarnEnabled=function(){return!1},hr.prototype.warn=function(e){},hr.prototype.isInfoEnabled=function(){return!1},hr.prototype.info=function(e){},hr.prototype.isDebugEnabled=function(){return!1},hr.prototype.debug=function(e){};var pr=new hr;function dr(e,t){return lr[t]<=lr[e]}var T={},_r=e&&e.__assign||function(){return(_r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},yr=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},br=(Object.defineProperty(T,"__esModule",{value:!0}),T.Url=T.formatIPv6Address=T.formatIPv4Address=T.defaultPortForScheme=T.parseDatabaseUrl=void 0,s),mr=7687,gr=7474,vr=7473,wr=function(e,t,r,n,o){this.scheme=e,this.host=t,this.port=r,this.hostAndPort=n,this.query=o};function Or(e,t,r){if(""===(e=(null!=e?e:"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(r,"'"));return e}function Er(e){var t="["===e.charAt(0),r="]"===e.charAt(e.length-1);if(t||r){if(t&&r)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function Tr(e){return"http"===e?gr:"https"===e?vr:mr}T.Url=wr,T.parseDatabaseUrl=function(e){(0,br.assertString)(e,"URL");var t=function(e){function s(e,t){t=e.indexOf(t);return 0<=t?[e.substring(0,t),e[t],e.substring(t+1)]:[e,"",""]}function t(e){var t,r={},n=((t="@")===(t=0<=(t=(o=e).lastIndexOf(t))?[o.substring(0,t),o[t],o.substring(t+1)]:["","",o])[1]&&(r.userInfo=decodeURIComponent(t[0]),e=t[2]),yr((o="]",n=s(n=e,i="["),[(i=s(n[2],o))[0],i[2]]),2)),o=n[0],i=n[1];return""!==o?(r.host=o,t=s(i,":")):(t=s(e,":"),r.host=t[0]),":"===t[1]&&(r.port=t[2]),r}var r,n={};":"===(r=s(e,":"))[1]&&(n.scheme=decodeURIComponent(r[0]),e=r[2]);"#"===(r=s(e,"#"))[1]&&(n.fragment=decodeURIComponent(r[2]),e=r[0]);"?"===(r=s(e,"?"))[1]&&(n.query=r[2],e=r[0]);e.startsWith("//")?(r=s(e.substr(2),"/"),(n=_r(_r({},n),t(r[0]))).path=r[1]+r[2]):n.path=e;return n}((r=(r=(r=e).trim()).includes("://")?{schemeMissing:!1,url:r}:{schemeMissing:!0,url:"none://".concat(r)}).url),r=r.schemeMissing?null:function(e){if(null==e)return null;":"===(e=e.trim()).charAt(e.length-1)&&(e=e.substring(0,e.length-1));return e}(t.scheme),n=function(e){if(null!=e)return e.trim();throw new Error("Unable to extract host from null or undefined URL")}(t.host),o=function(e){if(""===e||null==e)throw new Error("Illegal host ".concat(e));return e.includes(":")?Er(e):e}(n),i=function(e,t){e="string"==typeof e?parseInt(e,10):e;return null==e||isNaN(e)?Tr(t):e}(t.port,r),o="".concat(o,":").concat(i),s=function(e,r){var e=null!=e?function(e){"?"===(null==(e=(null!=e?e:"").trim())?void 0:e.charAt(0))&&(e=e.substring(1,e.length));return e}(e):null,n={};null!=e&&e.split("&").forEach(function(e){e=e.split("=");if(2!==e.length)throw new Error("Invalid parameters: '".concat(e.toString(),"' in URL '").concat(r,"'."));var t=Or(e[0],"key",r),e=Or(e[1],"value",r);if(void 0!==n[t])throw new Error("Duplicated query parameters with key '".concat(t,"' in URL '").concat(r,"'"));n[t]=e});return n}(null!=(s=t.query)?s:function(e){if("string"!=typeof e)return null;return yr(e.split("?"),2)[1]}(t.resourceName),e);return new wr(r,n,i,o,s)},T.formatIPv4Address=function(e,t){return"".concat(e,":").concat(t)},T.formatIPv6Address=function(e,t){return e=Er(e),"".concat(e,":").concat(t)},T.defaultPortForScheme=Tr;var S={},Sr=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Pr=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Cr=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Sr(t,e,r);return Pr(t,e),t},Ir=(Object.defineProperty(S,"__esModule",{value:!0}),S.ServerAddress=void 0,s),Rr=Cr(T);function kr(e,t,r,n){this._host=(0,Ir.assertString)(e,"host"),this._resolved=null!=t?(0,Ir.assertString)(t,"resolved"):null,this._port=(0,Ir.assertNumber)(r,"port"),this._hostPort=n,this._stringValue=null!=t?"".concat(n,"(").concat(t,")"):"".concat(n)}kr.prototype.host=function(){return this._host},kr.prototype.resolvedHost=function(){return null!=this._resolved?this._resolved:this._host},kr.prototype.port=function(){return this._port},kr.prototype.resolveWith=function(e){return new kr(this._host,e,this._port,this._hostPort)},kr.prototype.asHostPort=function(){return this._hostPort},kr.prototype.asKey=function(){return this._hostPort},kr.prototype.toString=function(){return this._stringValue},kr.fromUrl=function(e){e=Rr.parseDatabaseUrl(e);return new kr(e.host,null,e.port,e.hostAndPort)},S.ServerAddress=kr;var Cr={},P={};function Nr(){}Object.defineProperty(P,"__esModule",{value:!0}),Nr.prototype.resolve=function(){throw new Error("Abstract function")},Nr.prototype._resolveToItself=function(e){return Promise.resolve([e])},P.default=Nr;var C={},jr=(Object.defineProperty(C,"__esModule",{value:!0}),S);function Ar(e){return Promise.resolve([e])}function Dr(e){this._resolverFunction=null!=e?e:Ar}Dr.prototype.resolve=function(t){var r=this;return new Promise(function(e){return e(r._resolverFunction(t.asHostPort()))}).then(function(e){if(Array.isArray(e))return e.map(function(e){return jr.ServerAddress.fromUrl(e)});throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e))})},C.default=Dr;function Ur(e){console.log("Uncaught error when processing result: "+e)}function Mr(e){}function Lr(e){}var I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},P=(Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.ConfiguredCustomResolver=Cr.BaseHostNameResolver=void 0,I(P)),P=(Cr.BaseHostNameResolver=P.default,I(C)),xr=(Cr.ConfiguredCustomResolver=P.default,e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]})),Br=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),I=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&xr(t,e,r);return Br(t,e),t},P=(Object.defineProperty(b,"__esModule",{value:!0}),b.objectUtil=b.resolver=b.serverAddress=b.urlUtil=b.logger=b.transactionExecutor=b.txConfig=b.connectionHolder=b.constants=b.bookmarks=b.observer=b.temporalUtil=b.util=void 0,I(s)),P=(b.util=P,I(o)),o=(b.temporalUtil=P,I(m)),P=(b.observer=o,I(g)),o=(b.bookmarks=P,I(v)),P=(b.constants=o,I(w)),o=(b.connectionHolder=P,I(O)),P=(b.txConfig=o,I(xt)),o=(b.transactionExecutor=P,I(E)),P=(b.logger=o,I(T)),o=(b.urlUtil=P,I(S)),T=(b.serverAddress=o,I(Cr)),P=(b.resolver=T,I(u)),Fr=(b.objectUtil=P,e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})}),Hr=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},S=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},qr=(Object.defineProperty(ut,"__esModule",{value:!0}),S(y)),Vr=b,zr=r,Wr=Vr.connectionHolder.EMPTY_CONNECTION_HOLDER;function Gr(e,t,r,n,o){var i;void 0===o&&(o={high:Number.MAX_VALUE,low:Number.MAX_VALUE}),this._stack=null==(i=new Error("")).stack?null:i.stack.replace(/^Error(\n\r)*/,""),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=null!=r?r:{},this._connectionHolder=null!=n?n:Wr,this._keys=null,this._summary=null,this._error=null,this._watermarks=o}Gr.prototype.keys=function(){var n=this;return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){return e.subscribe(n._decorateObserver({onKeys:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},Gr.prototype.summary=function(){var n=this;return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){n._streamObserverPromise.then(function(e){e.cancel(),e.subscribe(n._decorateObserver({onCompleted:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},Gr.prototype._getOrCreatePromise=function(){var e=this;return null==this._p&&(this._p=new Promise(function(t,r){var n=[];e.subscribe({onNext:function(e){n.push(e)},onCompleted:function(e){t({records:n,summary:e})},onError:function(e){r(e)}})})),this._p},Gr.prototype[Symbol.asyncIterator]=function(){var e,n,r,o,i,s=this;return this.isOpen()?(n={paused:!0,firstRun:!0,finished:!1},r=function(){var e,t;null!=n.streaming&&(e=(t=null!=(t=null==(t=n.queuedObserver)?void 0:t.size)?t:0)>=s._watermarks.high,t=t<=s._watermarks.low,e&&!n.paused?(n.paused=!0,n.streaming.pause()):(t&&n.paused||n.firstRun&&!e)&&(n.firstRun=!1,n.paused=!1,n.streaming.resume()))},o=function(){return Fr(s,void 0,void 0,function(){var t;return Hr(this,function(e){switch(e.label){case 0:return void 0!==n.queuedObserver?[3,2]:(n.queuedObserver=this._createQueuedResultObserver(r),t=n,[4,this._subscribe(n.queuedObserver,!0).catch(function(){})]);case 1:t.streaming=e.sent(),r(),e.label=2;case 2:return[2,n.queuedObserver]}})})},i=function(e){if(void 0===e)throw(0,zr.newError)("InvalidState: Result stream finished without Summary",zr.PROTOCOL_ERROR);return!0},{next:function(){return Fr(s,void 0,void 0,function(){var t;return Hr(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:n.summary}]:[4,o()];case 1:return[4,e.sent().dequeue()];case 2:return!0===(t=e.sent()).done&&(n.finished=t.done,n.summary=t.value),[2,t]}})})},return:function(r){return Fr(s,void 0,void 0,function(){var t;return Hr(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:null!=r?r:n.summary}]:(null!=(t=n.streaming)&&t.cancel(),[4,o()]);case 1:return[4,e.sent().dequeueUntilDone()];case 2:return t=e.sent(),n.finished=!0,t.value=null!=r?r:t.value,n.summary=t.value,[2,t]}})})},peek:function(){return Fr(s,void 0,void 0,function(){return Hr(this,function(e){switch(e.label){case 0:return n.finished&&i(n.summary)?[2,{done:!0,value:n.summary}]:[4,o()];case 1:return[4,e.sent().head()];case 2:return[2,e.sent()]}})})}}):(e=(0,zr.newError)("Result is already consumed"),{next:function(){return Promise.reject(e)},peek:function(){return Promise.reject(e)}})},Gr.prototype.then=function(e,t){return this._getOrCreatePromise().then(e,t)},Gr.prototype.catch=function(e){return this._getOrCreatePromise().catch(e)},Gr.prototype.finally=function(e){return this._getOrCreatePromise().finally(e)},Gr.prototype.subscribe=function(e){this._subscribe(e).catch(function(){})},Gr.prototype.isOpen=function(){return null===this._summary&&null===this._error},Gr.prototype._subscribe=function(e,t){void 0===t&&(t=!1);var r=this._decorateObserver(e);return this._streamObserverPromise.then(function(e){return t&&e.pause(),e.subscribe(r),e}).catch(function(e){return null!=r.onError&&r.onError(e),Promise.reject(e)})},Gr.prototype._decorateObserver=function(n){var e,o=this,t=null!=(e=n.onCompleted)?e:Mr,i=null!=(e=n.onError)?e:Ur,r=null!=(e=n.onKeys)?e:Lr;return{onNext:null!=n.onNext?n.onNext.bind(n):void 0,onKeys:function(e){return o._keys=e,r.call(n,e)},onCompleted:function(e){o._releaseConnectionAndGetSummary(e).then(function(e){return null!==o._summary?t.call(n,o._summary):(o._summary=e,t.call(n,e))}).catch(i)},onError:function(r){o._connectionHolder.releaseConnection().then(function(){var e,t;e=r,null!=(t=o._stack)&&(e.stack=e.toString()+"\n"+t),o._error=r,i.call(n,r)}).catch(i)}}},Gr.prototype._cancel=function(){null===this._summary&&null===this._error&&this._streamObserverPromise.then(function(e){return e.cancel()}).catch(function(){})},Gr.prototype._releaseConnectionAndGetSummary=function(t){var e=Vr.util.validateQueryAndParameters(this._query,this._parameters,{skipAsserts:!0}),r=e.validatedQuery,n=e.params,o=this._connectionHolder;return o.getConnection().then(function(t){return o.releaseConnection().then(function(){var e;return null==(e=null==t?void 0:t.protocol())?void 0:e.version})},function(e){}).then(function(e){return new qr.default(r,n,t,e)})},Gr.prototype._createQueuedResultObserver=function(n){var e=this;function o(){var r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r}function i(e){return e instanceof Error}function r(){var r;return Fr(this,void 0,void 0,function(){var t;return Hr(this,function(e){switch(e.label){case 0:if(0<s.length){if(t=null!=(r=s.shift())?r:(0,zr.newError)("Unexpected empty buffer",zr.PROTOCOL_ERROR),n(),i(t))throw t;return[2,t]}return a.resolvable=o(),[4,a.resolvable.promise];case 1:return[2,e.sent()]}})})}var s=[],a={resolvable:null},t={onNext:function(e){t._push({done:!1,value:e})},onCompleted:function(e){t._push({done:!0,value:e})},onError:function(e){t._push(e)},_push:function(e){var t;null!==a.resolvable?(t=a.resolvable,a.resolvable=null,i(e)?t.reject(e):t.resolve(e)):(s.push(e),n())},dequeue:r,dequeueUntilDone:function(){return Fr(e,void 0,void 0,function(){var t;return Hr(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return!0===(t=e.sent()).done?[2,t]:[3,0];case 2:return[2]}})})},head:function(){return Fr(e,void 0,void 0,function(){var t,r;return Hr(this,function(e){switch(e.label){case 0:if(0<s.length){if(i(t=s[0]))throw t;return[2,t]}a.resolvable=o(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,a.resolvable.promise];case 2:return t=e.sent(),s.unshift(t),[2,t];case 3:throw r=e.sent(),s.unshift(r),r;case 4:return n(),[7];case 5:return[2]}})})},get size(){return s.length}};return t},ut.default=Gr;o={};function Kr(){}Object.defineProperty(o,"__esModule",{value:!0}),Kr.prototype.acquireConnection=function(e){throw Error("Not implemented")},Kr.prototype.supportsMultiDb=function(){throw Error("Not implemented")},Kr.prototype.supportsTransactionConfig=function(){throw Error("Not implemented")},Kr.prototype.supportsUserImpersonation=function(){throw Error("Not implemented")},Kr.prototype.verifyConnectivityAndGetServerInfo=function(e){throw Error("Not implemented")},Kr.prototype.getNegotiatedProtocolVersion=function(){throw Error("Not Implemented")},Kr.prototype.close=function(){throw Error("Not implemented")},o.default=Kr;Cr={};function Yr(){}Object.defineProperty(Cr,"__esModule",{value:!0}),Object.defineProperty(Yr.prototype,"id",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(Yr.prototype,"databaseId",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(Yr.prototype,"server",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(Yr.prototype,"address",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(Yr.prototype,"version",{get:function(){},enumerable:!1,configurable:!0}),Yr.prototype.isOpen=function(){return!1},Yr.prototype.protocol=function(){throw Error("Not implemented")},Yr.prototype.connect=function(e,t){throw Error("Not implemented")},Yr.prototype.write=function(e,t,r){throw Error("Not implemented")},Yr.prototype.resetAndFlush=function(){throw Error("Not implemented")},Yr.prototype.hasOngoingObservableRequests=function(){throw Error("Not implemented")},Yr.prototype.close=function(){throw Error("Not implemented")},Yr.prototype._release=function(){return Promise.resolve()},Cr.default=Yr;var T={},Zr=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Xr=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Qr=(Object.defineProperty(T,"__esModule",{value:!0}),s),$r=w,Jr=g,en=O,tn=m,rn=r,nn=I(ut);function on(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,s=e.fetchSize,a=e.impersonatedUser,u=e.highRecordWatermark,e=e.lowRecordWatermark,c=this;this._connectionHolder=t,this._reactive=i,this._state=sn.ACTIVE,this._onClose=r,this._onBookmarks=n,this._onConnection=o,this._onError=this._onErrorCallback.bind(this),this._fetchSize=s,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=a,this._lowRecordWatermak=e,this._highRecordWatermark=u,this._bookmarks=Jr.Bookmarks.empty(),this._acceptActive=function(){},this._activePromise=new Promise(function(e,t){c._acceptActive=e})}on.prototype._begin=function(o,i,s){var t=this;this._connectionHolder.getConnection().then(function(n){return Zr(t,void 0,void 0,function(){var t,r=this;return Xr(this,function(e){switch(e.label){case 0:return(this._onConnection(),null==n)?[3,2]:(t=this,[4,o()]);case 1:return t._bookmarks=e.sent(),[2,n.protocol().beginTransaction({bookmarks:this._bookmarks,txConfig:i,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,beforeError:function(e){return null!=s&&s.onError(e),r._onError(e)},afterComplete:function(e){return null!=s&&s.onComplete(e),r._onComplete(e)}})];case 2:throw(0,rn.newError)("No connection available")}})})}).catch(function(e){null!=s&&s.onError(e),t._onError(e).catch(function(){})}).finally(function(){return t._acceptActive()})},on.prototype.run=function(e,t){e=(0,Qr.validateQueryAndParameters)(e,t),t=e.validatedQuery,e=e.params,t=this._state.run(t,e,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(t),t},on.prototype.commit=function(){var t=this,r=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:function(e){return t._onCompleteCallback(e,t._bookmarks)},onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},on.prototype.rollback=function(){var r=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},on.prototype.isOpen=function(){return this._state===sn.ACTIVE},on.prototype.close=function(){return Zr(this,void 0,void 0,function(){return Xr(this,function(e){switch(e.label){case 0:return this.isOpen()?[4,this.rollback()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},on.prototype._onErrorCallback=function(){return this._state=sn.FAILED,this._onClose(),this._connectionHolder.releaseConnection()},on.prototype._onCompleteCallback=function(e,t){this._onBookmarks(new Jr.Bookmarks(null==e?void 0:e.bookmark),null!=t?t:Jr.Bookmarks.empty(),null==e?void 0:e.db)};var sn={ACTIVE:{commit:function(e){return{result:an(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:sn.SUCCEEDED}},rollback:function(e){return{result:an(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:sn.ROLLED_BACK}},run:function(t,r,e){var n=e.connectionHolder,o=e.onError,i=e.onComplete,s=e.onConnection,a=e.reactive,u=e.fetchSize,c=e.highRecordWatermark,l=e.lowRecordWatermark,e=e.preparationJob,f=null!=e?e:Promise.resolve();return un(n.getConnection().then(function(e){return f.then(function(){return e})}).then(function(e){if(s(),null!=e)return e.protocol().run(t,r,{bookmarks:Jr.Bookmarks.empty(),txConfig:en.TxConfig.empty(),beforeError:o,afterComplete:i,reactive:a,fetchSize:u,highRecordWatermark:c,lowRecordWatermark:l});throw(0,rn.newError)("No connection available")}).catch(function(e){return new tn.FailedObserver({error:e,onError:o})}),t,r,n,c,l)}},FAILED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:un(new tn.FailedObserver({error:(0,rn.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:r}),"COMMIT",{},t,0,0),state:sn.FAILED}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:un(new tn.CompletedObserver,"ROLLBACK",{},t,0,0),state:sn.FAILED}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,un(new tn.FailedObserver({error:(0,rn.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:o}),e,t,n,0,0)}},SUCCEEDED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:un(new tn.FailedObserver({error:(0,rn.newError)("Cannot commit this transaction, because it has already been committed."),onError:r}),"COMMIT",{},$r.EMPTY_CONNECTION_HOLDER,0,0),state:sn.SUCCEEDED,connectionHolder:t}},rollback:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:un(new tn.FailedObserver({error:(0,rn.newError)("Cannot rollback this transaction, because it has already been committed."),onError:r}),"ROLLBACK",{},$r.EMPTY_CONNECTION_HOLDER,0,0),state:sn.SUCCEEDED,connectionHolder:t}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,un(new tn.FailedObserver({error:(0,rn.newError)("Cannot run query in this transaction, because it has already been committed."),onError:o}),e,t,n,0,0)}},ROLLED_BACK:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:un(new tn.FailedObserver({error:(0,rn.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:r}),"COMMIT",{},t,0,0),state:sn.ROLLED_BACK}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:un(new tn.FailedObserver({error:(0,rn.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},t,0,0),state:sn.ROLLED_BACK}},run:function(e,t,r){var n=r.connectionHolder,o=r.onError;return r.onComplete,un(new tn.FailedObserver({error:(0,rn.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:o}),e,t,n,0,0)}}};function an(r,e,n,o,i,s,t){var a=null!=t?t:Promise.resolve(),t=e.getConnection().then(function(e){return a.then(function(){return e})}).then(function(t){return i(),s.forEach(function(e){return e._cancel()}),Promise.all(s.map(function(e){return e.summary()})).then(function(e){if(null!=t)return r?t.protocol().commitTransaction({beforeError:n,afterComplete:o}):t.protocol().rollbackTransaction({beforeError:n,afterComplete:o});throw(0,rn.newError)("No connection available")})}).catch(function(e){return new tn.FailedObserver({error:e,onError:n})});return new nn.default(t,r?"COMMIT":"ROLLBACK",{},e,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function un(e,t,r,n,o,i){return void 0===n&&(n=$r.EMPTY_CONNECTION_HOLDER),new nn.default(Promise.resolve(e),t,r,new $r.ReadOnlyConnectionHolder(null!=n?n:$r.EMPTY_CONNECTION_HOLDER),{low:i,high:o})}T.default=on;u={};function cn(e){e=e.run;this._run=e}Object.defineProperty(u,"__esModule",{value:!0}),cn.fromTransaction=function(e){return new cn({run:e.run.bind(e)})},cn.prototype.run=function(e,t){return this._run(e,t)},u.default=cn;var ln,fn,hn,P={},S=e&&e.__extends||(ln=function(e,t){return(ln=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ln(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),pn=e&&e.__assign||function(){return(pn=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},I=(Object.defineProperty(P,"__esModule",{value:!0}),I(T)),I=(hn=I.default,S(dn,hn),dn.prototype.then=function(e,t){return this._getOrCreateBeginPromise().then(e,t)},dn.prototype.catch=function(e){return this._getOrCreateBeginPromise().catch(e)},dn.prototype.finally=function(e){return this._getOrCreateBeginPromise().finally(e)},dn.prototype._getOrCreateBeginPromise=function(){var r=this;return null==this._beginPromise&&(this._beginPromise=new Promise(function(e,t){r._resolve=e,r._reject=t,null!=r._beginError&&t(r._beginError),null!=r._beginMetadata&&e(r._toTransaction())})),this._beginPromise},dn.prototype._toTransaction=function(){return pn(pn({},this),{run:hn.prototype.run.bind(this),commit:hn.prototype.commit.bind(this),rollback:hn.prototype.rollback.bind(this),close:hn.prototype.close.bind(this),isOpen:hn.prototype.isOpen.bind(this),_begin:this._begin.bind(this)})},dn.prototype._begin=function(e,t){return hn.prototype._begin.call(this,e,t,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this)})},dn.prototype._onBeginError=function(e){this._beginError=e,null!=this._reject&&this._reject(e)},dn.prototype._onBeginMetadata=function(e){this._beginMetadata=null!=e?e:{},null!=this._resolve&&this._resolve(this._toTransaction())},dn);function dn(e){var t=e.connectionHolder,r=e.onClose,n=e.onBookmarks,o=e.onConnection,i=e.reactive,s=e.fetchSize,a=e.impersonatedUser,u=e.highRecordWatermark,e=e.lowRecordWatermark,t=hn.call(this,{connectionHolder:t,onClose:r,onBookmarks:n,onConnection:o,reactive:i,fetchSize:s,impersonatedUser:a,highRecordWatermark:u,lowRecordWatermark:e})||this;return t[fn]="TransactionPromise",t}fn=Symbol.toStringTag,P.default=I;var S={},_n=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},yn=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},bn=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},mn=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},gn=(Object.defineProperty(S,"__esModule",{value:!0}),m),vn=s,wn=v,On=r,En=I(ut),Tn=w,Sn=xt,Pn=g,Cn=O,In=I(P),Rn=I(u);function R(e){var t=e.mode,r=e.connectionProvider,n=e.bookmarks,o=e.database,i=e.config,s=e.reactive,a=e.fetchSize,u=e.impersonatedUser,e=e.bookmarkManager,t=(this._mode=t,this._database=o,this._reactive=s,this._fetchSize=a,this._onDatabaseNameResolved=this._onDatabaseNameResolved.bind(this),this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new Tn.ConnectionHolder({mode:wn.ACCESS_MODE_READ,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks}),this._writeConnectionHolder=new Tn.ConnectionHolder({mode:wn.ACCESS_MODE_WRITE,database:o,bookmarks:n,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks}),this._open=!0,this._hasTx=!1,this._impersonatedUser=u,this._lastBookmarks=null!=n?n:Pn.Bookmarks.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=function(e){e=null!=(e=null==e?void 0:e.maxTransactionRetryTime)?e:null;return new Sn.TransactionExecutor(e)}(i),this._databaseNameResolved=""!==this._database,this._calculateWatermaks());this._lowRecordWatermark=t.low,this._highRecordWatermark=t.high,this._results=[],this._bookmarkManager=e}R.prototype.run=function(e,t,r){var o=this,e=(0,vn.validateQueryAndParameters)(e,t),i=e.validatedQuery,s=e.params,a=null!=r?new Cn.TxConfig(r):Cn.TxConfig.empty(),t=this._run(i,s,function(n){return _n(o,void 0,void 0,function(){var t,r=this;return yn(this,function(e){switch(e.label){case 0:return[4,this._bookmarks()];case 1:return t=e.sent(),this._assertSessionIsOpen(),[2,n.protocol().run(i,s,{bookmarks:t,txConfig:a,mode:this._mode,database:this._database,impersonatedUser:this._impersonatedUser,afterComplete:function(e){return r._onCompleteCallback(e,t)},reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark})]}})})});return this._results.push(t),t},R.prototype._run=function(e,t,r){var n=this._connectionHolderWithMode(this._mode),o=this._open?!this._hasTx&&n.initializeConnection()?n.getConnection().then(function(e){return r(e)}).catch(function(e){return Promise.resolve(new gn.FailedObserver({error:e}))}):Promise.resolve(new gn.FailedObserver({error:(0,On.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")})):Promise.resolve(new gn.FailedObserver({error:(0,On.newError)("Cannot run query in a closed session.")})),i={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new En.default(o,e,t,n,i)},R.prototype._acquireConnection=function(t){var e=this,r=this._connectionHolderWithMode(this._mode),n=this._open?!this._hasTx&&r.initializeConnection()?r.getConnection().then(function(e){return t(e)}).then(function(t){return _n(e,void 0,void 0,function(){return yn(this,function(e){switch(e.label){case 0:return[4,r.releaseConnection()];case 1:return e.sent(),[2,t]}})})}):Promise.reject((0,On.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject((0,On.newError)("Cannot run query in a closed session."));return n},R.prototype.beginTransaction=function(e){var t=Cn.TxConfig.empty();return null!=e&&(t=new Cn.TxConfig(e)),this._beginTransaction(this._mode,t)},R.prototype._beginTransaction=function(e,t){var n=this;if(!this._open)throw(0,On.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,On.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");e=R._validateSessionMode(e),e=this._connectionHolderWithMode(e),e.initializeConnection(),this._hasTx=!0,e=new In.default({connectionHolder:e,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:function(e,t,r){return n._updateBookmarks(e,t,r)},onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark});return e._begin(function(){return n._bookmarks()},t),e},R.prototype._assertSessionIsOpen=function(){if(!this._open)throw(0,On.newError)("You cannot run more transactions on a closed session.")},R.prototype._transactionClosed=function(){this._hasTx=!1},R.prototype.lastBookmark=function(){return this.lastBookmarks()},R.prototype.lastBookmarks=function(){return this._lastBookmarks.values()},R.prototype._bookmarks=function(){var r;return _n(this,void 0,void 0,function(){var t;return yn(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new Pn.Bookmarks(mn(mn([],bn(t),!1),bn(this._configuredBookmarks),!1))]}})})},R.prototype.readTransaction=function(e,t){t=new Cn.TxConfig(t);return this._runTransaction(wn.ACCESS_MODE_READ,t,e)},R.prototype.writeTransaction=function(e,t){t=new Cn.TxConfig(t);return this._runTransaction(wn.ACCESS_MODE_WRITE,t,e)},R.prototype._runTransaction=function(e,t,r){var n=this;return this._transactionExecutor.execute(function(){return n._beginTransaction(e,t)},r)},R.prototype.executeRead=function(e,t){t=new Cn.TxConfig(t);return this._executeInTransaction(wn.ACCESS_MODE_READ,t,e)},R.prototype.executeWrite=function(e,t){t=new Cn.TxConfig(t);return this._executeInTransaction(wn.ACCESS_MODE_WRITE,t,e)},R.prototype._executeInTransaction=function(e,t,r){var n=this;return this._transactionExecutor.execute(function(){return n._beginTransaction(e,t)},r,Rn.default.fromTransaction)},R.prototype._onDatabaseNameResolved=function(e){this._databaseNameResolved||(this._database=e=null!=e?e:"",this._readConnectionHolder.setDatabase(e),this._writeConnectionHolder.setDatabase(e),this._databaseNameResolved=!0)},R.prototype._getConnectionAcquistionBookmarks=function(){var r;return _n(this,void 0,void 0,function(){var t;return yn(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new Pn.Bookmarks(mn(mn([],bn(this._configuredBookmarks),!1),bn(t),!1))]}})})},R.prototype._updateBookmarks=function(e,t,r){var n;null==e||e.isEmpty()||(null!=(n=this._bookmarkManager)&&n.updateBookmarks(null!=(n=null==t?void 0:t.values())?n:[],null!=(t=null==e?void 0:e.values())?t:[]),this._lastBookmarks=e,this._configuredBookmarks=Pn.Bookmarks.empty())},R.prototype.close=function(){return _n(this,void 0,void 0,function(){return yn(this,function(e){switch(e.label){case 0:return this._open?(this._open=!1,this._results.forEach(function(e){return e._cancel()}),this._transactionExecutor.close(),[4,this._readConnectionHolder.close(this._hasTx)]):[3,3];case 1:return e.sent(),[4,this._writeConnectionHolder.close(this._hasTx)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},R.prototype._connectionHolderWithMode=function(e){if(e===wn.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===wn.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,On.newError)("Unknown access mode: "+e)},R.prototype._onCompleteCallback=function(e,t){this._updateBookmarks(new Pn.Bookmarks(e.bookmark),t,e.db)},R.prototype._calculateWatermaks=function(){return this._fetchSize===wn.FETCH_ALL?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}},R._validateSessionMode=function(e){e=null!=e?e:wn.ACCESS_MODE_WRITE;if(e!==wn.ACCESS_MODE_READ&&e!==wn.ACCESS_MODE_WRITE)throw(0,On.newError)("Illegal session mode "+e);return e},S.default=R;var m={},w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},kn=(Object.defineProperty(m,"__esModule",{value:!0}),m.SessionConfig=m.WRITE=m.READ=m.Driver=void 0,g),Nn=w(C),jn=v,An=E,Dn=w(S),Un=s,Mn=36e5,Ln=1e3,xn=jn.ACCESS_MODE_READ,Bn=(m.READ=xn,jn.ACCESS_MODE_WRITE),Fn=(m.WRITE=Bn,0),xt=(m.SessionConfig=function(){this.defaultAccessMode=Bn,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0},Hn.prototype.verifyConnectivity=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:xn})},Hn.prototype.getServerInfo=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:xn})},Hn.prototype.supportsMultiDb=function(){return this._getOrCreateConnectionProvider().supportsMultiDb()},Hn.prototype.supportsTransactionConfig=function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()},Hn.prototype.supportsUserImpersonation=function(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()},Hn.prototype.getNegotiatedProtocolVersion=function(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()},Hn.prototype.isEncrypted=function(){return this._isEncrypted()},Hn.prototype._supportsRouting=function(){return this._meta.routing},Hn.prototype._isEncrypted=function(){return this._config.encrypted===Un.ENCRYPTION_ON||!0===this._config.encrypted},Hn.prototype._getTrust=function(){return this._config.trust},Hn.prototype.session=function(e){var e=void 0===e?{}:e,t=e.defaultAccessMode,r=e.bookmarks,n=e.database,o=e.impersonatedUser,i=e.fetchSize,e=e.bookmarkManager;return this._newSession({defaultAccessMode:void 0===t?Bn:t,bookmarkOrBookmarks:r,database:void 0===n?"":n,reactive:!1,impersonatedUser:o,fetchSize:Vn(i,this._config.fetchSize),bookmarkManager:e})},Hn.prototype.close=function(){return this._log.info("Driver ".concat(this._id," closing")),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()},Hn.prototype._afterConstruction=function(){this._log.info("".concat(this._meta.typename," driver ").concat(this._id," created for server address ").concat(this._meta.address.toString()))},Hn.prototype._newSession=function(e){var t=e.defaultAccessMode,r=e.bookmarkOrBookmarks,n=e.database,o=e.reactive,i=e.impersonatedUser,s=e.fetchSize,e=e.bookmarkManager,t=Dn.default._validateSessionMode(t),a=this._getOrCreateConnectionProvider(),r=null!=r?new kn.Bookmarks(r):kn.Bookmarks.empty();return this._createSession({mode:t,database:null!=n?n:"",connectionProvider:a,bookmarks:r,config:this._config,reactive:o,impersonatedUser:i,fetchSize:s,bookmarkManager:e})},Hn.prototype._getOrCreateConnectionProvider=function(){var e;return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,(e=this._config,new Nn.default(e.resolver)))),this._connectionProvider},Hn);function Hn(e,t,r,n){void 0===n&&(n=function(e){return new Dn.default(e)}),(o=t=void 0===t?{}:t).maxConnectionLifetime=qn(o.maxConnectionLifetime,Mn),o.maxConnectionPoolSize=qn(o.maxConnectionPoolSize,jn.DEFAULT_POOL_MAX_SIZE),o.connectionAcquisitionTimeout=qn(o.connectionAcquisitionTimeout,jn.DEFAULT_POOL_ACQUISITION_TIMEOUT),o.fetchSize=Vn(o.fetchSize,Ln),o.connectionTimeout=function(e){e=parseInt(e.connectionTimeout,10);return 0===e||!isNaN(e)&&e<0?null:isNaN(e)?jn.DEFAULT_CONNECTION_TIMEOUT_MILLIS:e}(o);var o=An.Logger.create(t),i=t,s=o,a=i.resolver;if(null!=a&&"function"!=typeof a)throw new TypeError("Configured resolver should be a function. Got: ".concat(typeof a));i.connectionAcquisitionTimeout<i.connectionTimeout&&s.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired'),this._id=Fn++,this._meta=e,this._config=t,this._log=o,this._createConnectionProvider=r,this._createSession=n,this._connectionProvider=null,this._afterConstruction()}function qn(e,t){e=parseInt(e,10);return 0<e||0===e?e:e<0?Number.MAX_SAFE_INTEGER:t}function Vn(e,t){e=parseInt(e,10);if(0<e||e===jn.FETCH_ALL)return e;if(0===e||e<0)throw new Error("The fetch size can only be a positive value or ".concat(jn.FETCH_ALL," for ALL. However fetchSize = ").concat(e));return t}m.Driver=xt,m.default=xt;O={};function zn(e){return null!=e&&""!==e&&(Object.getPrototypeOf(e)!==Object.prototype||0!==Object.keys(e).length)}Object.defineProperty(O,"__esModule",{value:!0}),O.default={basic:function(e,t,r){return null!=r?{scheme:"basic",principal:e,credentials:t,realm:r}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},bearer:function(e){return{scheme:"bearer",credentials:e}},custom:function(e,t,r,n,o){n={scheme:n,principal:e};return zn(t)&&(n.credentials=t),zn(r)&&(n.realm=r),zn(o)&&(n.parameters=o),n}};var I={},Wn=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Gn=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Kn=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Yn=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},Zn=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},g=(Object.defineProperty(I,"__esModule",{value:!0}),I.bookmarkManager=void 0,Xn.prototype.updateBookmarks=function(e,t){return Wn(this,void 0,void 0,function(){return Gn(this,function(e){throw new Error("Not implemented")})})},Xn.prototype.getBookmarks=function(){return Wn(this,void 0,void 0,function(){return Gn(this,function(e){throw new Error("Not implemented")})})},Xn);function Xn(){throw new Error("Not implemented")}I.default=g,I.bookmarkManager=function(e){void 0===e&&(e={});var t=new Set(e.initialBookmarks);return new Qn(t,e.bookmarksSupplier,e.bookmarksConsumer)};$n.prototype.updateBookmarks=function(f,h){return Wn(this,void 0,void 0,function(){var t,r,n,o,i,s,a,u,c,l;return Gn(this,function(e){switch(e.label){case 0:t=this._bookmarks;try{for(r=Kn(f),n=r.next();!n.done;n=r.next())s=n.value,t.delete(s)}catch(e){a={error:e}}finally{try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(a)throw a.error}}try{for(o=Kn(h),i=o.next();!i.done;i=o.next())s=i.value,t.add(s)}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=o.return)&&l.call(o)}finally{if(c)throw c.error}}return"function"!=typeof this._bookmarksConsumer?[3,2]:[4,this._bookmarksConsumer(Zn([],Yn(t),!1))];case 1:e.sent(),e.label=2;case 2:return[2]}})})},$n.prototype.getBookmarks=function(){var u;return Wn(this,void 0,void 0,function(){var t,r,n,o,i,s,a;return Gn(this,function(e){switch(e.label){case 0:return t=new Set(this._bookmarks),"function"!=typeof this._bookmarksSupplier?[3,2]:[4,this._bookmarksSupplier()];case 1:r=null!=(u=e.sent())?u:[];try{for(n=Kn(r),o=n.next();!o.done;o=n.next())i=o.value,t.add(i)}catch(e){s={error:e}}finally{try{o&&!o.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}e.label=2;case 2:return[2,Zn([],Yn(t),!1)]}})})};var Qn=$n;function $n(e,t,r){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=r}var Jn,eo,to,ro,no,oo,io,so,ao,C={},Cr=(Object.defineProperty(C,"__esModule",{value:!0}),v=t,Jn=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),eo=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),E=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Jn(t,e,r);return eo(t,e),t},w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(v,"__esModule",{value:!0}),v.TransactionPromise=v.ManagedTransaction=v.Transaction=v.Connection=v.ConnectionProvider=v.Result=v.Stats=v.QueryStatistics=v.ProfiledPlan=v.Plan=v.Notification=v.ServerInfo=v.queryType=v.ResultSummary=v.Record=v.isPathSegment=v.PathSegment=v.isPath=v.Path=v.isUnboundRelationship=v.UnboundRelationship=v.isRelationship=v.Relationship=v.isNode=v.Node=v.Time=v.LocalTime=v.LocalDateTime=v.isTime=v.isLocalTime=v.isLocalDateTime=v.isDuration=v.isDateTime=v.isDate=v.Duration=v.DateTime=v.Date=v.Point=v.isPoint=v.internal=v.toString=v.toNumber=v.inSafeRange=v.isInt=v.int=v.Integer=v.error=v.isRetriableError=v.Neo4jError=v.newError=void 0,v.bookmarkManager=v.auth=v.json=v.driver=v.types=v.Driver=v.Session=void 0,to=r,Object.defineProperty(v,"newError",{enumerable:!0,get:function(){return to.newError}}),Object.defineProperty(v,"Neo4jError",{enumerable:!0,get:function(){return to.Neo4jError}}),Object.defineProperty(v,"isRetriableError",{enumerable:!0,get:function(){return to.isRetriableError}}),ro=E(n),v.Integer=ro.default,Object.defineProperty(v,"int",{enumerable:!0,get:function(){return ro.int}}),Object.defineProperty(v,"isInt",{enumerable:!0,get:function(){return ro.isInt}}),Object.defineProperty(v,"inSafeRange",{enumerable:!0,get:function(){return ro.inSafeRange}}),Object.defineProperty(v,"toNumber",{enumerable:!0,get:function(){return ro.toNumber}}),Object.defineProperty(v,"toString",{enumerable:!0,get:function(){return ro.toString}}),no=i,Object.defineProperty(v,"Date",{enumerable:!0,get:function(){return no.Date}}),Object.defineProperty(v,"DateTime",{enumerable:!0,get:function(){return no.DateTime}}),Object.defineProperty(v,"Duration",{enumerable:!0,get:function(){return no.Duration}}),Object.defineProperty(v,"isDate",{enumerable:!0,get:function(){return no.isDate}}),Object.defineProperty(v,"isDateTime",{enumerable:!0,get:function(){return no.isDateTime}}),Object.defineProperty(v,"isDuration",{enumerable:!0,get:function(){return no.isDuration}}),Object.defineProperty(v,"isLocalDateTime",{enumerable:!0,get:function(){return no.isLocalDateTime}}),Object.defineProperty(v,"isLocalTime",{enumerable:!0,get:function(){return no.isLocalTime}}),Object.defineProperty(v,"isTime",{enumerable:!0,get:function(){return no.isTime}}),Object.defineProperty(v,"LocalDateTime",{enumerable:!0,get:function(){return no.LocalDateTime}}),Object.defineProperty(v,"LocalTime",{enumerable:!0,get:function(){return no.LocalTime}}),Object.defineProperty(v,"Time",{enumerable:!0,get:function(){return no.Time}}),oo=d,Object.defineProperty(v,"Node",{enumerable:!0,get:function(){return oo.Node}}),Object.defineProperty(v,"isNode",{enumerable:!0,get:function(){return oo.isNode}}),Object.defineProperty(v,"Relationship",{enumerable:!0,get:function(){return oo.Relationship}}),Object.defineProperty(v,"isRelationship",{enumerable:!0,get:function(){return oo.isRelationship}}),Object.defineProperty(v,"UnboundRelationship",{enumerable:!0,get:function(){return oo.UnboundRelationship}}),Object.defineProperty(v,"isUnboundRelationship",{enumerable:!0,get:function(){return oo.isUnboundRelationship}}),Object.defineProperty(v,"Path",{enumerable:!0,get:function(){return oo.Path}}),Object.defineProperty(v,"isPath",{enumerable:!0,get:function(){return oo.isPath}}),Object.defineProperty(v,"PathSegment",{enumerable:!0,get:function(){return oo.PathSegment}}),Object.defineProperty(v,"isPathSegment",{enumerable:!0,get:function(){return oo.isPathSegment}}),s=w(_),v.Record=s.default,io=f,Object.defineProperty(v,"isPoint",{enumerable:!0,get:function(){return io.isPoint}}),Object.defineProperty(v,"Point",{enumerable:!0,get:function(){return io.Point}}),so=E(y),v.ResultSummary=so.default,Object.defineProperty(v,"queryType",{enumerable:!0,get:function(){return so.queryType}}),Object.defineProperty(v,"ServerInfo",{enumerable:!0,get:function(){return so.ServerInfo}}),Object.defineProperty(v,"Notification",{enumerable:!0,get:function(){return so.Notification}}),Object.defineProperty(v,"Plan",{enumerable:!0,get:function(){return so.Plan}}),Object.defineProperty(v,"ProfiledPlan",{enumerable:!0,get:function(){return so.ProfiledPlan}}),Object.defineProperty(v,"QueryStatistics",{enumerable:!0,get:function(){return so.QueryStatistics}}),Object.defineProperty(v,"Stats",{enumerable:!0,get:function(){return so.Stats}}),xt=w(ut),v.Result=xt.default,g=w(o),v.ConnectionProvider=g.default,g=w(Cr),v.Connection=g.default,r=w(T),v.Transaction=r.default,n=w(u),v.ManagedTransaction=n.default,i=w(P),v.TransactionPromise=i.default,d=w(S),v.Session=d.default,_=E(m),f=_,v.Driver=_.default,v.driver=f,w=w(O),v.auth=w.default,ao=I,Object.defineProperty(v,"bookmarkManager",{enumerable:!0,get:function(){return ao.bookmarkManager}}),y=E(C),v.types=y,ut=E(a),v.json=ut,E=E(b),v.internal=E,o={SERVICE_UNAVAILABLE:to.SERVICE_UNAVAILABLE,SESSION_EXPIRED:to.SESSION_EXPIRED,PROTOCOL_ERROR:to.PROTOCOL_ERROR},v.error=o,o={newError:to.newError,Neo4jError:to.Neo4jError,isRetriableError:to.isRetriableError,error:o,Integer:ro.default,int:ro.int,isInt:ro.isInt,inSafeRange:ro.inSafeRange,toNumber:ro.toNumber,toString:ro.toString,internal:E,isPoint:io.isPoint,Point:io.Point,Date:no.Date,DateTime:no.DateTime,Duration:no.Duration,isDate:no.isDate,isDateTime:no.isDateTime,isDuration:no.isDuration,isLocalDateTime:no.isLocalDateTime,isLocalTime:no.isLocalTime,isTime:no.isTime,LocalDateTime:no.LocalDateTime,LocalTime:no.LocalTime,Time:no.Time,Node:oo.Node,isNode:oo.isNode,Relationship:oo.Relationship,isRelationship:oo.isRelationship,UnboundRelationship:oo.UnboundRelationship,isUnboundRelationship:oo.isUnboundRelationship,Path:oo.Path,isPath:oo.isPath,PathSegment:oo.PathSegment,isPathSegment:oo.isPathSegment,Record:s.default,ResultSummary:so.default,queryType:so.queryType,ServerInfo:so.ServerInfo,Notification:so.Notification,Plan:so.Plan,ProfiledPlan:so.ProfiledPlan,QueryStatistics:so.QueryStatistics,Stats:so.Stats,Result:xt.default,Transaction:r.default,ManagedTransaction:n.default,TransactionPromise:i.default,Session:d.default,Driver:_.default,Connection:g.default,types:y,driver:f,json:ut,auth:w.default,bookmarkManager:ao.bookmarkManager},v.default=o,{}),T={},u={};function uo(){}Object.defineProperty(u,"__esModule",{value:!0}),uo.prototype.selectReader=function(e){throw new Error("Abstract function")},uo.prototype.selectWriter=function(e){throw new Error("Abstract function")},u.default=uo;P={},S={};function co(e){this._offset=e||0}Object.defineProperty(S,"__esModule",{value:!0}),co.prototype.next=function(e){var t;return 0===e?-1:(t=this._offset,this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e)},S.default=co;var lo,fo,m=e&&e.__extends||(lo=function(e,t){return(lo=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}lo(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),O=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ho=(Object.defineProperty(P,"__esModule",{value:!0}),O(S)),I=O(u),C=(fo=I.default,m(po,fo),po.prototype.selectReader=function(e){return this._select(e,this._readersIndex)},po.prototype.selectWriter=function(e){return this._select(e,this._writersIndex)},po.prototype._select=function(e,t){var r=e.length;if(0===r)return null;var n=t.next(r),o=n,i=null,s=Number.MAX_SAFE_INTEGER;do{var a=e[o],u=this._connectionPool.activeResourceCount(a)}while(u<s&&(i=a,s=u),o===r-1?o=0:o++,o!==n);return i},po);function po(e){var t=fo.call(this)||this;return t._readersIndex=new ho.default,t._writersIndex=new ho.default,t._connectionPool=e,t}P.default=C;a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(T,"__esModule",{value:!0}),T.LeastConnectedLoadBalancingStrategy=T.LoadBalancingStrategy=void 0,b=a(u),T.LoadBalancingStrategy=b.default,E=a(P),T.LeastConnectedLoadBalancingStrategy=E.default,T.default=E.default,s={},xt={},r={},n={},i={},d={},_={},g={byteLength:function(e){var e=wo(e),t=e[0],e=e[1];return 3*(t+e)/4-e}};g.toByteArray=function(e){var t,r,n=wo(e),o=n[0],n=n[1],i=new bo(function(e,t){return 3*(e+t)/4-t}(o,n)),s=0,a=0<n?o-4:o;for(r=0;r<a;r+=4)t=yo[e.charCodeAt(r)]<<18|yo[e.charCodeAt(r+1)]<<12|yo[e.charCodeAt(r+2)]<<6|yo[e.charCodeAt(r+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=255&t;2===n&&(t=yo[e.charCodeAt(r)]<<2|yo[e.charCodeAt(r+1)]>>4,i[s++]=255&t);1===n&&(t=yo[e.charCodeAt(r)]<<10|yo[e.charCodeAt(r+1)]<<4|yo[e.charCodeAt(r+2)]>>2,i[s++]=t>>8&255,i[s++]=255&t);return i},g.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],i=0,s=r-n;i<s;i+=16383)o.push(function(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(function(e){return _o[e>>18&63]+_o[e>>12&63]+_o[e>>6&63]+_o[63&e]}(n));return o.join("")}(e,i,s<i+16383?s:i+16383));1==n?(t=e[r-1],o.push(_o[t>>2]+_o[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],o.push(_o[t>>10]+_o[t>>4&63]+_o[t<<2&63]+"="));return o.join("")};for(var _o=[],yo=[],bo="undefined"!=typeof Uint8Array?Uint8Array:Array,mo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",go=0,vo=mo.length;go<vo;++go)_o[go]=mo[go],yo[mo.charCodeAt(go)]=go;function wo(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}yo["-".charCodeAt(0)]=62,yo["_".charCodeAt(0)]=63;y={read:function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,l=-7,f=r?o-1:0,h=r?-1:1,o=e[t+f];for(f+=h,i=o&(1<<-l)-1,o>>=-l,l+=a;0<l;i=256*i+e[t+f],f+=h,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;0<l;s=256*s+e[t+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,n),i-=c}return(o?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var s,a,u=8*i-o-1,c=(1<<u)-1,l=c>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,p=n?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-s))<1&&(s--,n*=2),2<=(t+=1<=s+l?f/n:f*Math.pow(2,1-l))*n&&(s++,n/=2),c<=s+l?(a=0,s=c):1<=s+l?(a=(t*n-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));8<=o;e[r+h]=255&a,h+=p,a/=256,o-=8);for(s=s<<o|a,u+=o;0<u;e[r+h]=255&s,h+=p,s/=256,u-=8);e[r+h-p]|=128*i}};{var Oo=_;const Uh=g,Mh=y,Lh=(f="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,Oo.Buffer=k,Oo.SlowBuffer=function(e){+e!=e&&(e=0);return k.alloc(+e)},Oo.INSPECT_MAX_BYTES=50,2147483647);function Eo(e){if(e>Lh)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,k.prototype),e}function k(e,t,r){if("number"!=typeof e)return To(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Po(e)}function To(t,r,e){if("string"==typeof t){var n=t;var o=r;"string"==typeof o&&""!==o||(o="utf8");if(!k.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var i=0|ko(n,o);let e=Eo(i);n=e.write(n,o);n!==i&&(e=e.slice(0,n));return e}if(ArrayBuffer.isView(t))return Jo(o=t,Uint8Array)?Io((i=new Uint8Array(o)).buffer,i.byteOffset,i.byteLength):Co(o);if(null!=t){if(Jo(t,ArrayBuffer)||t&&Jo(t.buffer,ArrayBuffer))return Io(t,r,e);if("undefined"!=typeof SharedArrayBuffer&&(Jo(t,SharedArrayBuffer)||t&&Jo(t.buffer,SharedArrayBuffer)))return Io(t,r,e);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return k.from(n,r,e);var s=function(e){{var t,r;if(k.isBuffer(e))return t=0|Ro(e.length),0!==(r=Eo(t)).length&&e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||ei(e.length)?Eo(0):Co(e);if("Buffer"===e.type&&Array.isArray(e.data))return Co(e.data)}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return k.from(t[Symbol.toPrimitive]("string"),r,e)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function So(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Po(e){return So(e),Eo(e<0?0:0|Ro(e))}function Co(t){var r=t.length<0?0:0|Ro(t.length),n=Eo(r);for(let e=0;e<r;e+=1)n[e]=255&t[e];return n}function Io(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,k.prototype),n}function Ro(e){if(e>=Lh)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Lh.toString(16)+" bytes");return 0|e}function ko(e,t){if(k.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Jo(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Xo(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Qo(e).length;default:if(o)return n?-1:Xo(e).length;t=(""+t).toLowerCase(),o=!0}}function No(e,r,n){let t=!1;if((r=void 0===r||r<0?0:r)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(r>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":{var o=this;var i=r;var s=n;var a=o.length;(!i||i<0)&&(i=0);(!s||s<0||a<s)&&(s=a);let t="";for(let e=i;e<s;++e)t+=Hh[o[e]];return t;return}case"utf8":case"utf-8":return Lo(this,r,n);case"ascii":{var u=this;a=r;var c=n;let t="";c=Math.min(u.length,c);for(let e=a;e<c;++e)t+=String.fromCharCode(127&u[e]);return t;return}case"latin1":case"binary":{var l=this;i=r;var f=n;let t="";f=Math.min(l.length,f);for(let e=i;e<f;++e)t+=String.fromCharCode(l[e]);return t;return}case"base64":return p=this,_=n,0===(d=r)&&_===p.length?Uh.fromByteArray(p):Uh.fromByteArray(p.slice(d,_));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":{p=this;d=r;_=n;var h=p.slice(d,_);let t="";for(let e=0;e<h.length-1;e+=2)t+=String.fromCharCode(h[e]+256*h[e+1]);return t;return}default:if(t)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),t=!0}var p,d,_}function jo(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Ao(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=ei(r=+r)?o?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=k.from(t,n)),k.isBuffer(t))return 0===t.length?-1:Do(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):Do(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Do(r,n,t,e,o){let i=1,s=r.length,a=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(r.length<2||n.length<2)return-1;i=2,s/=2,a/=2,t/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}let c;if(o){let e=-1;for(c=t;c<s;c++)if(u(r,c)===u(n,-1===e?0:c-e)){if(-1===e&&(e=c),c-e+1===a)return e*i}else-1!==e&&(c-=c-e),e=-1}else for(t+a>s&&(t=s-a),c=t;0<=c;c--){let t=!0;for(let e=0;e<a;e++)if(u(r,c+e)!==u(n,e)){t=!1;break}if(t)return c}return-1}function Uo(e,t,r,n){return $o(function(t){var r=[];for(let e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(t),e,r,n)}function Mo(e,t,r,n){return $o(function(t,r){var n,o;var i=[];for(let e=0;e<t.length&&!((r-=2)<0);++e)n=t.charCodeAt(e),o=n>>8,i.push(n%256),i.push(o);return i}(t,e.length-r),e,r,n)}function Lo(s,e,t){t=Math.min(s.length,t);var r=[];let a=e;for(;a<t;){var u=s[a];let o=null,i=239<u?4:223<u?3:191<u?2:1;if(a+i<=t){let e,t,r,n;switch(i){case 1:u<128&&(o=u);break;case 2:128==(192&(e=s[a+1]))&&127<(n=(31&u)<<6|63&e)&&(o=n);break;case 3:e=s[a+1],t=s[a+2],128==(192&e)&&128==(192&t)&&2047<(n=(15&u)<<12|(63&e)<<6|63&t)&&(n<55296||57343<n)&&(o=n);break;case 4:e=s[a+1],t=s[a+2],r=s[a+3],128==(192&e)&&128==(192&t)&&128==(192&r)&&65535<(n=(15&u)<<18|(63&e)<<12|(63&t)<<6|63&r)&&n<1114112&&(o=n)}}null===o?(o=65533,i=1):65535<o&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=i}{var n=r,o=n.length;if(o<=xh)return String.fromCharCode.apply(String,n);let e="",t=0;for(;t<o;)e+=String.fromCharCode.apply(String,n.slice(t,t+=xh));return e}}Oo.kMaxLength=Lh,(k.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(k.prototype,"parent",{enumerable:!0,get:function(){if(k.isBuffer(this))return this.buffer}}),Object.defineProperty(k.prototype,"offset",{enumerable:!0,get:function(){if(k.isBuffer(this))return this.byteOffset}}),k.poolSize=8192,k.from=To,Object.setPrototypeOf(k.prototype,Uint8Array.prototype),Object.setPrototypeOf(k,Uint8Array),k.alloc=function(e,t,r){return t=t,r=r,So(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?Eo(e).fill(t,r):Eo(e).fill(t):Eo(e)},k.allocUnsafe=Po,k.allocUnsafeSlow=Po,k.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==k.prototype},k.compare=function(r,n){if(Jo(r,Uint8Array)&&(r=k.from(r,r.offset,r.byteLength)),Jo(n,Uint8Array)&&(n=k.from(n,n.offset,n.byteLength)),!k.isBuffer(r)||!k.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;let o=r.length,i=n.length;for(let e=0,t=Math.min(o,i);e<t;++e)if(r[e]!==n[e]){o=r[e],i=n[e];break}return o<i?-1:i<o?1:0},k.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},k.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return k.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=k.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(Jo(e,Uint8Array))o+e.length>n.length?(e=k.isBuffer(e)?e:k.from(e)).copy(n,o):Uint8Array.prototype.set.call(n,e,o);else{if(!k.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},k.byteLength=ko,k.prototype._isBuffer=!0,k.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)jo(this,e,e+1);return this},k.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)jo(this,e,e+3),jo(this,e+1,e+2);return this},k.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)jo(this,e,e+7),jo(this,e+1,e+6),jo(this,e+2,e+5),jo(this,e+3,e+4);return this},k.prototype.toLocaleString=k.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?Lo(this,0,e):No.apply(this,arguments)},k.prototype.equals=function(e){if(k.isBuffer(e))return this===e||0===k.compare(this,e);throw new TypeError("Argument must be a Buffer")},k.prototype.inspect=function(){let e="";var t=Oo.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},f&&(k.prototype[f]=k.prototype.inspect),k.prototype.compare=function(e,t,r,n,o){if(Jo(e,Uint8Array)&&(e=k.from(e,e.offset,e.byteLength)),!k.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(o<=n&&r<=t)return 0;if(o<=n)return-1;if(r<=t)return 1;if(this===e)return 0;let i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);var a=Math.min(i,s),u=this.slice(n,o),c=e.slice(t,r);for(let e=0;e<a;++e)if(u[e]!==c[e]){i=u[e],s=c[e];break}return i<s?-1:s<i?1:0},k.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},k.prototype.indexOf=function(e,t,r){return Ao(this,e,t,r,!0)},k.prototype.lastIndexOf=function(e,t,r){return Ao(this,e,t,r,!1)},k.prototype.write=function(t,r,n,e){if(void 0===r)e="utf8",n=this.length,r=0;else if(void 0===n&&"string"==typeof r)e=r,n=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(n)?(n>>>=0,void 0===e&&(e="utf8")):(e=n,n=void 0)}var o,i,s,a=this.length-r;if((void 0===n||a<n)&&(n=a),0<t.length&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");e=e||"utf8";let u=!1;for(;;)switch(e){case"hex":{var c=this;var l=t;var f=r;var h=n;f=Number(f)||0;var p=c.length-f;(!h||p<(h=Number(h)))&&(h=p),(p=l.length)/2<h&&(h=p/2);let e;for(e=0;e<h;++e){var d=parseInt(l.substr(2*e,2),16);if(ei(d))return e;c[f+e]=d}return e;return}case"utf8":case"utf-8":return p=r,s=n,$o(Xo(t,(i=this).length-p),i,p,s);case"ascii":case"latin1":case"binary":return Uo(this,t,r,n);case"base64":return i=this,s=r,o=n,$o(Qo(t),i,s,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mo(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),u=!0}},k.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const xh=4096;function xo(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function Bo(e,t,r,n,o,i){if(!k.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function Fo(e,t,r,n,o){Ko(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r++]=n,e[r++]=n>>=8,e[r++]=n>>=8,e[r++]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,e[r++]=o>>=8,e[r++]=o>>=8,e[r++]=o>>=8,r}function Ho(e,t,r,n,o){Ko(t,n,o,e,r,7);n=Number(t&BigInt(4294967295)),e[r+7]=n,e[r+6]=n>>=8,e[r+5]=n>>=8,e[r+4]=n>>=8,o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,e[r+2]=o>>=8,e[r+1]=o>>=8,e[r]=o>>=8,r+8}function qo(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Vo(e,t,r,n,o){return t=+t,r>>>=0,o||qo(e,0,r,4),Mh.write(e,t,r,n,23,4),r+4}function zo(e,t,r,n,o){return t=+t,r>>>=0,o||qo(e,0,r,8),Mh.write(e,t,r,n,52,8),r+8}k.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(r,k.prototype),r},k.prototype.readUintLE=k.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||xo(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return n},k.prototype.readUintBE=k.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||xo(e,t,this.length);let n=this[e+--t],o=1;for(;0<t&&(o*=256);)n+=this[e+--t]*o;return n},k.prototype.readUint8=k.prototype.readUInt8=function(e,t){return e>>>=0,t||xo(e,1,this.length),this[e]},k.prototype.readUint16LE=k.prototype.readUInt16LE=function(e,t){return e>>>=0,t||xo(e,2,this.length),this[e]|this[e+1]<<8},k.prototype.readUint16BE=k.prototype.readUInt16BE=function(e,t){return e>>>=0,t||xo(e,2,this.length),this[e]<<8|this[e+1]},k.prototype.readUint32LE=k.prototype.readUInt32LE=function(e,t){return e>>>=0,t||xo(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},k.prototype.readUint32BE=k.prototype.readUInt32BE=function(e,t){return e>>>=0,t||xo(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},k.prototype.readBigUInt64LE=ti(function(e){Yo(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||Zo(e,this.length-8),t+256*this[++e]+65536*this[++e]+this[++e]*2**24),e=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(t)+(BigInt(e)<<BigInt(32))}),k.prototype.readBigUInt64BE=ti(function(e){Yo(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||Zo(e,this.length-8),t*2**24+65536*this[++e]+256*this[++e]+this[++e]),e=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(t)<<BigInt(32))+BigInt(e)}),k.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||xo(e,t,this.length);let n=this[e],o=1,i=0;for(;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},k.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||xo(e,t,this.length);let n=t,o=1,i=this[e+--n];for(;0<n&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},k.prototype.readInt8=function(e,t){return e>>>=0,t||xo(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},k.prototype.readInt16LE=function(e,t){e>>>=0,t||xo(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},k.prototype.readInt16BE=function(e,t){e>>>=0,t||xo(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},k.prototype.readInt32LE=function(e,t){return e>>>=0,t||xo(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},k.prototype.readInt32BE=function(e,t){return e>>>=0,t||xo(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},k.prototype.readBigInt64LE=ti(function(e){Yo(e>>>=0,"offset");var t=this[e],r=this[e+7],r=(void 0!==t&&void 0!==r||Zo(e,this.length-8),this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24));return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),k.prototype.readBigInt64BE=ti(function(e){Yo(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||Zo(e,this.length-8),(t<<24)+65536*this[++e]+256*this[++e]+this[++e]);return(BigInt(t)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),k.prototype.readFloatLE=function(e,t){return e>>>=0,t||xo(e,4,this.length),Mh.read(this,e,!0,23,4)},k.prototype.readFloatBE=function(e,t){return e>>>=0,t||xo(e,4,this.length),Mh.read(this,e,!1,23,4)},k.prototype.readDoubleLE=function(e,t){return e>>>=0,t||xo(e,8,this.length),Mh.read(this,e,!0,52,8)},k.prototype.readDoubleBE=function(e,t){return e>>>=0,t||xo(e,8,this.length),Mh.read(this,e,!1,52,8)},k.prototype.writeUintLE=k.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||Bo(this,e,t,r,Math.pow(2,8*r)-1,0);let o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},k.prototype.writeUintBE=k.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||Bo(this,e,t,r,Math.pow(2,8*r)-1,0);let o=r-1,i=1;for(this[t+o]=255&e;0<=--o&&(i*=256);)this[t+o]=e/i&255;return t+r},k.prototype.writeUint8=k.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,1,255,0),this[t]=255&e,t+1},k.prototype.writeUint16LE=k.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},k.prototype.writeUint16BE=k.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},k.prototype.writeUint32LE=k.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},k.prototype.writeUint32BE=k.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},k.prototype.writeBigUInt64LE=ti(function(e,t=0){return Fo(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),k.prototype.writeBigUInt64BE=ti(function(e,t=0){return Ho(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),k.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||Bo(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=0,i=1,s=0;for(this[t]=255&e;++o<r&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},k.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||Bo(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);let o=r-1,i=1,s=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},k.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},k.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},k.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},k.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},k.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||Bo(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},k.prototype.writeBigInt64LE=ti(function(e,t=0){return Fo(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),k.prototype.writeBigInt64BE=ti(function(e,t=0){return Ho(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),k.prototype.writeFloatLE=function(e,t,r){return Vo(this,e,t,!0,r)},k.prototype.writeFloatBE=function(e,t,r){return Vo(this,e,t,!1,r)},k.prototype.writeDoubleLE=function(e,t,r){return zo(this,e,t,!0,r)},k.prototype.writeDoubleBE=function(e,t,r){return zo(this,e,t,!1,r)},k.prototype.copy=function(e,t,r,n){if(!k.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var o=(n=e.length-t<n-r?e.length-t+r:n)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),o},k.prototype.fill=function(t,r,n,o){if("string"==typeof t){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!k.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var e;1===t.length&&(e=t.charCodeAt(0),"utf8"===o&&e<128||"latin1"===o)&&(t=e)}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(!(n<=r)){r>>>=0,n=void 0===n?this.length:n>>>0;let e;if("number"==typeof(t=t||0))for(e=r;e<n;++e)this[e]=t;else{var i=k.isBuffer(t)?t:k.from(t,o),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(e=0;e<n-r;++e)this[e+r]=i[e%s]}}return this};const Bh={};function Wo(e,t,r){Bh[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=this.name+` [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return this.name+` [${e}]: `+this.message}}}function Go(e){let t="",r=e.length;for(var n="-"===e[0]?1:0;r>=4+n;r-=3)t="_"+e.slice(r-3,r)+t;return""+e.slice(0,r)+t}function Ko(t,r,n,e,o,i){if(n<t||t<r){var s="bigint"==typeof r?"n":"";let e;throw e=3<i?0===r||r===BigInt(0)?`>= 0${s} and < 2${s} ** `+8*(i+1)+s:`>= -(2${s} ** ${8*(i+1)-1}${s}) and < 2 ** `+(8*(i+1)-1)+s:`>= ${r}${s} and <= `+n+s,new Bh.ERR_OUT_OF_RANGE("value",e,t)}r=e,n=i,Yo(s=o,"offset"),void 0!==r[s]&&void 0!==r[s+n]||Zo(s,r.length-(n+1))}function Yo(e,t){if("number"!=typeof e)throw new Bh.ERR_INVALID_ARG_TYPE(t,"number",e)}function Zo(e,t,r){if(Math.floor(e)!==e)throw Yo(e,r),new Bh.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new Bh.ERR_BUFFER_OUT_OF_BOUNDS;throw new Bh.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= `+t,e)}Wo("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?e+" is outside of buffer bounds":"Attempt to access memory outside buffer bounds"},RangeError),Wo("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type `+typeof t},TypeError),Wo("ERR_OUT_OF_RANGE",function(e,t,r){e=`The value of "${e}" is out of range.`;let n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=Go(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=Go(n)),n+="n"),e+=` It must be ${t}. Received `+n},RangeError);const Fh=/[^+/0-9A-Za-z-_]/g;function Xo(t,r){r=r||1/0;let n;var o=t.length;let i=null;var s=[];for(let e=0;e<o;++e){if(55295<(n=t.charCodeAt(e))&&n<57344){if(!i){if(56319<n){-1<(r-=3)&&s.push(239,191,189);continue}if(e+1===o){-1<(r-=3)&&s.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(r-=3)&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(r-=3)&&s.push(239,191,189);if(i=null,n<128){if(--r<0)break;s.push(n)}else if(n<2048){if((r-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((r-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Qo(e){return Uh.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Fh,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $o(e,t,r,n){let o;for(o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function Jo(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ei(e){return e!=e}const Hh=function(){var r="0123456789abcdef",n=new Array(256);for(let t=0;t<16;++t){var o=16*t;for(let e=0;e<16;++e)n[o+e]=r[t]+r[e]}return n}();function ti(e){return"undefined"==typeof BigInt?ri:e}function ri(){throw new Error("BigInt not supported")}}var ni,ut={},w={},v=e&&e.__extends||(ni=function(e,t){return(ni=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ni(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=(Object.defineProperty(w,"__esModule",{value:!0}),N.prototype.getUInt8=function(e){throw new Error("Not implemented")},N.prototype.getInt8=function(e){throw new Error("Not implemented")},N.prototype.getFloat64=function(e){throw new Error("Not implemented")},N.prototype.putUInt8=function(e,t){throw new Error("Not implemented")},N.prototype.putInt8=function(e,t){throw new Error("Not implemented")},N.prototype.putFloat64=function(e,t){throw new Error("Not implemented")},N.prototype.getInt16=function(e){return this.getInt8(e)<<8|this.getUInt8(e+1)},N.prototype.getUInt16=function(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)},N.prototype.getInt32=function(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},N.prototype.getUInt32=function(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},N.prototype.getInt64=function(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)},N.prototype.getSlice=function(e,t){return new ii(e,t,this)},N.prototype.putInt16=function(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)},N.prototype.putUInt16=function(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)},N.prototype.putInt32=function(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},N.prototype.putUInt32=function(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},N.prototype.putInt64=function(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)},N.prototype.putBytes=function(e,t){for(var r=0,n=t.remaining();r<n;r++)this.putUInt8(e+r,t.readUInt8())},N.prototype.readUInt8=function(){return this.getUInt8(this._updatePos(1))},N.prototype.readInt8=function(){return this.getInt8(this._updatePos(1))},N.prototype.readUInt16=function(){return this.getUInt16(this._updatePos(2))},N.prototype.readUInt32=function(){return this.getUInt32(this._updatePos(4))},N.prototype.readInt16=function(){return this.getInt16(this._updatePos(2))},N.prototype.readInt32=function(){return this.getInt32(this._updatePos(4))},N.prototype.readInt64=function(){return this.getInt32(this._updatePos(8))},N.prototype.readFloat64=function(){return this.getFloat64(this._updatePos(8))},N.prototype.writeUInt8=function(e){this.putUInt8(this._updatePos(1),e)},N.prototype.writeInt8=function(e){this.putInt8(this._updatePos(1),e)},N.prototype.writeInt16=function(e){this.putInt16(this._updatePos(2),e)},N.prototype.writeInt32=function(e){this.putInt32(this._updatePos(4),e)},N.prototype.writeUInt32=function(e){this.putUInt32(this._updatePos(4),e)},N.prototype.writeInt64=function(e){this.putInt64(this._updatePos(8),e)},N.prototype.writeFloat64=function(e){this.putFloat64(this._updatePos(8),e)},N.prototype.writeBytes=function(e){this.putBytes(this._updatePos(e.remaining()),e)},N.prototype.readSlice=function(e){return this.getSlice(this._updatePos(e),e)},N.prototype._updatePos=function(e){var t=this.position;return this.position+=e,t},N.prototype.remaining=function(){return this.length-this.position},N.prototype.hasRemaining=function(){return 0<this.remaining()},N.prototype.reset=function(){this.position=0},N.prototype.toString=function(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()},N.prototype.toHex=function(){for(var e="",t=0;t<this.length;t++){var r=this.getUInt8(t).toString(16);e+=r=1===r.length?"0"+r:r,t!==this.length-1&&(e+=" ")}return e},N);function N(e){this.position=0,this.length=e}w.default=o;v(si,oi=o),si.prototype.putUInt8=function(e,t){this._inner.putUInt8(this._start+e,t)},si.prototype.getUInt8=function(e){return this._inner.getUInt8(this._start+e)},si.prototype.putInt8=function(e,t){this._inner.putInt8(this._start+e,t)},si.prototype.putFloat64=function(e,t){this._inner.putFloat64(this._start+e,t)},si.prototype.getInt8=function(e){return this._inner.getInt8(this._start+e)},si.prototype.getFloat64=function(e){return this._inner.getFloat64(this._start+e)};var oi,ii=si;function si(e,t,r){t=oi.call(this,t)||this;return t._start=e,t._inner=r,t}var ai,ui,S=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},O=(Object.defineProperty(ut,"__esModule",{value:!0}),ut.BaseBuffer=void 0,S(w)),I=(ut.BaseBuffer=O.default,ut.default=O.default,e&&e.__extends||(ai=function(e,t){return(ai=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ai(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),m=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ci=(Object.defineProperty(d,"__esModule",{value:!0}),d.alloc=void 0,m(_)),C=m(ut),li=(ui=C.default,I(fi,ui),fi.prototype.getUInt8=function(e){return this._buffer.readUInt8(e)},fi.prototype.getInt8=function(e){return this._buffer.readInt8(e)},fi.prototype.getFloat64=function(e){return this._buffer.readDoubleBE(e)},fi.prototype.putUInt8=function(e,t){this._buffer.writeUInt8(t,e)},fi.prototype.putInt8=function(e,t){this._buffer.writeInt8(t,e)},fi.prototype.putFloat64=function(e,t){this._buffer.writeDoubleBE(t,e)},fi.prototype.putBytes=function(e,t){var r;t instanceof fi?(r=Math.min(t.length-t.position,this.length-e),t._buffer.copy(this._buffer,e,t.position,t.position+r),t.position+=r):ui.prototype.putBytes.call(this,e,t)},fi.prototype.getSlice=function(e,t){return new fi(this._buffer.slice(e,e+t))},fi);function fi(e){var t=this,e=(e=e)instanceof ci.default.Buffer?e:"number"==typeof e&&"function"==typeof ci.default.Buffer.alloc?ci.default.Buffer.alloc(e):new ci.default.Buffer(e);return(t=ui.call(this,e.length)||this)._buffer=e,t}d.default=li,d.alloc=function(e){return new li(e)};var u=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},hi=(Object.defineProperty(i,"__esModule",{value:!0}),u(d)),pi=t,b=pi.internal.util,di=b.ENCRYPTION_OFF,_i=b.ENCRYPTION_ON;function yi(e,t,r){void 0===t&&(t=bi),void 0===r&&(r=function(e){return new WebSocket(e)});var n,o=this,t=(this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=e,this._receiveTimeout=null,this._receiveTimeoutStarted=!1,this._receiveTimeoutId=null,function(e,t){var r=function(e){return!0===e.encrypted||e.encrypted===_i}(e),n=function(e){return!1===e.encrypted||e.encrypted===di}(e),e=e.trust,t=function(e){e="function"==typeof e?e():"";return e&&0<=e.toLowerCase().indexOf("https")}(t);if(function(e,t,r){null!==r&&(e&&!r?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&r&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption."))}(r,n,t),!n){if(t)return{scheme:"wss",error:null};if(r)return e&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==e?{scheme:null,error:(0,pi.newError)("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+e+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+di+'"` in the driver configuration.')}:{scheme:"wss",error:null}}return{scheme:"ws",error:null}}(e,t)),i=t.scheme,t=t.error;t?this._error=t:(this._ws=function(t,r,n){var o=t+"://"+r.asHostPort();try{return n(o)}catch(e){if(function(e,t){return"SyntaxError"===e.name&&function(e){return"["===e.charAt(0)&&-1!==e.indexOf("]")}(t.asHostPort())}(e,r))return o=function(e,t){var r=t.host().replace(/:/g,"-").replace("%","s")+".ipv6-literal.net";return"".concat(e,"://").concat(r,":").concat(t.port())}(t,r),n(o);throw e}}(i,e.address,r),this._ws.binaryType="arraybuffer",(n=this)._ws.onclose=function(e){e&&!e.wasClean&&n._handleConnectionError(),n._open=!1},this._ws.onopen=function(){n._clearConnectionTimeout();var e=n._pending;n._pending=null;for(var t=0;t<e.length;t++)n.write(e[t])},this._ws.onmessage=function(e){o._resetTimeout(),n.onmessage&&(e=new hi.default(e.data),n.onmessage(e))},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout())}function bi(){return"undefined"!=typeof window&&window.location?window.location.protocol:null}yi.prototype._handleConnectionError=function(){this._connectionTimeoutFired?(this._error=(0,pi.newError)("Failed to establish connection in ".concat(this._config.connectionTimeout,"ms"),this._config.connectionErrorCode),this.onerror&&this.onerror(this._error)):this._open&&!this._timedout&&(this._error=(0,pi.newError)("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror)&&this.onerror(this._error)},yi.prototype.write=function(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof hi.default))throw(0,pi.newError)("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(1===this._ws.readyState)throw e;this._handleConnectionError()}}},yi.prototype.close=function(){var r=this;return new Promise(function(e,t){r._ws&&3!==r._ws.readyState?(r._open=!1,r.stopReceiveTimeout(),r._clearConnectionTimeout(),r._ws.onclose=function(){return e()},r._ws.close()):e()})},yi.prototype.setupReceiveTimeout=function(e){this._receiveTimeout=e},yi.prototype.stopReceiveTimeout=function(){null!==this._receiveTimeout&&this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!1,null!=this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=null)},yi.prototype.startReceiveTimeout=function(){this._open&&null!==this._receiveTimeout&&!this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!0,this._resetTimeout())},yi.prototype._resetTimeout=function(){var e=this;this._receiveTimeoutStarted&&(null!==this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=setTimeout(function(){e._receiveTimeoutId=null,e._timedout=!0,e.stopReceiveTimeout(),e._error=(0,pi.newError)("Connection lost. Server didn't respond in ".concat(e._receiveTimeout,"ms"),e._config.connectionErrorCode),e.close(),e.onerror&&e.onerror(e._error)},this._receiveTimeout))},yi.prototype._setupConnectionTimeout=function(){var e,t=this,r=this._config.connectionTimeout;return r?(e=this._ws,setTimeout(function(){1!==e.readyState&&(t._connectionTimeoutFired=!0,e.close())},r)):null},yi.prototype._clearConnectionTimeout=function(){var e=this._connectionTimeoutId;!e&&0!==e||(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))},i.default=yi;var mi,a={},P=e&&e.__extends||(mi=function(e,t){return(mi=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}mi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(a,"__esModule",{value:!0});var gi,E=t.internal.resolver.BaseHostNameResolver,g=(P(vi,gi=E),vi.prototype.resolve=function(e){return this._resolveToItself(e)},vi);function vi(){return null!==gi&&gi.apply(this,arguments)||this}a.default=g;var wi,y=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},f=(Object.defineProperty(n,"__esModule",{value:!0}),n.HostNameResolver=n.Channel=void 0,y(i)),v=y(a),o=(n.Channel=f.default,n.HostNameResolver=v.default,{}),S={},O=e&&e.__extends||(wi=function(e,t){return(wi=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}wi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(S,"__esModule",{value:!0});var Oi,Ei=d,m=(Oi=ut.BaseBuffer,O(Ti,Oi),Ti.prototype.getUInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getUInt8(e);e-=r.length}},Ti.prototype.getInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getInt8(e);e-=r.length}},Ti.prototype.getFloat64=function(e){for(var t=(0,Ei.alloc)(8),r=0;r<8;r++)t.putUInt8(r,this.getUInt8(e+r));return t.getFloat64(0)},Ti);function Ti(e){for(var t=this,r=0,n=0;n<e.length;n++)r+=e[n].length;return(t=Oi.call(this,r)||this)._buffers=e,t}S.default=m;var Si,Pi,C=e&&e.__extends||(Si=function(e,t){return(Si=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Si(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},u=(Object.defineProperty(o,"__esModule",{value:!0}),o.Dechunker=o.Chunker=void 0,I(w)),Ci=d,Ii=I(S),b=(Pi=u.default,C(Ri,Pi),Ri.prototype.putUInt8=function(e,t){this._ensure(1),this._buffer.writeUInt8(t)},Ri.prototype.putInt8=function(e,t){this._ensure(1),this._buffer.writeInt8(t)},Ri.prototype.putFloat64=function(e,t){this._ensure(8),this._buffer.writeFloat64(t)},Ri.prototype.putBytes=function(e,t){for(;0<t.remaining();)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this},Ri.prototype.flush=function(){var e;return 0<this._buffer.position&&(this._closeChunkIfOpen(),e=this._buffer,this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=(0,Ci.alloc)(this._bufferSize),this._chunkOpen=!1),this},Ri.prototype.messageBoundary=function(){this._closeChunkIfOpen(),this._buffer.remaining()<2&&this.flush(),this._buffer.writeInt16(0)},Ri.prototype._ensure=function(e){e=this._chunkOpen?e:e+2;this._buffer.remaining()<e&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+2,this._chunkOpen=!0)},Ri.prototype._closeChunkIfOpen=function(){var e;this._chunkOpen&&(e=this._buffer.position-(this._currentChunkStart+2),this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1)},Ri);function Ri(e,t){var r=Pi.call(this,0)||this;return r._bufferSize=t||1400,r._ch=e,r._buffer=(0,Ci.alloc)(r._bufferSize),r._currentChunkStart=0,r._chunkOpen=!1,r}function ki(){this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}o.Chunker=b,ki.prototype.AWAITING_CHUNK=function(e){return 2<=e.remaining()?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)},ki.prototype.IN_HEADER=function(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))},ki.prototype.IN_CHUNK=function(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)},ki.prototype.CLOSED=function(e){},ki.prototype._onHeader=function(e){if(0!==e)return this._chunkSize=e,this.IN_CHUNK;var t=void 0;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:t=this._currentMessage[0];break;default:t=new Ii.default(this._currentMessage)}return this._currentMessage=[],this.onmessage(t),this.AWAITING_CHUNK},ki.prototype.write=function(e){for(;e.hasRemaining();)this._state=this._state(e)},o.Dechunker=ki;var P={},Ni=(Object.defineProperty(P,"__esModule",{value:!0}),t),E=Ni.internal.util,g=E.ENCRYPTION_OFF,i=E.ENCRYPTION_ON,ji=Ni.error.SERVICE_UNAVAILABLE,Ai=[null,void 0,!0,!1,i,g],Di=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"];P.default=function(e,t,r){this.address=e,this.encrypted=function(e){e=e.encrypted;if(-1!==Ai.indexOf(e))return e;throw(0,Ni.newError)("Illegal value of the encrypted setting ".concat(e,". Expected one of ").concat(Ai))}(t),this.trust=function(e){e=e.trust;if(-1!==Di.indexOf(e))return e;throw(0,Ni.newError)("Illegal value of the trust setting ".concat(e,". Expected one of ").concat(Di))}(t),this.trustedCertificates=t.trustedCertificates||[],this.knownHostsPath=t.knownHosts||null,this.connectionErrorCode=r||ji,this.connectionTimeout=t.connectionTimeout};var Ui,Mi,y={},a={},f={exports:{}};function Li(e,t){for(var r in e)t[r]=e[r]}function xi(e,t,r){return Mi(e,t,r)}O=(v=f).exports,(Mi=(Ui=_).Buffer).from&&Mi.alloc&&Mi.allocUnsafe&&Mi.allocUnsafeSlow?v.exports=Ui:(Li(Ui,O),O.Buffer=xi),xi.prototype=Object.create(Mi.prototype),Li(Mi,xi),xi.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return Mi(e,t,r)},xi.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=Mi(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},xi.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Mi(e)},xi.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Ui.SlowBuffer(e)};var Bi=f.exports.Buffer,Fi=Bi.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Hi(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"==typeof t||Bi.isEncoding!==Fi&&Fi(e))return t||e;throw new Error("Unknown encoding: "+e)}function qi(e){var t;switch(this.encoding=Hi(e),this.encoding){case"utf16le":this.text=Wi,this.end=Gi,t=4;break;case"utf8":this.fillLast=zi,t=4;break;case"base64":this.text=Ki,this.end=Yi,t=3;break;default:return this.write=Zi,void(this.end=Xi)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Bi.allocUnsafe(t)}function Vi(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function zi(e){var t,r=this.lastTotal-this.lastNeed,n=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function Wi(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function Gi(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function Ki(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function Yi(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Zi(e){return e.toString(this.encoding)}function Xi(e){return e&&e.length?this.write(e):""}(a.StringDecoder=qi).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},qi.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},qi.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(!(n<r)){var o=Vi(t[n]);if(0<=o)return 0<o&&(e.lastNeed=o-1),o;if(!(--n<r||-2===o)){if(0<=(o=Vi(t[n])))return 0<o&&(e.lastNeed=o-2),o;if(!(--n<r||-2===o)&&0<=(o=Vi(t[n])))return 0<o&&(2===o?o=0:e.lastNeed=o-3),o}}return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},qi.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};var Qi,$i,Ji,es,ts,m=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},rs=(Object.defineProperty(y,"__esModule",{value:!0}),m(d)),ns=t,os=m(_),is=new a.StringDecoder("utf8");y.default={encode:function(e){return new rs.default((e=e,"function"==typeof os.default.Buffer.from?os.default.Buffer.from(e,"utf8"):new os.default.Buffer(e,"utf8")))},decode:function(e,t){if(Object.prototype.hasOwnProperty.call(e,"_buffer"))return n=t,a=(r=e).position,n=a+n,r.position=Math.min(n,r.length),r._buffer.toString("utf8",a,n);var o,i,s,r,n,a;if(Object.prototype.hasOwnProperty.call(e,"_buffers"))return o=function(e){return is.write(e._buffer)},r=function(){return is.end()},i=t,s=(a=e).position,a._updatePos(Math.min(t,a.length-s)),a._buffers.reduce(function(e,t){var r,n;return i<=0?e:s>=t.length?(s-=t.length,""):(t._updatePos(s-t.position),r=Math.min(t.length-s,i),n=t.readSlice(r),t._updatePos(r),i=Math.max(i-n.length,0),s=0,e+o(n))},"")+r();throw(0,ns.newError)("Don't know how to decode strings from '".concat(e,"'"))}},w=r,Qi=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),I=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Qi(t,e,r)},$i=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(w,"__esModule",{value:!0}),w.utf8=w.alloc=w.ChannelConfig=void 0,I(n,w),I(o,w),Ji=P,Object.defineProperty(w,"ChannelConfig",{enumerable:!0,get:function(){return $i(Ji).default}}),es=d,Object.defineProperty(w,"alloc",{enumerable:!0,get:function(){return es.alloc}}),ts=y,Object.defineProperty(w,"utf8",{enumerable:!0,get:function(){return $i(ts).default}}),Object.defineProperty(xt,"__esModule",{value:!0});var ss=r,as=t,us=1616949271;function cs(e,t){return{major:e,minor:t}}function ls(){var e=[cs(5,0),[cs(4,4),cs(4,2)],cs(4,1),cs(3,0)];if(4<e.length)throw(0,as.newError)("It should not have more than 4 versions of the protocol");var o=(0,ss.alloc)(20);return o.writeInt32(us),e.forEach(function(e){var t,r,n;e instanceof Array?(r=(n=e[0]).major,n=n.minor,t=e[1].minor,o.writeInt32(n-t<<16|n<<8|r)):(r=e.major,n=e.minor,o.writeInt32(n<<8|r))}),o.reset(),o}xt.default=function(t){var o=this;return new Promise(function(r,n){function e(e){n(e)}t.onerror=e.bind(o),t._error&&e(t._error),t.onmessage=function(t){try{var e=function(e){if(72===(e=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()])[0]&&84===e[1]&&84===e[2]&&80===e[3])throw(0,as.newError)("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");return Number(e[3]+"."+e[2])}(t);r({protocolVersion:e,consumeRemainingBuffer:function(e){t.hasRemaining()&&e(t.readSlice(t.remaining()))}})}catch(e){n(e)}},t.write(ls())})};var fs,S={},u={},C={},b={},E={},i=e&&e.__extends||(fs=function(e,t){return(fs=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}fs(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),g=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},v=(Object.defineProperty(E,"__esModule",{value:!0}),g(t),hs.ofRecord=function(e){return null===e?hs.ofNull():new vs(e)},hs.ofMessageResponse=function(e){return null===e?hs.ofNull():new ds(e)},hs.ofNull=function(){return new bs},Object.defineProperty(hs.prototype,"ttl",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(hs.prototype,"db",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(hs.prototype,"servers",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(hs.prototype,"isNull",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),hs);function hs(){}E.default=v;i(_s,ps=v),Object.defineProperty(_s.prototype,"ttl",{get:function(){return this._response.rt.ttl},enumerable:!1,configurable:!0}),Object.defineProperty(_s.prototype,"servers",{get:function(){return this._response.rt.servers},enumerable:!1,configurable:!0}),Object.defineProperty(_s.prototype,"db",{get:function(){return this._response.rt.db},enumerable:!1,configurable:!0}),Object.defineProperty(_s.prototype,"isNull",{get:function(){return null===this._response},enumerable:!1,configurable:!0});var ps,ds=_s;function _s(e){var t=ps.call(this)||this;return t._response=e,t}i(ms,ys=v),Object.defineProperty(ms.prototype,"isNull",{get:function(){return!0},enumerable:!1,configurable:!0});var ys,bs=ms;function ms(){return null!==ys&&ys.apply(this,arguments)||this}i(ws,gs=v),Object.defineProperty(ws.prototype,"ttl",{get:function(){return this._record.get("ttl")},enumerable:!1,configurable:!0}),Object.defineProperty(ws.prototype,"servers",{get:function(){return this._record.get("servers")},enumerable:!1,configurable:!0}),Object.defineProperty(ws.prototype,"db",{get:function(){return this._record.has("db")?this._record.get("db"):null},enumerable:!1,configurable:!0}),Object.defineProperty(ws.prototype,"isNull",{get:function(){return null===this._record},enumerable:!1,configurable:!0});var gs,vs=ws;function ws(e){var t=gs.call(this)||this;return t._record=e,t}var Os,O=e&&e.__extends||(Os=function(e,t){return(Os=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Os(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Es=(Object.defineProperty(b,"__esModule",{value:!0}),b.ProcedureRouteObserver=b.RouteObserver=b.CompletedObserver=b.FailedObserver=b.ResetObserver=b.LoginObserver=b.ResultStreamObserver=b.StreamObserver=void 0,t),Ts=f(E),Ss=Es.internal.constants.FETCH_ALL,Ps=Es.error.PROTOCOL_ERROR,m=(Cs.prototype.onNext=function(e){},Cs.prototype.onError=function(e){},Cs.prototype.onCompleted=function(e){},Cs);function Cs(){}b.StreamObserver=m;O(Rs,Is=m),Rs.prototype.pause=function(){this._paused=!0},Rs.prototype.resume=function(){this._paused=!1,this._setupAutoPull(!0),this._state.pull(this)},Rs.prototype.onNext=function(e){var t=new Es.Record(this._fieldKeys,e,this._fieldLookup);this._observers.some(function(e){return e.onNext})?this._observers.forEach(function(e){e.onNext&&e.onNext(t)}):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))},Rs.prototype.onCompleted=function(e){this._state.onSuccess(this,e)},Rs.prototype.onError=function(e){this._state.onError(this,e)},Rs.prototype.cancel=function(){this._discard=!0},Rs.prototype.prepareToHandleSingleResponse=function(){this._head=[],this._fieldKeys=[],this._setState(qs.STREAMING)},Rs.prototype.markCompleted=function(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(qs.SUCCEEDED)},Rs.prototype.subscribe=function(e){if(this._head&&e.onKeys&&e.onKeys(this._head),0<this._queuedRecords.length&&e.onNext)for(var t=0;t<this._queuedRecords.length;t++)e.onNext(this._queuedRecords[t]),this._queuedRecords.length-t-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===qs.READY)&&this._handleStreaming();this._tail&&e.onCompleted&&e.onCompleted(this._tail),this._error&&e.onError(this._error),this._observers.push(e),this._state===qs.READY&&this._handleStreaming()},Rs.prototype._handleHasMore=function(e){this._setState(qs.READY),this._handleStreaming(),delete e.has_more},Rs.prototype._handlePullSuccess=function(e){var t,r=this,n=Object.assign(this._server?{server:this._server}:{},this._meta,e);[void 0,null,"r","w","rw","s"].includes(n.type)?(this._setState(qs.SUCCEEDED),e=null,t=function(){r._tail=n,r._observers.some(function(e){return e.onCompleted})&&r._observers.forEach(function(e){e.onCompleted&&e.onCompleted(n)}),r._afterComplete&&r._afterComplete(n)},(e=this._beforeComplete?this._beforeComplete(n):e)?Promise.resolve(e).then(t):t()):this.onError((0,Es.newError)('Server returned invalid query type. Expected one of [undefined, null, "r", "w", "rw", "s"] but got \''.concat(n.type,"'"),Ps))},Rs.prototype._handleRunSuccess=function(e,t){var r=this;if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},e.fields&&0<e.fields.length){this._fieldKeys=e.fields;for(var n=0;n<e.fields.length;n++)this._fieldLookup[e.fields[n]]=n;delete e.fields}null!==e.qid&&void 0!==e.qid&&(this._queryId=e.qid,delete e.qid),this._storeMetadataForCompletion(e);var o=null,i=(this._beforeKeys&&(o=this._beforeKeys(this._fieldKeys)),function(){r._head=r._fieldKeys,r._observers.some(function(e){return e.onKeys})&&r._observers.forEach(function(e){e.onKeys&&e.onKeys(r._fieldKeys)}),r._afterKeys&&r._afterKeys(r._fieldKeys),t()});o?Promise.resolve(o).then(i):i()}},Rs.prototype._handleError=function(t){function e(){r._observers.some(function(e){return e.onError})&&r._observers.forEach(function(e){e.onError&&e.onError(t)}),r._afterError&&r._afterError(t)}var r=this,n=(this._setState(qs.FAILED),this._error=t,null);this._beforeError&&(n=this._beforeError(t));n?Promise.resolve(n).then(e):e()},Rs.prototype._handleStreaming=function(){this._head&&this._observers.some(function(e){return e.onNext||e.onCompleted})&&(this._paused||!this._discard&&!this._autoPull||this._more())},Rs.prototype._more=function(){this._discard?this._discardFunction(this._queryId,this):this._moreFunction(this._queryId,this._fetchSize,this),this._setState(qs.STREAMING)},Rs.prototype._storeMetadataForCompletion=function(e){for(var t,r=Object.keys(e),n=r.length;n--;)t=r[n],this._meta[t]=e[t]},Rs.prototype._setState=function(e){this._state=e},Rs.prototype._setupAutoPull=function(){this._autoPull=!0};var Is,_=Rs;function Rs(e){var e=void 0===e?{}:e,t=e.reactive,t=void 0!==t&&t,r=e.moreFunction,n=e.discardFunction,o=e.fetchSize,o=void 0===o?Ss:o,i=e.beforeError,s=e.afterError,a=e.beforeKeys,u=e.afterKeys,c=e.beforeComplete,l=e.afterComplete,f=e.server,h=e.highRecordWatermark,h=void 0===h?Number.MAX_VALUE:h,e=e.lowRecordWatermark,e=void 0===e?Number.MAX_VALUE:e,p=Is.call(this)||this;return p._fieldKeys=null,p._fieldLookup=null,p._head=null,p._queuedRecords=[],p._tail=null,p._error=null,p._observers=[],p._meta={},p._server=f,p._beforeError=i,p._afterError=s,p._beforeKeys=a,p._afterKeys=u,p._beforeComplete=c,p._afterComplete=l,p._queryId=null,p._moreFunction=r,p._discardFunction=n,p._discard=!1,p._fetchSize=o,p._lowRecordWatermark=e,p._highRecordWatermark=h,p._setState(t?qs.READY:qs.READY_STREAMING),p._setupAutoPull(),p._paused=!1,p}b.ResultStreamObserver=_;O(Ns,ks=m),Ns.prototype.onNext=function(e){this.onError((0,Es.newError)("Received RECORD when initializing "+Es.json.stringify(e)))},Ns.prototype.onError=function(e){this._onError&&this._onError(e)},Ns.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)};var ks,a=Ns;function Ns(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=ks.call(this)||this;return r._onError=t,r._onCompleted=e,r}b.LoginObserver=a;O(As,js=m),As.prototype.onNext=function(e){this.onError((0,Es.newError)("Received RECORD when resetting: received record is: "+Es.json.stringify(e),Ps))},As.prototype.onError=function(e){e.code===Ps&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},As.prototype.onCompleted=function(e){this._onComplete&&this._onComplete(e)};var js,n=As;function As(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onComplete,n=js.call(this)||this;return n._onProtocolError=t,n._onError=r,n._onComplete=e,n}b.ResetObserver=n;O(Us,Ds=_);var Ds,I=Us;function Us(e){var t=e.error,e=e.onError,e=Ds.call(this,{beforeError:e})||this;return e.onError(t),e}b.FailedObserver=I;O(Ls,Ms=_);var Ms,o=Ls;function Ls(){var e=Ms.call(this)||this;return Ms.prototype.markCompleted.call(e),e}b.CompletedObserver=o;O(Bs,xs=m),Bs.prototype.onNext=function(e){this._records.push(e)},Bs.prototype.onError=function(e){e.code===Ps&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},Bs.prototype.onCompleted=function(){null!==this._records&&1!==this._records.length?this.onError((0,Es.newError)("Illegal response from router. Received "+this._records.length+" records but expected only one.\n"+Es.json.stringify(this._records),Ps)):this._onCompleted&&this._onCompleted(Ts.default.ofRecord(this._records[0]))};var xs,P=Bs;function Bs(e){var t=e.resultObserver,r=e.onProtocolError,n=e.onError,e=e.onCompleted,o=xs.call(this)||this;return o._resultObserver=t,o._onError=n,o._onCompleted=e,o._records=[],o._onProtocolError=r,t.subscribe(o),o}b.ProcedureRouteObserver=P;O(Hs,Fs=m),Hs.prototype.onNext=function(e){this.onError((0,Es.newError)("Received RECORD when resetting: received record is: "+Es.json.stringify(e),Ps))},Hs.prototype.onError=function(e){e.code===Ps&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},Hs.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(Ts.default.ofMessageResponse(e))};var Fs,d=Hs;function Hs(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onCompleted,n=Fs.call(this)||this;return n._onProtocolError=t,n._onError=r,n._onCompleted=e,n}b.RouteObserver=d;var qs={READY_STREAMING:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){e._setState(qs.STREAMING)})},onError:function(e,t){e._handleError(t)},name:function(){return"READY_STREAMING"},pull:function(){}},READY:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){return e._handleStreaming()})},onError:function(e,t){e._handleError(t)},name:function(){return"READY"},pull:function(e){return e._more()}},STREAMING:{onSuccess:function(e,t){t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:function(e,t){e._handleError(t)},name:function(){return"STREAMING"},pull:function(){}},FAILED:{onError:function(e){},name:function(){return"FAILED"},pull:function(){}},SUCCEEDED:{name:function(){return"SUCCEEDED"},pull:function(){}}},Vs=(Object.defineProperty(C,"__esModule",{value:!0}),C.assertImpersonatedUserIsEmpty=C.assertTxConfigIsEmpty=C.assertDatabaseIsEmpty=void 0,t);C.assertTxConfigIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e&&!e.isEmpty())throw t((e=(0,Vs.newError)("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality")).message),r.onError(e),e},C.assertDatabaseIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((e=(0,Vs.newError)("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality")).message),r.onError(e),e},C.assertImpersonatedUserIsEmpty=function(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((t=(0,Vs.newError)("Driver is connected to the database that does not support user impersonation. Please upgrade to neo4j 4.4.0 or later in order to use this functionality. "+"Trying to impersonate ".concat(e,"."))).message),r.onError(t),t};y={},w={},g={},i={};Object.defineProperty(i,"__esModule",{value:!0}),i.identity=void 0,i.identity=function(e){return e};var zs=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Ws=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&zs(t,e,r);return Ws(t,e),t},f=(Object.defineProperty(g,"__esModule",{value:!0}),g.functional=void 0,g.functional=v(i),{}),Gs=(Object.defineProperty(f,"__esModule",{value:!0}),f.verifyStructSize=f.Structure=void 0,t),Ks=Gs.error.PROTOCOL_ERROR,a=(Object.defineProperty(Ys.prototype,"size",{get:function(){return this.fields.length},enumerable:!1,configurable:!0}),Ys.prototype.toString=function(){for(var e="",t=0;t<this.fields.length;t++)0<t&&(e+=", "),e+=this.fields[t];return"Structure("+this.signature+", ["+e+"])"},Ys);function Ys(e,t){this.signature=e,this.fields=t}f.Structure=a,f.verifyStructSize=function(e,t,r){if(t!==r)throw(0,Gs.newError)("Wrong struct size for ".concat(e,", expected ").concat(t," but was ").concat(r),Ks)},f.default=a,Object.defineProperty(w,"__esModule",{value:!0}),w.Unpacker=w.Packer=void 0;var Zs=r,Xs=g,Qs=f,$s=t,Js=$s.error.PROTOCOL_ERROR;function ea(e){this._ch=e,this._byteArraysSupported=!0}function ta(e,t){void 0===t&&(t=!1),this._disableLosslessIntegers=e=void 0===e?!1:e,this._useBigInt=t}ea.prototype.packable=function(o,i){var e,s=this;void 0===i&&(i=Xs.functional.identity);try{o=i(o)}catch(e){return function(){throw e}}if(null===o)return function(){return s._ch.writeUInt8(192)};if(!0===o)return function(){return s._ch.writeUInt8(195)};if(!1===o)return function(){return s._ch.writeUInt8(194)};if("number"==typeof o)return function(){return s.packFloat(o)};if("string"==typeof o)return function(){return s.packString(o)};if("bigint"==typeof o)return function(){return s.packInteger((0,$s.int)(o))};if((0,$s.isInt)(o))return function(){return s.packInteger(o)};if(o instanceof Int8Array)return function(){return s.packBytes(o)};if(o instanceof Array)return function(){s.packListHeader(o.length);for(var e=0;e<o.length;e++)s.packable(void 0===o[e]?null:o[e],i)()};if(null!=(e=o)&&"function"==typeof e[Symbol.iterator])return this.packableIterable(o,i);if(o instanceof Qs.Structure){for(var t=[],r=0;r<o.fields.length;r++)t[r]=this.packable(o.fields[r],i);return function(){return s.packStruct(o.signature,t)}}return"object"==typeof o?function(){for(var e=Object.keys(o),t=0,r=0;r<e.length;r++)void 0!==o[e[r]]&&t++;s.packMapHeader(t);for(r=0;r<e.length;r++){var n=e[r];void 0!==o[n]&&(s.packString(n),s.packable(o[n],i)())}}:this._nonPackableValue("Unable to pack the given value: ".concat(o))},ea.prototype.packableIterable=function(t,e){try{var r=Array.from(t);return this.packable(r,e)}catch(e){throw(0,$s.newError)("Cannot pack given iterable, ".concat(e.message,": ").concat(t))}},ea.prototype.packStruct=function(e,t){this.packStructHeader((t=t||[]).length,e);for(var r=0;r<t.length;r++)t[r]()},ea.prototype.packInteger=function(e){var t=e.high,r=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(r):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(200),this._ch.writeInt8(r)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(201),this._ch.writeInt16(r)):(e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?this._ch.writeUInt8(202):(this._ch.writeUInt8(203),this._ch.writeInt32(t)),this._ch.writeInt32(r))},ea.prototype.packFloat=function(e){this._ch.writeUInt8(193),this._ch.writeFloat64(e)},ea.prototype.packString=function(e){var e=Zs.utf8.encode(e),t=e.length;if(t<16)this._ch.writeUInt8(128|t);else if(t<256)this._ch.writeUInt8(208),this._ch.writeUInt8(t);else{if(t<65536)this._ch.writeUInt8(209),this._ch.writeUInt8(t/256>>0);else{if(!(t<4294967296))throw(0,$s.newError)("UTF-8 strings of size "+t+" are not supported");this._ch.writeUInt8(210),this._ch.writeUInt8((t/16777216>>0)%256),this._ch.writeUInt8((t/65536>>0)%256),this._ch.writeUInt8((t/256>>0)%256)}this._ch.writeUInt8(t%256)}this._ch.writeBytes(e)},ea.prototype.packListHeader=function(e){if(e<16)this._ch.writeUInt8(144|e);else if(e<256)this._ch.writeUInt8(212),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(213);else{if(!(e<4294967296))throw(0,$s.newError)("Lists of size "+e+" are not supported");this._ch.writeUInt8(214),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},ea.prototype.packBytes=function(e){if(!this._byteArraysSupported)throw(0,$s.newError)("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(e.length);for(var t=0;t<e.length;t++)this._ch.writeInt8(e[t])},ea.prototype.packBytesHeader=function(e){if(e<256)this._ch.writeUInt8(204),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(205);else{if(!(e<4294967296))throw(0,$s.newError)("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(206),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},ea.prototype.packMapHeader=function(e){if(e<16)this._ch.writeUInt8(160|e);else if(e<256)this._ch.writeUInt8(216),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(217),this._ch.writeUInt8(e/256>>0);else{if(!(e<4294967296))throw(0,$s.newError)("Maps of size "+e+" are not supported");this._ch.writeUInt8(218),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256)}this._ch.writeUInt8(e%256)}},ea.prototype.packStructHeader=function(e,t){if(e<16)this._ch.writeUInt8(176|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(220),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw(0,$s.newError)("Structures of size "+e+" are not supported");this._ch.writeUInt8(221),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}},ea.prototype.disableByteArrays=function(){this._byteArraysSupported=!1},ea.prototype._nonPackableValue=function(e){return function(){throw(0,$s.newError)(e,Js)}},w.Packer=ea,ta.prototype.unpack=function(e,t){void 0===t&&(t=Xs.functional.identity);var r=e.readUInt8(),n=240&r,o=15&r;if(192===r)return null;var i=this._unpackBoolean(r);if(null!==i)return i;i=this._unpackNumberOrInteger(r,e);if(null!==i){if((0,$s.isInt)(i)){if(this._useBigInt)return i.toBigInt();if(this._disableLosslessIntegers)return i.toNumberOrInfinity()}return i}i=this._unpackString(r,n,o,e);if(null!==i)return i;i=this._unpackList(r,n,o,e,t);if(null!==i)return i;i=this._unpackByteArray(r,e);if(null!==i)return i;i=this._unpackMap(r,n,o,e,t);if(null!==i)return i;i=this._unpackStruct(r,n,o,e,t);if(null!==i)return i;throw(0,$s.newError)("Unknown packed value with marker "+r.toString(16))},ta.prototype.unpackInteger=function(e){var t=e.readUInt8(),e=this._unpackInteger(t,e);if(null==e)throw(0,$s.newError)("Unable to unpack integer value with marker "+t.toString(16));return e},ta.prototype._unpackBoolean=function(e){return 195===e||194!==e&&null},ta.prototype._unpackNumberOrInteger=function(e,t){return 193===e?t.readFloat64():this._unpackInteger(e,t)},ta.prototype._unpackInteger=function(e,t){var r;return 0<=e&&e<128?(0,$s.int)(e):240<=e&&e<256?(0,$s.int)(e-256):200===e?(0,$s.int)(t.readInt8()):201===e?(0,$s.int)(t.readInt16()):202===e?(r=t.readInt32(),(0,$s.int)(r)):203===e?(r=t.readInt32(),e=t.readInt32(),new $s.Integer(e,r)):null},ta.prototype._unpackString=function(e,t,r,n){return 128===t?Zs.utf8.decode(n,r):208===e?Zs.utf8.decode(n,n.readUInt8()):209===e?Zs.utf8.decode(n,n.readUInt16()):210===e?Zs.utf8.decode(n,n.readUInt32()):null},ta.prototype._unpackList=function(e,t,r,n,o){return 144===t?this._unpackListWithSize(r,n,o):212===e?this._unpackListWithSize(n.readUInt8(),n,o):213===e?this._unpackListWithSize(n.readUInt16(),n,o):214===e?this._unpackListWithSize(n.readUInt32(),n,o):null},ta.prototype._unpackListWithSize=function(e,t,r){for(var n=[],o=0;o<e;o++)n.push(this.unpack(t,r));return n},ta.prototype._unpackByteArray=function(e,t){return 204===e?this._unpackByteArrayWithSize(t.readUInt8(),t):205===e?this._unpackByteArrayWithSize(t.readUInt16(),t):206===e?this._unpackByteArrayWithSize(t.readUInt32(),t):null},ta.prototype._unpackByteArrayWithSize=function(e,t){for(var r=new Int8Array(e),n=0;n<e;n++)r[n]=t.readInt8();return r},ta.prototype._unpackMap=function(e,t,r,n,o){return 160===t?this._unpackMapWithSize(r,n,o):216===e?this._unpackMapWithSize(n.readUInt8(),n,o):217===e?this._unpackMapWithSize(n.readUInt16(),n,o):218===e?this._unpackMapWithSize(n.readUInt32(),n,o):null},ta.prototype._unpackMapWithSize=function(e,t,r){for(var n={},o=0;o<e;o++)n[this.unpack(t,r)]=this.unpack(t,r);return n},ta.prototype._unpackStruct=function(e,t,r,n,o){return 176===t?this._unpackStructWithSize(r,n,o):220===e?this._unpackStructWithSize(n.readUInt8(),n,o):221===e?this._unpackStructWithSize(n.readUInt16(),n,o):null},ta.prototype._unpackStructWithSize=function(e,t,r){for(var n=t.readUInt8(),o=new Qs.Structure(n,[]),i=0;i<e;i++)o.fields.push(this.unpack(t,r));return r(o)},w.Unpacker=ta;var ra,na,n={},I=e&&e.__extends||(ra=function(e,t){return(ra=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ra(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),oa=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),ia=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),_=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&oa(t,e,r);return ia(t,e),t},o=(Object.defineProperty(n,"__esModule",{value:!0}),n.Unpacker=n.Packer=void 0,_(w)),P=(na=o.Packer,I(sa,na),sa.prototype.disableByteArrays=function(){throw new Error("Bolt V2 should always support byte arrays")},sa);function sa(){return null!==na&&na.apply(this,arguments)||this}n.Packer=P;aa=o.Unpacker,I(ua,aa);var aa,O=ua;function ua(e,t){return aa.call(this,e=void 0===e?!1:e,t=void 0===t?!1:t)||this}n.Unpacker=O;var ca=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),la=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),m=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ca(t,e,r);return la(t,e),t},d=(Object.defineProperty(y,"__esModule",{value:!0}),y.structure=y.v2=y.v1=void 0,m(w)),v=(y.v1=d,m(n)),a=(y.v2=v,m(f)),g=(y.structure=a,y.default=v,{}),fa=(Object.defineProperty(g,"__esModule",{value:!0}),t),_=fa.internal.constants,ha=_.ACCESS_MODE_READ,pa=_.FETCH_ALL,da=fa.internal.util.assertString,P=(_a.init=function(e,t){return new _a(1,[e,t],function(){return"INIT ".concat(e," {...}")})},_a.run=function(e,t){return new _a(16,[e,t],function(){return"RUN ".concat(e," ").concat(fa.json.stringify(t))})},_a.pullAll=function(){return ma},_a.reset=function(){return ga},_a.hello=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);t=Object.assign({user_agent:e},t);return r&&(t.routing=r),n&&(t.patch_bolt=n),new _a(1,[t],function(){return"HELLO {user_agent: '".concat(e,"', ...}")})},_a.begin=function(e){var e=void 0===e?{}:e,t=ya(e.bookmarks,e.txConfig,e.database,e.mode,e.impersonatedUser);return new _a(17,[t],function(){return"BEGIN ".concat(fa.json.stringify(t))})},_a.commit=function(){return va},_a.rollback=function(){return wa},_a.runWithMetadata=function(e,t,r){var r=void 0===r?{}:r,n=ya(r.bookmarks,r.txConfig,r.database,r.mode,r.impersonatedUser);return new _a(16,[e,t,n],function(){return"RUN ".concat(e," ").concat(fa.json.stringify(t)," ").concat(fa.json.stringify(n))})},_a.goodbye=function(){return Oa},_a.pull=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?-1:t,e=e.n,r=ba(null==t?-1:t,(void 0===e?pa:e)||pa);return new _a(63,[r],function(){return"PULL ".concat(fa.json.stringify(r))})},_a.discard=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?-1:t,e=e.n,r=ba(null==t?-1:t,(void 0===e?pa:e)||pa);return new _a(47,[r],function(){return"DISCARD ".concat(fa.json.stringify(r))})},_a.route=function(e,t,r){return new _a(102,[e=void 0===e?{}:e,t=void 0===t?[]:t,r=void 0===r?null:r],function(){return"ROUTE ".concat(fa.json.stringify(e)," ").concat(fa.json.stringify(t)," ").concat(r)})},_a.routeV4x4=function(e,t,r){void 0===e&&(e={}),void 0===t&&(t=[]);var n={};return(r=void 0===r?{}:r).databaseName&&(n.db=r.databaseName),r.impersonatedUser&&(n.imp_user=r.impersonatedUser),new _a(102,[e,t,n],function(){return"ROUTE ".concat(fa.json.stringify(e)," ").concat(fa.json.stringify(t)," ").concat(fa.json.stringify(n))})},_a);function _a(e,t,r){this.signature=e,this.fields=t,this.toString=r}function ya(e,t,r,n,o){var i={};return e.isEmpty()||(i.bookmarks=e.values()),null!==t.timeout&&(i.tx_timeout=t.timeout),t.metadata&&(i.tx_metadata=t.metadata),r&&(i.db=da(r,"database")),o&&(i.imp_user=da(o,"impersonatedUser")),n===ha&&(i.mode="r"),i}function ba(e,t){t={n:(0,fa.int)(t)};return-1!==e&&(t.qid=(0,fa.int)(e)),t}var ma=new(g.default=P)(63,[],function(){return"PULL_ALL"}),ga=new P(15,[],function(){return"RESET"}),va=new P(18,[],function(){return"COMMIT"}),wa=new P(19,[],function(){return"ROLLBACK"}),Oa=new P(2,[],function(){return"GOODBYE"}),o={},I={},Ea=(Object.defineProperty(I,"__esModule",{value:!0}),I.TypeTransformer=void 0,y),Ta=t.internal.objectUtil;function Sa(e){this._transformers=e,this._transformersPerSignature=new Map(e.map(function(e){return[e.signature,e]})),this.fromStructure=this.fromStructure.bind(this),this.toStructure=this.toStructure.bind(this),Object.freeze(this)}function Pa(e){var t=e.signature,r=e.fromStructure,n=e.toStructure,e=e.isTypeInstance;this.signature=t,this.isTypeInstance=e,this.fromStructure=r,this.toStructure=n,Object.freeze(this)}Sa.prototype.fromStructure=function(e){try{return e instanceof Ea.structure.Structure&&this._transformersPerSignature.has(e.signature)?(0,this._transformersPerSignature.get(e.signature).fromStructure)(e):e}catch(e){return Ta.createBrokenObject(e)}},Sa.prototype.toStructure=function(t){var e=this._transformers.find(function(e){return(0,e.isTypeInstance)(t)});return void 0!==e?e.toStructure(t):t},I.default=Sa,Pa.prototype.extendsWith=function(e){var t=e.signature,r=e.fromStructure,n=e.toStructure,e=e.isTypeInstance;return new Pa({signature:t||this.signature,fromStructure:r||this.fromStructure,toStructure:n||this.toStructure,isTypeInstance:e||this.isTypeInstance})},I.TypeTransformer=Pa;var Ca=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},Ia=(Object.defineProperty(o,"__esModule",{value:!0}),t),Ra=y,ka=I,Na=Ia.error.PROTOCOL_ERROR;o.default={createNodeTransformer:function(){return new ka.TypeTransformer({signature:78,isTypeInstance:function(e){return e instanceof Ia.Node},toStructure:function(e){throw(0,Ia.newError)("It is not allowed to pass nodes in query parameters, given: ".concat(e),Na)},fromStructure:function(e){Ra.structure.verifyStructSize("Node",3,e.size);var e=Ca(e.fields,3),t=e[0],r=e[1],e=e[2];return new Ia.Node(t,r,e)}})},createRelationshipTransformer:function(){return new ka.TypeTransformer({signature:82,isTypeInstance:function(e){return e instanceof Ia.Relationship},toStructure:function(e){throw(0,Ia.newError)("It is not allowed to pass relationships in query parameters, given: ".concat(e),Na)},fromStructure:function(e){Ra.structure.verifyStructSize("Relationship",5,e.size);var e=Ca(e.fields,5),t=e[0],r=e[1],n=e[2],o=e[3],e=e[4];return new Ia.Relationship(t,r,n,o,e)}})},createUnboundRelationshipTransformer:function(){return new ka.TypeTransformer({signature:114,isTypeInstance:function(e){return e instanceof Ia.UnboundRelationship},toStructure:function(e){throw(0,Ia.newError)("It is not allowed to pass unbound relationships in query parameters, given: ".concat(e),Na)},fromStructure:function(e){Ra.structure.verifyStructSize("UnboundRelationship",3,e.size);var e=Ca(e.fields,3),t=e[0],r=e[1],e=e[2];return new Ia.UnboundRelationship(t,r,e)}})},createPathTransformer:function(){return new ka.TypeTransformer({signature:80,isTypeInstance:function(e){return e instanceof Ia.Path},toStructure:function(e){throw(0,Ia.newError)("It is not allowed to pass paths in query parameters, given: ".concat(e),Na)},fromStructure:function(e){Ra.structure.verifyStructSize("Path",3,e.size);for(var e=Ca(e.fields,3),t=e[0],r=e[1],n=e[2],o=[],i=t[0],s=0;s<n.length;s+=2){var a=t[n[s+1]],u=(0,Ia.toNumber)(n[s]),c=void 0;0<u?(c=r[u-1])instanceof Ia.UnboundRelationship&&(r[u-1]=c=c.bindTo(i,a)):(c=r[-u-1])instanceof Ia.UnboundRelationship&&(r[-u-1]=c=c.bindTo(a,i)),o.push(new Ia.PathSegment(i,c,a)),i=a}return new Ia.Path(t[0],t[t.length-1],o)}})}};var O=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ja=(Object.defineProperty(u,"__esModule",{value:!0}),C),Aa=y,Da=O(g),Ua=b,w=t,Ma=O(o),La=O(I),xa=w.internal.bookmarks.Bookmarks,d=w.internal.constants,Ba=d.ACCESS_MODE_WRITE,Fa=d.BOLT_PROTOCOL_V1,Ha=(w.internal.logger.Logger,w.internal.txConfig.TxConfig),n=(Object.defineProperty(j.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new La.default(Object.values(Ma.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"version",{get:function(){return Fa},enumerable:!1,configurable:!0}),j.prototype.packer=function(){return this._packer},j.prototype.packable=function(e){return this._packer.packable(e,this.transformer.toStructure)},j.prototype.unpacker=function(){return this._unpacker},j.prototype.unpack=function(e){return this._unpacker.unpack(e,this.transformer.fromStructure)},j.prototype.transformMetadata=function(e){return e},j.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.authToken,o=e.onError,i=e.onComplete,e=new Ua.LoginObserver({onError:function(e){return t._onLoginError(e,o)},onCompleted:function(e){return t._onLoginCompleted(e,i)}});return this.write(Da.default.init(r,n),e,!0),e},j.prototype.prepareToClose=function(){},j.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,s=e.beforeError,a=e.afterError,u=e.beforeComplete,e=e.afterComplete;return this.run("BEGIN",t?t.asBeginTransactionParameters():{},{bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i,beforeError:s,afterError:a,beforeComplete:u,afterComplete:e,flush:!1})},j.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete;return this.run("COMMIT",{},{bookmarks:xa.empty(),txConfig:Ha.empty(),mode:Ba,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e})},j.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete;return this.run("ROLLBACK",{},{bookmarks:xa.empty(),txConfig:Ha.empty(),mode:Ba,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e})},j.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=(r.bookmarks,r.txConfig),o=r.database,i=(r.mode,r.impersonatedUser),s=r.beforeKeys,a=r.afterKeys,u=r.beforeError,c=r.afterError,l=r.beforeComplete,f=r.afterComplete,h=r.flush,h=void 0===h||h,p=r.highRecordWatermark,p=void 0===p?Number.MAX_VALUE:p,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,s=new Ua.ResultStreamObserver({server:this._server,beforeKeys:s,afterKeys:a,beforeError:u,afterError:c,beforeComplete:l,afterComplete:f,highRecordWatermark:p,lowRecordWatermark:r});return(0,ja.assertTxConfigIsEmpty)(n,this._onProtocolError,s),(0,ja.assertDatabaseIsEmpty)(o,this._onProtocolError,s),(0,ja.assertImpersonatedUserIsEmpty)(i,this._onProtocolError,s),this.write(Da.default.run(e,t),s,!1),this.write(Da.default.pullAll(),s,h),s},Object.defineProperty(j.prototype,"currentFailure",{get:function(){return this._responseHandler.currentFailure},enumerable:!1,configurable:!0}),j.prototype.reset=function(e){var e=void 0===e?{}:e,t=e.onError,e=e.onComplete,t=new Ua.ResetObserver({onProtocolError:this._onProtocolError,onError:t,onComplete:e});return this.write(Da.default.reset(),t,!0),t},j.prototype._createPacker=function(e){return new Aa.v1.Packer(e)},j.prototype._createUnpacker=function(e,t){return new Aa.v1.Unpacker(e,t)},j.prototype.write=function(e,t,r){this.queueObserverIfProtocolIsNotBroken(t)&&(this._log.isDebugEnabled()&&this._log.debug("C: ".concat(e)),this._lastMessageSignature=e.signature,t=new Aa.structure.Structure(e.signature,e.fields),this.packable(t)(),this._chunker.messageBoundary(),r)&&this._chunker.flush()},j.prototype.isLastMessageLogin=function(){return 1===this._lastMessageSignature},j.prototype.isLastMessageReset=function(){return 15===this._lastMessageSignature},j.prototype.notifyFatalError=function(e){return this._fatalError=e,this._responseHandler._notifyErrorToObservers(e)},j.prototype.updateCurrentObserver=function(){return this._responseHandler._updateCurrentObserver()},j.prototype.hasOngoingObservableRequests=function(){return this._responseHandler.hasOngoingObservableRequests()},j.prototype.queueObserverIfProtocolIsNotBroken=function(e){return this.isBroken()?(this.notifyFatalErrorToObserver(e),!1):this._responseHandler._queueObserver(e)},j.prototype.isBroken=function(){return!!this._fatalError},j.prototype.notifyFatalErrorToObserver=function(e){e&&e.onError&&e.onError(this._fatalError)},j.prototype.resetFailure=function(){this._responseHandler._resetFailure()},j.prototype._onLoginCompleted=function(e,t){var r;e&&(r=e.server,this._server.version||(this._server.version=r)),t&&t(e)},j.prototype._onLoginError=function(e,t){this._onProtocolError(e.message),t&&t(e)},j);function j(e,t,r,n,o,i){var r=void 0===r?{}:r,s=r.disableLosslessIntegers,r=r.useBigInt;void 0===n&&(n=function(){return null}),this._server=e||{},this._chunker=t,this._packer=this._createPacker(t),this._unpacker=this._createUnpacker(s,r),this._responseHandler=n(this),this._log=o,this._onProtocolError=i,this._fatalError=null,this._lastMessageSignature=null,this._config={disableLosslessIntegers:s,useBigInt:r}}u.default=n;var m={},f={},a={},qa=(Object.defineProperty(a,"__esModule",{value:!0}),a.epochSecondAndNanoToLocalDateTime=a.nanoOfDayToLocalTime=a.epochDayToDate=void 0,t),v=qa.internal.temporalUtil,Va=v.DAYS_0000_TO_1970,za=v.DAYS_PER_400_YEAR_CYCLE,Wa=v.NANOS_PER_HOUR,Ga=v.NANOS_PER_MINUTE,Ka=v.NANOS_PER_SECOND,Ya=v.SECONDS_PER_DAY,Za=v.floorDiv,Xa=v.floorMod;function Qa(e){var e=(e=(0,qa.int)(e)).add(Va).subtract(60),t=(0,qa.int)(0),r=(e.lessThan(0)&&(t=(r=e.add(1).div(za).subtract(1)).multiply(400),e=e.add(r.multiply(-za))),e.multiply(400).add(591).div(za)),n=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400))),e=(n.lessThan(0)&&(r=r.subtract(1),n=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400)))),r=r.add(t),n),t=e.multiply(5).add(2).div(153),n=t.add(2).modulo(12).add(1),e=e.subtract(t.multiply(306).add(5).div(10)).add(1),r=r.add(t.div(10));return new qa.Date(r,n,e)}function $a(e){var t=(e=(0,qa.int)(e)).div(Wa),r=(e=e.subtract(t.multiply(Wa))).div(Ga),n=(e=e.subtract(r.multiply(Ga))).div(Ka),e=e.subtract(n.multiply(Ka));return new qa.LocalTime(t,r,n,e)}a.epochDayToDate=Qa,a.nanoOfDayToLocalTime=$a,a.epochSecondAndNanoToLocalDateTime=function(e,t){var r=Za(e,Ya),e=Xa(e,Ya).multiply(Ka).add(t),t=Qa(r),r=$a(e);return new qa.LocalDateTime(t.year,t.month,t.day,r.hour,r.minute,r.second,r.nanosecond)};var Ja=e&&e.__assign||function(){return(Ja=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},eu=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},A=(Object.defineProperty(f,"__esModule",{value:!0}),t),tu=y,ru=I,nu=a,P=_(o),O=A.internal.temporalUtil,ou=O.dateToEpochDay,iu=O.localDateTimeToEpochSecond,su=O.localTimeToNanoOfDay;function au(e,t,r){if(!t&&!r)return e;var n,o,i,s=Object.create(Object.getPrototypeOf(e));for(n in e)!0===Object.prototype.hasOwnProperty.call(e,n)&&(o=e[n],s[n]=(0,A.isInt)(o)?(i=o,r?i.toBigInt():i.toNumberOrInfinity()):o);return Object.freeze(s),s}f.default=Ja(Ja({},P.default),{createPoint2DTransformer:function(){return new ru.TypeTransformer({signature:88,isTypeInstance:function(e){return(0,A.isPoint)(e)&&(null===e.z||void 0===e.z)},toStructure:function(e){return new tu.structure.Structure(88,[(0,A.int)(e.srid),e.x,e.y])},fromStructure:function(e){tu.structure.verifyStructSize("Point2D",3,e.size);var e=eu(e.fields,3),t=e[0],r=e[1],e=e[2];return new A.Point(t,r,e,void 0)}})},createPoint3DTransformer:function(){return new ru.TypeTransformer({signature:89,isTypeInstance:function(e){return(0,A.isPoint)(e)&&null!==e.z&&void 0!==e.z},toStructure:function(e){return new tu.structure.Structure(89,[(0,A.int)(e.srid),e.x,e.y,e.z])},fromStructure:function(e){tu.structure.verifyStructSize("Point3D",4,e.size);var e=eu(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new A.Point(t,r,n,e)}})},createDurationTransformer:function(){return new ru.TypeTransformer({signature:69,isTypeInstance:A.isDuration,toStructure:function(e){var t=(0,A.int)(e.months),r=(0,A.int)(e.days),n=(0,A.int)(e.seconds),e=(0,A.int)(e.nanoseconds);return new tu.structure.Structure(69,[t,r,n,e])},fromStructure:function(e){tu.structure.verifyStructSize("Duration",4,e.size);var e=eu(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new A.Duration(t,r,n,e)}})},createLocalTimeTransformer:function(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new ru.TypeTransformer({signature:116,isTypeInstance:A.isLocalTime,toStructure:function(e){e=su(e.hour,e.minute,e.second,e.nanosecond);return new tu.structure.Structure(116,[e])},fromStructure:function(e){tu.structure.verifyStructSize("LocalTime",1,e.size);e=eu(e.fields,1)[0];return au((0,nu.nanoOfDayToLocalTime)(e),t,r)}})},createTimeTransformer:function(e){var r=e.disableLosslessIntegers,n=e.useBigInt;return new ru.TypeTransformer({signature:84,isTypeInstance:A.isTime,toStructure:function(e){var t=su(e.hour,e.minute,e.second,e.nanosecond),e=(0,A.int)(e.timeZoneOffsetSeconds);return new tu.structure.Structure(84,[t,e])},fromStructure:function(e){tu.structure.verifyStructSize("Time",2,e.size);var e=eu(e.fields,2),t=e[0],e=e[1],t=(0,nu.nanoOfDayToLocalTime)(t);return au(new A.Time(t.hour,t.minute,t.second,t.nanosecond,e),r,n)}})},createDateTransformer:function(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new ru.TypeTransformer({signature:68,isTypeInstance:A.isDate,toStructure:function(e){e=ou(e.year,e.month,e.day);return new tu.structure.Structure(68,[e])},fromStructure:function(e){tu.structure.verifyStructSize("Date",1,e.size);e=eu(e.fields,1)[0];return au((0,nu.epochDayToDate)(e),t,r)}})},createLocalDateTimeTransformer:function(e){var r=e.disableLosslessIntegers,n=e.useBigInt;return new ru.TypeTransformer({signature:100,isTypeInstance:A.isLocalDateTime,toStructure:function(e){var t=iu(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),e=(0,A.int)(e.nanosecond);return new tu.structure.Structure(100,[t,e])},fromStructure:function(e){tu.structure.verifyStructSize("LocalDateTime",2,e.size);var e=eu(e.fields,2),t=e[0],e=e[1];return au((0,nu.epochSecondAndNanoToLocalDateTime)(t,e),r,n)}})},createDateTimeWithZoneIdTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return new ru.TypeTransformer({signature:102,isTypeInstance:function(e){return(0,A.isDateTime)(e)&&null!=e.timeZoneId},toStructure:function(e){var t=iu(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,A.int)(e.nanosecond),e=e.timeZoneId;return new tu.structure.Structure(102,[t,r,e])},fromStructure:function(e){tu.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var e=eu(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,nu.epochSecondAndNanoToLocalDateTime)(t,r);return au(new A.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,null,e),n,o)}})},createDateTimeWithOffsetTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return new ru.TypeTransformer({signature:70,isTypeInstance:function(e){return(0,A.isDateTime)(e)&&null==e.timeZoneId},toStructure:function(e){var t=iu(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,A.int)(e.nanosecond),e=(0,A.int)(e.timeZoneOffsetSeconds);return new tu.structure.Structure(70,[t,r,e])},fromStructure:function(e){tu.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var e=eu(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,nu.epochSecondAndNanoToLocalDateTime)(t,r);return au(new A.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),n,o)}})}});var uu,cu,d=e&&e.__extends||(uu=function(e,t){return(uu=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(m,"__esModule",{value:!0}),w(u)),lu=w(y),v=t,fu=w(f),hu=w(I),pu=v.internal.constants.BOLT_PROTOCOL_V2,_=(cu=n.default,d(du,cu),du.prototype._createPacker=function(e){return new lu.default.Packer(e)},du.prototype._createUnpacker=function(e,t){return new lu.default.Unpacker(e,t)},Object.defineProperty(du.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new hu.default(Object.values(fu.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(du.prototype,"version",{get:function(){return pu},enumerable:!1,configurable:!0}),du);function du(){return null!==cu&&cu.apply(this,arguments)||this}m.default=_;var _u,yu,o={},O={},bu=e&&e.__assign||function(){return(bu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},P=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},w=(Object.defineProperty(O,"__esModule",{value:!0}),P(f)),v=(O.default=bu({},w.default),e&&e.__extends||(_u=function(e,t){return(_u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}_u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),mu=e&&e.__assign||function(){return(mu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},d=(Object.defineProperty(o,"__esModule",{value:!0}),n(m)),gu=n(g),vu=C,wu=b,Ou=n(O),Eu=n(I),Tu=(t.internal.bookmarks.Bookmarks,t.internal.constants.BOLT_PROTOCOL_V3),Su=t.internal.txConfig.TxConfig,Pu="context",Cu="CALL dbms.cluster.routing.getRoutingTable($".concat(Pu,")"),Iu=new wu.StreamObserver,_=(yu=d.default,v(Ru,yu),Object.defineProperty(Ru.prototype,"version",{get:function(){return Tu},enumerable:!1,configurable:!0}),Object.defineProperty(Ru.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Eu.default(Object.values(Ou.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Ru.prototype.transformMetadata=function(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e},Ru.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.authToken,o=e.onError,i=e.onComplete,e=new wu.LoginObserver({onError:function(e){return t._onLoginError(e,o)},onCompleted:function(e){return t._onLoginCompleted(e,i)}});return this.write(gu.default.hello(r,n),e,!0),e},Ru.prototype.prepareToClose=function(){this.write(gu.default.goodbye(),Iu,!0)},Ru.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.impersonatedUser,i=e.mode,s=e.beforeError,a=e.afterError,u=e.beforeComplete,e=e.afterComplete,s=new wu.ResultStreamObserver({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,vu.assertDatabaseIsEmpty)(n,this._onProtocolError,s),(0,vu.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,s),this.write(gu.default.begin({bookmarks:t,txConfig:r,mode:i}),s,!0),s},Ru.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete,t=new wu.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(gu.default.commit(),t,!0),t},Ru.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,n=e.beforeComplete,e=e.afterComplete,t=new wu.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:n,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(gu.default.rollback(),t,!0),t},Ru.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,s=r.impersonatedUser,a=r.mode,u=r.beforeKeys,c=r.afterKeys,l=r.beforeError,f=r.afterError,h=r.beforeComplete,p=r.afterComplete,d=r.flush,d=void 0===d||d,_=r.highRecordWatermark,_=void 0===_?Number.MAX_VALUE:_,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,u=new wu.ResultStreamObserver({server:this._server,beforeKeys:u,afterKeys:c,beforeError:l,afterError:f,beforeComplete:h,afterComplete:p,highRecordWatermark:_,lowRecordWatermark:r});return(0,vu.assertDatabaseIsEmpty)(i,this._onProtocolError,u),(0,vu.assertImpersonatedUserIsEmpty)(s,this._onProtocolError,u),this.write(gu.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,mode:a}),u,!1),this.write(gu.default.pullAll(),u,d),u},Ru.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,n=e.sessionContext,n=void 0===n?{}:n,o=e.onError,e=e.onCompleted,r=this.run(Cu,((t={})[Pu]=void 0===r?{}:r,t),mu(mu({},n),{txConfig:Su.empty()}));return new wu.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:o,onCompleted:e})},Ru);function Ru(){return null!==yu&&yu.apply(this,arguments)||this}o.default=_;var ku,Nu,P={},f={},ju=e&&e.__assign||function(){return(ju=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(f,"__esModule",{value:!0}),w(O)),d=(f.default=ju({},n.default),e&&e.__extends||(ku=function(e,t){return(ku=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ku(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),Au=e&&e.__assign||function(){return(Au=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(P,"__esModule",{value:!0}),v(o)),Du=v(g),Uu=C,Mu=b,Lu=v(f),xu=v(I),w=(t.internal.bookmarks.Bookmarks,t.internal.constants),Bu=w.BOLT_PROTOCOL_V4_0,Fu=w.FETCH_ALL,Hu=t.internal.txConfig.TxConfig,qu="context",Vu="database",zu="CALL dbms.routing.getRoutingTable($".concat(qu,", $").concat(Vu,")"),O=(Nu=_.default,d(Wu,Nu),Object.defineProperty(Wu.prototype,"version",{get:function(){return Bu},enumerable:!1,configurable:!0}),Object.defineProperty(Wu.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new xu.default(Object.values(Lu.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Wu.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.impersonatedUser,i=e.mode,s=e.beforeError,a=e.afterError,u=e.beforeComplete,e=e.afterComplete,s=new Mu.ResultStreamObserver({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,Uu.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,s),this.write(Du.default.begin({bookmarks:t,txConfig:r,database:n,mode:i}),s,!0),s},Wu.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,s=r.impersonatedUser,a=r.mode,u=r.beforeKeys,c=r.afterKeys,l=r.beforeError,f=r.afterError,h=r.beforeComplete,p=r.afterComplete,d=r.flush,d=void 0===d||d,_=r.reactive,_=void 0!==_&&_,y=r.fetchSize,y=void 0===y?Fu:y,b=r.highRecordWatermark,b=void 0===b?Number.MAX_VALUE:b,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,u=new Mu.ResultStreamObserver({server:this._server,reactive:_,fetchSize:y,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:u,afterKeys:c,beforeError:l,afterError:f,beforeComplete:h,afterComplete:p,highRecordWatermark:b,lowRecordWatermark:r}),c=((0,Uu.assertImpersonatedUserIsEmpty)(s,this._onProtocolError,u),_);return this.write(Du.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,database:i,mode:a}),u,c&&d),_||this.write(Du.default.pull({n:y}),u,d),u},Wu.prototype._requestMore=function(e,t,r){this.write(Du.default.pull({stmtId:e,n:t}),r,!0)},Wu.prototype._requestDiscard=function(e,t){this.write(Du.default.discard({stmtId:e}),t,!0)},Wu.prototype._noOp=function(){},Wu.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,n=e.databaseName,n=void 0===n?null:n,o=e.sessionContext,o=void 0===o?{}:o,i=e.onError,e=e.onCompleted,r=this.run(zu,((t={})[qu]=void 0===r?{}:r,t[Vu]=n,t),Au(Au({},o),{txConfig:Hu.empty()}));return new Mu.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:i,onCompleted:e})},Wu);function Wu(){return null!==Nu&&Nu.apply(this,arguments)||this}P.default=O;var Gu,Ku,n={},C={},Yu=e&&e.__assign||function(){return(Yu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},w=(Object.defineProperty(C,"__esModule",{value:!0}),v(f)),_=(C.default=Yu({},w.default),e&&e.__extends||(Gu=function(e,t){return(Gu=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Gu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},O=(Object.defineProperty(n,"__esModule",{value:!0}),d(P)),Zu=d(g),Xu=b,v=t,Qu=d(C),$u=d(I),Ju=v.internal.constants.BOLT_PROTOCOL_V4_1,f=(Ku=O.default,_(ec,Ku),Object.defineProperty(ec.prototype,"version",{get:function(){return Ju},enumerable:!1,configurable:!0}),Object.defineProperty(ec.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new $u.default(Object.values(Qu.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),ec.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.authToken,o=e.onError,i=e.onComplete,e=new Xu.LoginObserver({onError:function(e){return t._onLoginError(e,o)},onCompleted:function(e){return t._onLoginCompleted(e,i)}});return this.write(Zu.default.hello(r,n,this._serversideRouting),e,!0),e},ec);function ec(e,t,r,n,o,i,s){e=Ku.call(this,e,t,r,n=void 0===n?function(){return null}:n,o,i)||this;return e._serversideRouting=s,e}n.default=f;var tc,rc,w={},d={},nc=e&&e.__assign||function(){return(nc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},O=(Object.defineProperty(d,"__esModule",{value:!0}),v(C)),_=(d.default=nc({},O.default),e&&e.__extends||(tc=function(e,t){return(tc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}tc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},v=(Object.defineProperty(w,"__esModule",{value:!0}),f(n)),C=t,oc=f(d),ic=f(I),sc=C.internal.constants.BOLT_PROTOCOL_V4_2,O=(rc=v.default,_(ac,rc),Object.defineProperty(ac.prototype,"version",{get:function(){return sc},enumerable:!1,configurable:!0}),Object.defineProperty(ac.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new ic.default(Object.values(oc.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),ac);function ac(){return null!==rc&&rc.apply(this,arguments)||this}w.default=O;var f={},C={},uc=e&&e.__assign||function(){return(uc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(C,"__esModule",{value:!0}),v(d)),O=(C.default=uc({},_.default),{}),v={},cc=e&&e.__assign||function(){return(cc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(v,"__esModule",{value:!0}),d(C)),lc=(v.default=cc({},_.default),e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}),d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},fc=(Object.defineProperty(O,"__esModule",{value:!0}),y),hc=t,pc=d(v),dc=a,_c=i,yc=hc.internal.temporalUtil.localDateTimeToEpochSecond;function bc(e,t,r){e=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,era:"narrow"}),r=(0,hc.int)(t).multiply(1e3).add((0,hc.int)(r).div(1e6)).toNumber(),e=e.formatToParts(r).reduce(function(e,t){return"era"===t.type?e.adjustEra="B"===t.value.toUpperCase()?function(e){return e.subtract(1).negate()}:_c.identity:"literal"!==t.type&&(e[t.type]=(0,hc.int)(t.value)),e},{}),e.year=e.adjustEra(e.year),r=yc(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond);return e.timeZoneOffsetSeconds=r.subtract(t),e.hour=e.hour.modulo(24),e}function mc(e,t,r){if(!t&&!r)return e;var n,o,i,s=Object.create(Object.getPrototypeOf(e));for(n in e)!0===Object.prototype.hasOwnProperty.call(e,n)&&(o=e[n],s[n]=(0,hc.isInt)(o)?(i=o,r?i.toBigInt():i.toNumberOrInfinity()):o);return Object.freeze(s),s}O.default={createDateTimeWithZoneIdTransformer:function(e,s){var n=e.disableLosslessIntegers,o=e.useBigInt;return pc.default.createDateTimeWithZoneIdTransformer(e).extendsWith({signature:105,fromStructure:function(e){fc.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var e=lc(e.fields,3),t=e[0],r=e[1],e=e[2],t=bc(e,t,r);return mc(new hc.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,(0,hc.int)(r),t.timeZoneOffsetSeconds,e),n,o)},toStructure:function(e){var t=yc(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=null!=e.timeZoneOffsetSeconds?e.timeZoneOffsetSeconds:(r=e.timeZoneId,i=t,o=e.nanosecond,n=bc(r,i,o),n=yc(n.year,n.month,n.day,n.hour,n.minute,n.second,o).subtract(i),i=i.subtract(n),n=bc(r,i,o),yc(n.year,n.month,n.day,n.hour,n.minute,n.second,o).subtract(i)),n=(null==e.timeZoneOffsetSeconds&&s.warn('DateTime objects without "timeZoneOffsetSeconds" property are prune to bugs related to ambiguous times. For instance, 2022-10-30T2:30:00[Europe/Berlin] could be GMT+1 or GMT+2.'),t.subtract(r)),o=(0,hc.int)(e.nanosecond),i=e.timeZoneId;return new fc.structure.Structure(105,[n,o,i])}})},createDateTimeWithOffsetTransformer:function(e){var n=e.disableLosslessIntegers,o=e.useBigInt;return pc.default.createDateTimeWithOffsetTransformer(e).extendsWith({signature:73,toStructure:function(e){var t=yc(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,hc.int)(e.nanosecond),e=(0,hc.int)(e.timeZoneOffsetSeconds),t=t.subtract(e);return new fc.structure.Structure(73,[t,r,e])},fromStructure:function(e){fc.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var e=lc(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,hc.int)(t).add(e),t=(0,dc.epochSecondAndNanoToLocalDateTime)(t,r);return mc(new hc.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),n,o)}})}};var gc,vc,_=e&&e.__extends||(gc=function(e,t){return(gc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}gc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),wc=e&&e.__assign||function(){return(wc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=(Object.defineProperty(f,"__esModule",{value:!0}),d(w)),Oc=d(g),Ec=b,Tc=d(C),Sc=d(O),Pc=d(I),Cc=t.internal.bookmarks.Bookmarks,Ic=t.internal.constants.BOLT_PROTOCOL_V4_3,i=(vc=a.default,_(Rc,vc),Object.defineProperty(Rc.prototype,"version",{get:function(){return Ic},enumerable:!1,configurable:!0}),Object.defineProperty(Rc.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Pc.default(Object.values(Tc.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Rc.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,n=e.sessionContext,n=void 0===n?{}:n,o=e.onError,e=e.onCompleted,o=new Ec.RouteObserver({onProtocolError:this._onProtocolError,onError:o,onCompleted:e}),e=n.bookmarks||Cc.empty();return this.write(Oc.default.route(t,e.values(),r),o,!0),o},Rc.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.authToken,o=e.onError,i=e.onComplete,e=new Ec.LoginObserver({onError:function(e){return t._onLoginError(e,o)},onCompleted:function(e){return void 0!==e.patch_bolt&&t._applyPatches(e.patch_bolt),t._onLoginCompleted(e,i)}});return this.write(Oc.default.hello(r,n,this._serversideRouting,["utc"]),e,!0),e},Rc.prototype._applyPatches=function(e){e.includes("utc")&&this._applyUtcPatch()},Rc.prototype._applyUtcPatch=function(){var t=this;this._transformer=new Pc.default(Object.values(wc(wc({},Tc.default),Sc.default)).map(function(e){return e(t._config,t._log)}))},Rc);function Rc(){return null!==vc&&vc.apply(this,arguments)||this}f.default=i;var kc,Nc,C={},d=e&&e.__extends||(kc=function(e,t){return(kc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}kc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),jc=e&&e.__assign||function(){return(jc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(C,"__esModule",{value:!0}),a(f)),i=t,Ac=a(g),Dc=b,Uc=a(v),Mc=a(O),Lc=a(I),a=i.internal.constants,xc=a.BOLT_PROTOCOL_V4_4,Bc=a.FETCH_ALL,Fc=i.internal.bookmarks.Bookmarks,a=(Nc=_.default,d(Hc,Nc),Object.defineProperty(Hc.prototype,"version",{get:function(){return xc},enumerable:!1,configurable:!0}),Object.defineProperty(Hc.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Lc.default(Object.values(Uc.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Hc.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,n=e.impersonatedUser,n=void 0===n?null:n,o=e.sessionContext,o=void 0===o?{}:o,i=e.onError,e=e.onCompleted,i=new Dc.RouteObserver({onProtocolError:this._onProtocolError,onError:i,onCompleted:e}),e=o.bookmarks||Fc.empty();return this.write(Ac.default.routeV4x4(t,e.values(),{databaseName:r,impersonatedUser:n}),i,!0),i},Hc.prototype.run=function(e,t,r){var r=void 0===r?{}:r,n=r.bookmarks,o=r.txConfig,i=r.database,s=r.mode,a=r.impersonatedUser,u=r.beforeKeys,c=r.afterKeys,l=r.beforeError,f=r.afterError,h=r.beforeComplete,p=r.afterComplete,d=r.flush,d=void 0===d||d,_=r.reactive,_=void 0!==_&&_,y=r.fetchSize,y=void 0===y?Bc:y,b=r.highRecordWatermark,b=void 0===b?Number.MAX_VALUE:b,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,u=new Dc.ResultStreamObserver({server:this._server,reactive:_,fetchSize:y,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:u,afterKeys:c,beforeError:l,afterError:f,beforeComplete:h,afterComplete:p,highRecordWatermark:b,lowRecordWatermark:r}),c=_;return this.write(Ac.default.runWithMetadata(e,t,{bookmarks:n,txConfig:o,database:i,mode:s,impersonatedUser:a}),u,c&&d),_||this.write(Ac.default.pull({n:y}),u,d),u},Hc.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,n=e.database,o=e.mode,i=e.impersonatedUser,s=e.beforeError,a=e.afterError,u=e.beforeComplete,e=e.afterComplete,s=new Dc.ResultStreamObserver({server:this._server,beforeError:s,afterError:a,beforeComplete:u,afterComplete:e});return s.prepareToHandleSingleResponse(),this.write(Ac.default.begin({bookmarks:t,txConfig:r,database:n,mode:o,impersonatedUser:i}),s,!0),s},Hc.prototype._applyUtcPatch=function(){var t=this;this._transformer=new Lc.default(Object.values(jc(jc({},Uc.default),Mc.default)).map(function(e){return e(t._config,t._log)}))},Hc);function Hc(){return null!==Nc&&Nc.apply(this,arguments)||this}C.default=a;var i={},_={},qc=e&&e.__assign||function(){return(qc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Vc=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},zc=(Object.defineProperty(_,"__esModule",{value:!0}),y),Wc=t,Gc=d(v),a=d(O);_.default=qc(qc(qc({},Gc.default),a.default),{createNodeTransformer:function(e){return Gc.default.createNodeTransformer(e).extendsWith({fromStructure:function(e){zc.structure.verifyStructSize("Node",4,e.size);var e=Vc(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Wc.Node(t,r,n,e)}})},createRelationshipTransformer:function(e){return Gc.default.createRelationshipTransformer(e).extendsWith({fromStructure:function(e){zc.structure.verifyStructSize("Relationship",8,e.size);var e=Vc(e.fields,8),t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],a=e[6],e=e[7];return new Wc.Relationship(t,r,n,o,i,s,a,e)}})},createUnboundRelationshipTransformer:function(e){return Gc.default.createUnboundRelationshipTransformer(e).extendsWith({fromStructure:function(e){zc.structure.verifyStructSize("UnboundRelationship",4,e.size);var e=Vc(e.fields,4),t=e[0],r=e[1],n=e[2],e=e[3];return new Wc.UnboundRelationship(t,r,n,e)}})}});var Kc,Yc,v=e&&e.__extends||(Kc=function(e,t){return(Kc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Kc(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},O=(Object.defineProperty(i,"__esModule",{value:!0}),d(C)),Zc=d(_),Xc=d(I),Qc=d(g),$c=b,Jc=t.internal.constants.BOLT_PROTOCOL_V5_0,a=(Yc=O.default,v(el,Yc),Object.defineProperty(el.prototype,"version",{get:function(){return Jc},enumerable:!1,configurable:!0}),Object.defineProperty(el.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new Xc.default(Object.values(Zc.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),el.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,n=e.authToken,o=e.onError,i=e.onComplete,e=new $c.LoginObserver({onError:function(e){return t._onLoginError(e,o)},onCompleted:function(e){return t._onLoginCompleted(e,i)}});return this.write(Qc.default.hello(r,n,this._serversideRouting),e,!0),e},el);function el(){return null!==Yc&&Yc.apply(this,arguments)||this}i.default=a;var _={},tl=(Object.defineProperty(_,"__esModule",{value:!0}),t);function rl(){}function nl(e){return e}var ol={onNext:rl,onCompleted:rl,onError:rl};function il(e){var e=void 0===e?{}:e,t=e.transformMetadata,r=e.log,e=e.observer;this._pendingObservers=[],this._log=r,this._transformMetadata=t||nl,this._observer=Object.assign({onPendingObserversChange:rl,onError:rl,onFailure:rl,onErrorApplyTransformation:nl},e)}Object.defineProperty(il.prototype,"currentFailure",{get:function(){return this._currentFailure},enumerable:!1,configurable:!0}),il.prototype.handleResponse=function(e){var t=e.fields[0];switch(e.signature){case 113:this._log.isDebugEnabled()&&this._log.debug("S: RECORD ".concat(tl.json.stringify(e))),this._currentObserver.onNext(t);break;case 112:this._log.isDebugEnabled()&&this._log.debug("S: SUCCESS ".concat(tl.json.stringify(e)));try{var r=this._transformMetadata(t);this._currentObserver.onCompleted(r)}finally{this._updateCurrentObserver()}break;case 127:this._log.isDebugEnabled()&&this._log.debug("S: FAILURE ".concat(tl.json.stringify(e)));try{var n=function(e){{if("Neo.TransientError.Transaction.Terminated"===e)return"Neo.ClientError.Transaction.Terminated";if("Neo.TransientError.Transaction.LockClientStopped"===e)return"Neo.ClientError.Transaction.LockClientStopped"}return e}(t.code),o=(0,tl.newError)(t.message,n);this._currentFailure=this._observer.onErrorApplyTransformation(o),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._observer.onFailure(this._currentFailure)}break;case 126:this._log.isDebugEnabled()&&this._log.debug("S: IGNORED ".concat(tl.json.stringify(e)));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError((0,tl.newError)("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._observer.onError((0,tl.newError)("Unknown Bolt protocol message: "+e))}},il.prototype._updateCurrentObserver=function(){this._currentObserver=this._pendingObservers.shift(),this._observer.onPendingObserversChange(this._pendingObservers.length)},il.prototype._queueObserver=function(e){return(e=e||ol).onCompleted=e.onCompleted||rl,e.onError=e.onError||rl,e.onNext=e.onNext||rl,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),this._observer.onPendingObserversChange(this._pendingObservers.length),!0},il.prototype._notifyErrorToObservers=function(e){for(this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(e);0<this._pendingObservers.length;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(e)}},il.prototype.hasOngoingObservableRequests=function(){return null!=this._currentObserver||0<this._pendingObservers.length},il.prototype._resetFailure=function(){this._currentFailure=null},_.default=il;var sl,I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},al=(Object.defineProperty(S,"__esModule",{value:!0}),t),ul=I(u),cl=I(m),ll=I(o),fl=I(P),hl=I(n),pl=I(w),dl=I(f),_l=I(C),yl=I(i),bl=I(_);S.default=function(e){var t=(e=void 0===e?{}:e).version,r=e.chunker,n=e.dechunker,o=e.channel,i=e.disableLosslessIntegers,s=e.useBigInt,a=e.serversideRouting,u=e.server,c=e.log,l=e.observer,f=t,h=u,p=r,d={disableLosslessIntegers:i,useBigInt:s},_=a,y=function(t){var r=new bl.default({transformMetadata:t.transformMetadata.bind(t),log:c,observer:l});return o.onerror=l.onError.bind(l),o.onmessage=function(e){return n.write(e)},n.onmessage=function(e){try{r.handleResponse(t.unpack(e))}catch(e){return l.onError(e)}},r},b=l.onProtocolError.bind(l),m=c;switch(f){case 1:return new ul.default(h,p,d,y,m,b);case 2:return new cl.default(h,p,d,y,m,b);case 3:return new ll.default(h,p,d,y,m,b);case 4:return new fl.default(h,p,d,y,m,b);case 4.1:return new hl.default(h,p,d,y,m,b,_);case 4.2:return new pl.default(h,p,d,y,m,b,_);case 4.3:return new dl.default(h,p,d,y,m,b,_);case 4.4:return new _l.default(h,p,d,y,m,b,_);case 5:return new yl.default(h,p,d,y,m,b,_);default:throw(0,al.newError)("Unknown Bolt protocol version: "+f)}},d=s,sl=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),g=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||sl(t,e,r)},O=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(d,"__esModule",{value:!0}),d.RawRoutingTable=d.BoltProtocol=void 0,v=O(xt),a=O(S),u=O(f),O=O(E),g(b,d),d.BoltProtocol=u.default,d.RawRoutingTable=O.default,d.default={handshake:v.default,create:a.default};m={},o={},Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_ACQUISITION_TIMEOUT=o.DEFAULT_MAX_SIZE=void 0,o.DEFAULT_MAX_SIZE=100,o.DEFAULT_ACQUISITION_TIMEOUT=6e4,ml.defaultConfig=function(){return new ml(100,6e4)},ml.fromDriverConfig=function(e){return new ml(vl(e.maxConnectionPoolSize)?e.maxConnectionPoolSize:100,vl(e.connectionAcquisitionTimeout)?e.connectionAcquisitionTimeout:6e4)},P=ml;function ml(e,t){this.maxSize=gl(e,100),this.acquisitionTimeout=gl(t,6e4)}function gl(e,t){return 0===e||e?e:t}function vl(e){return 0===e||e}o.default=P;var n={},wl=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Ol=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},El=(Object.defineProperty(n,"__esModule",{value:!0}),w(o)),Tl=t,Sl=Tl.internal.logger.Logger,C=(Pl.prototype.acquire=function(o){var i=this,s=o.asKey(),a=this._acquireRequests;return a[s]||(a[s]=[]),new Promise(function(e,t){var r=null,n=setTimeout(function(){var e,t=a[s];t&&(a[s]=t.filter(function(e){return e!==r})),r.isCompleted()||(t=i.activeResourceCount(o),e=i.has(o)?i._pools[s].length:0,r.reject((0,Tl.newError)("Connection acquisition timed out in ".concat(i._acquisitionTimeout," ms. Pool status: Active conn count = ").concat(t,", Idle conn count = ").concat(e,"."))))},i._acquisitionTimeout),r=new Il(s,e,t,n,i._log);a[s].push(r),i._processPendingAcquireRequests(o)})},Pl.prototype.purge=function(e){return this._purgeKey(e.asKey())},Pl.prototype.close=function(){return wl(this,void 0,void 0,function(){var t=this;return Ol(this,function(e){switch(e.label){case 0:return this._closed=!0,[4,Promise.all(Object.keys(this._pools).map(function(e){return t._purgeKey(e)}))];case 1:return[2,e.sent()]}})})},Pl.prototype.keepAll=function(e){var t=this,r=e.map(function(e){return e.asKey()}),e=Object.keys(this._pools).filter(function(e){return-1===r.indexOf(e)});return Promise.all(e.map(function(e){return t._purgeKey(e)}))},Pl.prototype.has=function(e){return e.asKey()in this._pools},Pl.prototype.activeResourceCount=function(e){return this._activeResourceCounts[e.asKey()]||0},Pl.prototype._getOrInitializePoolFor=function(e){var t=this._pools[e];return t||(t=new Al,this._pools[e]=t,this._pendingCreates[e]=0),t},Pl.prototype._acquire=function(s){return wl(this,void 0,void 0,function(){var t,r,n,o,i=this;return Ol(this,function(e){switch(e.label){case 0:if(this._closed)throw(0,Tl.newError)("Pool is closed, it is no more able to serve requests.");t=s.asKey(),r=this._getOrInitializePoolFor(t),e.label=1;case 1:return r.length?(n=r.pop(),this._validate(n)?(this._removeIdleObserver&&this._removeIdleObserver(n),Cl(t,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(n," acquired from the pool ").concat(t)),[2,{resource:n,pool:r}]):[3,2]):[3,5];case 2:return[4,this._destroy(n)];case 3:e.sent(),e.label=4;case 4:return[3,1];case 5:if(0<this._maxSize&&this.activeResourceCount(s)+this._pendingCreates[t]>=this._maxSize)return[2,{resource:null,pool:r}];this._pendingCreates[t]=this._pendingCreates[t]+1,e.label=6;case 6:return e.trys.push([6,,8,9]),[4,this._create(s,function(e,t){return i._release(e,t,r)})];case 7:return o=e.sent(),Cl(t,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(o," created for the pool ").concat(t)),[3,9];case 8:return this._pendingCreates[t]=this._pendingCreates[t]-1,[7];case 9:return[2,{resource:o,pool:r}]}})})},Pl.prototype._release=function(s,a,u){return wl(this,void 0,void 0,function(){var o,i=this;return Ol(this,function(e){switch(e.label){case 0:return(o=s.asKey(),u.isActive())?this._validate(a)?[3,2]:(this._log.isDebugEnabled()&&this._log.debug("".concat(a," destroyed and can't be released to the pool ").concat(o," because it is not functional")),[4,this._destroy(a)]):[3,4];case 1:return e.sent(),[3,3];case 2:this._installIdleObserver&&this._installIdleObserver(a,{onError:function(e){i._log.debug("Idle connection ".concat(a," destroyed because of error: ").concat(e));e=i._pools[o];e&&(i._pools[o]=e.filter(function(e){return e!==a})),i._destroy(a).catch(function(){})}}),u.push(a),this._log.isDebugEnabled()&&this._log.debug("".concat(a," released to the pool ").concat(o)),e.label=3;case 3:return[3,6];case 4:return this._log.isDebugEnabled()&&this._log.debug("".concat(a," destroyed and can't be released to the pool ").concat(o," because pool has been purged")),[4,this._destroy(a)];case 5:e.sent(),e.label=6;case 6:return t=o,r=this._activeResourceCounts,0<(n=(r[t]||0)-1)?r[t]=n:delete r[t],this._processPendingAcquireRequests(s),[2]}var t,r,n})})},Pl.prototype._purgeKey=function(o){return wl(this,void 0,void 0,function(){var t,r,n;return Ol(this,function(e){switch(e.label){case 0:if(t=this._pools[o],r=[],!t)return[3,2];for(;t.length;)n=t.pop(),this._removeIdleObserver&&this._removeIdleObserver(n),r.push(this._destroy(n));return t.close(),delete this._pools[o],[4,Promise.all(r)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},Pl.prototype._processPendingAcquireRequests=function(r){var n,o=this,i=r.asKey(),e=this._acquireRequests[i];e&&((n=e.shift())?this._acquire(r).catch(function(e){return n.reject(e),{resource:null}}).then(function(e){var t=e.resource,e=e.pool;t?n.isCompleted()?o._release(r,t,e):n.resolve(t):n.isCompleted()||(o._acquireRequests[i]||(o._acquireRequests[i]=[]),o._acquireRequests[i].unshift(n))}):delete this._acquireRequests[i])},Pl);function Pl(e){var e=void 0===e?{}:e,t=e.create,t=void 0===t?function(e,t){return Promise.resolve()}:t,r=e.destroy,r=void 0===r?function(e){return Promise.resolve()}:r,n=e.validate,n=void 0===n?function(e){return!0}:n,o=e.installIdleObserver,o=void 0===o?function(e,t){}:o,i=e.removeIdleObserver,i=void 0===i?function(e){}:i,s=e.config,s=void 0===s?El.default.defaultConfig():s,e=e.log,e=void 0===e?Sl.noOp():e;this._create=t,this._destroy=r,this._validate=n,this._installIdleObserver=o,this._removeIdleObserver=i,this._maxSize=s.maxSize,this._acquisitionTimeout=s.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=e,this._closed=!1}function Cl(e,t){var r=t[e]||0;t[e]=r+1}Rl.prototype.isCompleted=function(){return this._completed},Rl.prototype.resolve=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))},Rl.prototype.reject=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))};var Il=Rl;function Rl(e,t,r,n,o){this._key=e,this._resolve=t,this._reject=r,this._timeoutId=n,this._log=o,this._completed=!1}Dl.prototype.isActive=function(){return this._active},Dl.prototype.close=function(){this._active=!1},Dl.prototype.filter=function(e){return this._elements=this._elements.filter(e),this},Object.defineProperty(Dl.prototype,"length",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),Dl.prototype.pop=function(){return this._elements.pop()},Dl.prototype.push=function(e){return this._elements.push(e)};var kl,Nl,jl,Al=Dl;function Dl(){this._active=!0,this._elements=[]}n.default=C,i=m,kl=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Nl=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),I=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&kl(t,e,r);return Nl(t,e),t},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_MAX_SIZE=i.DEFAULT_ACQUISITION_TIMEOUT=i.PoolConfig=i.Pool=void 0,jl=I(o),i.PoolConfig=jl.default,Object.defineProperty(i,"DEFAULT_ACQUISITION_TIMEOUT",{enumerable:!0,get:function(){return jl.DEFAULT_ACQUISITION_TIMEOUT}}),Object.defineProperty(i,"DEFAULT_MAX_SIZE",{enumerable:!0,get:function(){return jl.DEFAULT_MAX_SIZE}}),I=_(n),i.Pool=I.default,i.default=I.default;var Ul,xt={},S={},f=e&&e.__extends||(Ul=function(e,t){return(Ul=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ul(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(S,"__esModule",{value:!0});f(Ll,Ml=t.ConnectionProvider),Ll.prototype.acquireConnection=function(e){e=void 0===e?{}:e,e.accessMode,e.database,e.bookmarks,e=this._connection;return this._connection=null,Promise.resolve(e)};var Ml,E=Ll;function Ll(e){var t=Ml.call(this)||this;return t._connection=e,t}S.default=E;g={},b={},u={};function xl(e){this._errorHandler=e}Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(xl.prototype,"id",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"databaseId",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),xl.prototype.isOpen=function(){throw new Error("not implemented")},xl.prototype.protocol=function(){throw new Error("not implemented")},Object.defineProperty(xl.prototype,"address",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"version",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"server",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),xl.prototype.connect=function(e,t){throw new Error("not implemented")},xl.prototype.write=function(e,t,r){throw new Error("not implemented")},xl.prototype.resetAndFlush=function(){throw new Error("not implemented")},xl.prototype.hasOngoingObservableRequests=function(){throw new Error("not implemented")},xl.prototype.close=function(){throw new Error("not implemented")},xl.prototype.handleAndTransformError=function(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t):e},u.default=xl;var Bl,O={},d=e&&e.__extends||(Bl=function(e,t){return(Bl=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Bl(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Fl=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Hl=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ql=(Object.defineProperty(O,"__esModule",{value:!0}),O.createChannelConnection=void 0,r),Vl=t,a=v(u),zl=v(s),Wl=Vl.error.PROTOCOL_ERROR,Gl=Vl.internal.logger.Logger,Kl=0;O.createChannelConnection=function(i,s,a,u,c,e){void 0===c&&(c=null);var l=(e=void 0===e?function(e){return new ql.Channel(e)}:e)(new ql.ChannelConfig(i,s,a.errorCode()));return zl.default.handshake(l).then(function(e){var r=e.protocolVersion,e=e.consumeRemainingBuffer,n=new ql.Chunker(l),o=new ql.Dechunker,t=new Zl(l,a,i,u,s.disableLosslessIntegers,c,n,function(t){return zl.default.create({version:r,channel:l,chunker:n,dechunker:o,disableLosslessIntegers:s.disableLosslessIntegers,useBigInt:s.useBigInt,serversideRouting:c,server:t.server,log:t.logger,observer:{onPendingObserversChange:t._handleOngoingRequestsNumberChange.bind(t),onError:t._handleFatalError.bind(t),onFailure:t._resetOnFailure.bind(t),onProtocolError:t._handleProtocolError.bind(t),onErrorApplyTransformation:function(e){return t.handleAndTransformError(e,t._address)}}})});return e(function(e){return o.write(e)}),t}).catch(function(e){return l.close().then(function(){throw e})})};Yl=a.default,d(Xl,Yl),Object.defineProperty(Xl.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"databaseId",{get:function(){return this._dbConnectionId},set:function(e){this._dbConnectionId=e},enumerable:!1,configurable:!0}),Xl.prototype.connect=function(e,t){return this._initialize(e,t)},Xl.prototype._initialize=function(e,n){var o=this,i=this;return new Promise(function(r,t){o._protocol.initialize({userAgent:e,authToken:n,onError:function(e){return t(e)},onComplete:function(e){var t;e&&(t=e.server,o.version&&!t||(o.version=t),t=e.connection_id,o.databaseId||(o.databaseId=t),e.hints)&&null!=(t=e.hints["connection.recv_timeout_seconds"])&&(e=(0,Vl.toNumber)(t),Number.isInteger(e)&&0<e?o._ch.setupReceiveTimeout(1e3*e):o._log.info("Server located at ".concat(o._address," supplied an invalid connection receive timeout value (").concat(e,"). ")+"Please, verify the server configuration and status because this can be the symptom of a bigger issue.")),r(i)}})})},Xl.prototype.protocol=function(){return this._protocol},Object.defineProperty(Xl.prototype,"address",{get:function(){return this._address},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"version",{get:function(){return this._server.version},set:function(e){this._server.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"server",{get:function(){return this._server},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"logger",{get:function(){return this._log},enumerable:!1,configurable:!0}),Xl.prototype._handleFatalError=function(e){this._isBroken=!0,this._error=this.handleAndTransformError(this._protocol.currentFailure||e,this._address),this._log.isErrorEnabled()&&this._log.error("experienced a fatal error caused by ".concat(this._error," (").concat(Vl.json.stringify(this._error),")")),this._protocol.notifyFatalError(this._error)},Xl.prototype._queueObserver=function(e){return this._protocol.queueObserverIfProtocolIsNotBroken(e)},Xl.prototype.hasOngoingObservableRequests=function(){return this._protocol.hasOngoingObservableRequests()},Xl.prototype.resetAndFlush=function(){var r=this;return new Promise(function(e,t){r._reset({onError:function(e){r._isBroken?t(e):(e=r._handleProtocolError("Received FAILURE as a response for RESET: "+e),t(e))},onComplete:function(){e()}})})},Xl.prototype._resetOnFailure=function(){var e=this;this.isOpen()&&this._reset({onError:function(){e._protocol.resetFailure()},onComplete:function(){e._protocol.resetFailure()}})},Xl.prototype._reset=function(t){var e,r=this;this._reseting?this._protocol.isLastMessageReset()?this._resetObservers.push(t):this._protocol.reset({onError:function(e){t.onError(e)},onComplete:function(){t.onComplete()}}):(this._resetObservers.push(t),this._reseting=!0,e=function(e){r._reseting=!1;var t=r._resetObservers;r._resetObservers=[],t.forEach(e)},this._protocol.reset({onError:function(t){e(function(e){return e.onError(t)})},onComplete:function(){e(function(e){return e.onComplete()})}}))},Xl.prototype._updateCurrentObserver=function(){this._protocol.updateCurrentObserver()},Xl.prototype.isOpen=function(){return!this._isBroken&&this._ch._open},Xl.prototype._handleOngoingRequestsNumberChange=function(e){0===e?this._ch.stopReceiveTimeout():this._ch.startReceiveTimeout()},Xl.prototype.close=function(){return Fl(this,void 0,void 0,function(){return Hl(this,function(e){switch(e.label){case 0:return this._log.isDebugEnabled()&&this._log.debug("closing"),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),[4,this._ch.close()];case 1:return e.sent(),this._log.isDebugEnabled()&&this._log.debug("closed"),[2]}})})},Xl.prototype.toString=function(){return"Connection [".concat(this.id,"][").concat(this.databaseId||"","]")},Xl.prototype._handleProtocolError=function(e){this._protocol.resetFailure(),this._updateCurrentObserver();e=(0,Vl.newError)(e,Wl);return this._handleFatalError(e),e};var Yl,Zl=Xl;function Xl(e,t,r,n,o,i,s,a){void 0===o&&(o=!1),void 0===i&&(i=null);var u,c,t=Yl.call(this,t)||this;return t._reseting=!1,t._resetObservers=[],t._id=Kl++,t._address=r,t._server={address:r.asHostPort()},t.creationTimestamp=Date.now(),t._disableLosslessIntegers=o,t._ch=e,t._chunker=s,t._log=(u=t,new Gl((c=n)._level,function(e,t){return c._loggerFunction(e,"".concat(u," ").concat(t))})),t._serversideRouting=i,t._dbConnectionId=null,t._protocol=a(t),t._isBroken=!1,t._log.isDebugEnabled()&&t._log.debug("created towards ".concat(r)),t}O.default=Zl;var Ql,$l,P={},w=e&&e.__extends||(Ql=function(e,t){return(Ql=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ql(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=(Object.defineProperty(P,"__esModule",{value:!0}),C(u)),_=($l=o.default,w(Jl,$l),Object.defineProperty(Jl.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"databaseId",{get:function(){return this._delegate.databaseId},set:function(e){this._delegate.databaseId=e},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"server",{get:function(){return this._delegate.server},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"address",{get:function(){return this._delegate.address},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"version",{get:function(){return this._delegate.version},set:function(e){this._delegate.version=e},enumerable:!1,configurable:!0}),Jl.prototype.isOpen=function(){return this._delegate.isOpen()},Jl.prototype.protocol=function(){return this._delegate.protocol()},Jl.prototype.connect=function(e,t){return this._delegate.connect(e,t)},Jl.prototype.write=function(e,t,r){return this._delegate.write(e,t,r)},Jl.prototype.resetAndFlush=function(){return this._delegate.resetAndFlush()},Jl.prototype.hasOngoingObservableRequests=function(){return this._delegate.hasOngoingObservableRequests()},Jl.prototype.close=function(){return this._delegate.close()},Jl.prototype._release=function(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate._release()},Jl);function Jl(e,t){var r=$l.call(this,t)||this;return t&&(r._originalErrorHandler=e._errorHandler,e._errorHandler=r._errorHandler),r._delegate=e,r}P.default=_;n={};Object.defineProperty(n,"__esModule",{value:!0});var ef,tf,rf,nf=t.error.SERVICE_UNAVAILABLE,of=t.error.SESSION_EXPIRED;function sf(e,t,r,n){this._errorCode=e,this._handleUnavailability=t||af,this._handleWriteFailure=r||af,this._handleAuthorizationExpired=n||af}function af(e){return e}sf.create=function(e){return new sf(e.errorCode,e.handleUnavailability,e.handleWriteFailure,e.handleAuthorizationExpired)},sf.prototype.errorCode=function(){return this._errorCode},sf.prototype.handleAndTransformError=function(e,t){var r;return!(r=e)||"Neo.ClientError.Security.AuthorizationExpired"!==r.code&&"Neo.ClientError.Security.TokenExpired"!==r.code?function(e){if(e)return e.code===of||e.code===nf||"Neo.TransientError.General.DatabaseUnavailable"===e.code;return}(e)?this._handleUnavailability(e,t):function(e){if(e)return"Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code;return}(e)?this._handleWriteFailure(e,t):e:this._handleAuthorizationExpired(e,t)},n.default=sf,i=b,ef=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),tf=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),I=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&ef(t,e,r);return tf(t,e),t},f=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(i,"__esModule",{value:!0}),i.createChannelConnection=i.ConnectionErrorHandler=i.DelegateConnection=i.ChannelConnection=i.Connection=void 0,E=f(u),i.Connection=E.default,rf=I(O),i.ChannelConnection=rf.default,Object.defineProperty(i,"createChannelConnection",{enumerable:!0,get:function(){return rf.createChannelConnection}}),I=f(P),i.DelegateConnection=I.default,I=f(n),i.ConnectionErrorHandler=I.default,i.default=E.default;var uf,cf,v=e&&e.__extends||(uf=function(e,t){return(uf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),lf=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),ff=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&lf(t,e,r);return ff(t,e),t},hf=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},pf=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},df=(Object.defineProperty(g,"__esModule",{value:!0}),b),_f=a(m),yf=t,bf=yf.error.SERVICE_UNAVAILABLE,d=(cf=yf.ConnectionProvider,v(mf,cf),mf.prototype._createConnectionErrorHandler=function(){return new df.ConnectionErrorHandler(bf)},mf.prototype._createConnection=function(e,r){var n=this;return this._createChannelConnection(e).then(function(t){return t._release=function(){return r(e,t)},(n._openConnections[t.id]=t).connect(n._userAgent,n._authToken).catch(function(e){throw n._destroyConnection(t),e})})},mf.prototype._validateConnection=function(e){var t;return!!e.isOpen()&&(t=this._config.maxConnectionLifetime,Date.now()-e.creationTimestamp<=t)},mf.prototype._destroyConnection=function(e){return delete this._openConnections[e.id],e.close()},mf.prototype._verifyConnectivityAndGetServerVersion=function(e){var n=e.address;return hf(this,void 0,void 0,function(){var t,r;return pf(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.acquire(n)];case 1:t=e.sent(),r=new yf.ServerInfo(t.server,t.protocol().version),e.label=2;case 2:return e.trys.push([2,,5,7]),t.protocol().isLastMessageLogin()?[3,4]:[4,t.resetAndFlush()];case 3:e.sent(),e.label=4;case 4:return[3,7];case 5:return[4,t._release()];case 6:return e.sent(),[7];case 7:return[2,r]}})})},mf.prototype.close=function(){return hf(this,void 0,void 0,function(){return pf(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.close()];case 1:return e.sent(),[4,Promise.all(Object.values(this._openConnections).map(function(e){return e.close()}))];case 2:return e.sent(),[2]}})})},mf._installIdleObserverOnConnection=function(e,t){e._queueObserver(t)},mf._removeIdleObserverOnConnection=function(e){e._updateCurrentObserver()},mf);function mf(e,t){var r=e.id,n=e.config,o=e.log,i=e.userAgent,e=e.authToken,s=(void 0===t&&(t=null),cf.call(this)||this);return s._id=r,s._config=n,s._log=o,s._userAgent=i,s._authToken=e,s._createChannelConnection=t||function(e){return(0,df.createChannelConnection)(e,s._config,s._createConnectionErrorHandler(),s._log)},s._connectionPool=new _f.default({create:s._createConnection.bind(s),destroy:s._destroyConnection.bind(s),validate:s._validateConnection.bind(s),installIdleObserver:mf._installIdleObserverOnConnection.bind(s),removeIdleObserver:mf._removeIdleObserverOnConnection.bind(s),config:_f.PoolConfig.fromDriverConfig(n),log:s._log}),s._openConnections={},s}g.default=d;var gf,vf,C={},o=e&&e.__extends||(gf=function(e,t){return(gf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}gf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),wf=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Of=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},w=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(C,"__esModule",{value:!0}),w(g)),Ef=b,u=t.internal.constants,Tf=u.BOLT_PROTOCOL_V3,Sf=u.BOLT_PROTOCOL_V4_0,Pf=u.BOLT_PROTOCOL_V4_4,Cf=t.error.SERVICE_UNAVAILABLE,O=(vf=_.default,o(If,vf),If.prototype.acquireConnection=function(e){var r=this,e=void 0===e?{}:e,n=(e.accessMode,e.database),t=(e.bookmarks,Ef.ConnectionErrorHandler.create({errorCode:Cf,handleAuthorizationExpired:function(e,t){return r._handleAuthorizationExpired(e,t,n)}}));return this._connectionPool.acquire(this._address).then(function(e){return new Ef.DelegateConnection(e,t)})},If.prototype._handleAuthorizationExpired=function(e,t,r){return this._log.warn("Direct driver ".concat(this._id," will close connection to ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this._connectionPool.purge(t).catch(function(){}),e},If.prototype._hasProtocolVersion=function(n){return wf(this,void 0,void 0,function(){var t,r;return Of(this,function(e){switch(e.label){case 0:return[4,(0,Ef.createChannelConnection)(this._address,this._config,this._createConnectionErrorHandler(),this._log)];case 1:return t=e.sent(),r=t.protocol()?t.protocol().version:null,[4,t.close()];case 2:return e.sent(),r?[2,n(r)]:[2,!1]}})})},If.prototype.supportsMultiDb=function(){return wf(this,void 0,void 0,function(){return Of(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Sf<=e})];case 1:return[2,e.sent()]}})})},If.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},If.prototype.supportsTransactionConfig=function(){return wf(this,void 0,void 0,function(){return Of(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Tf<=e})];case 1:return[2,e.sent()]}})})},If.prototype.supportsUserImpersonation=function(){return wf(this,void 0,void 0,function(){return Of(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return Pf<=e})];case 1:return[2,e.sent()]}})})},If.prototype.verifyConnectivityAndGetServerInfo=function(){return wf(this,void 0,void 0,function(){return Of(this,function(e){switch(e.label){case 0:return[4,this._verifyConnectivityAndGetServerVersion({address:this._address})];case 1:return[2,e.sent()]}})})},If);function If(e){var t=e.id,r=e.config,n=e.log,o=e.address,i=e.userAgent,e=e.authToken,t=vf.call(this,{id:t,config:r,log:n,userAgent:i,authToken:e})||this;return t._address=o,t}C.default=O;var P={},f={},n={},I={},Rf=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},kf=e&&e.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},Nf=(Object.defineProperty(I,"__esModule",{value:!0}),I.createValidRoutingTable=void 0,t),i=Nf.internal.constants,jf=i.ACCESS_MODE_WRITE,Af=i.ACCESS_MODE_READ,Df=Nf.internal.serverAddress.ServerAddress,Uf=Nf.error.PROTOCOL_ERROR,Mf=(Lf.fromRawRoutingTable=Bf,Lf.prototype.forget=function(e){this.readers=xf(this.readers,e),this.writers=xf(this.writers,e)},Lf.prototype.forgetRouter=function(e){this.routers=xf(this.routers,e)},Lf.prototype.forgetWriter=function(e){this.writers=xf(this.writers,e)},Lf.prototype.isStaleFor=function(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<1||e===Af&&0===this.readers.length||e===jf&&0===this.writers.length},Lf.prototype.isExpiredFor=function(e){return this.expirationTime.add(e).lessThan(Date.now())},Lf.prototype.allServers=function(){return kf(kf(kf([],Rf(this.routers),!1),Rf(this.readers),!1),Rf(this.writers),!1)},Lf.prototype.toString=function(){return"RoutingTable["+"database=".concat(this.databaseName,", ")+"expirationTime=".concat(this.expirationTime,", ")+"currentTime=".concat(Date.now(),", ")+"routers=[".concat(this.routers,"], ")+"readers=[".concat(this.readers,"], ")+"writers=[".concat(this.writers,"]]")},Lf);function Lf(e){var e=void 0===e?{}:e,t=e.database,r=e.routers,n=e.readers,o=e.writers,i=e.expirationTime,e=e.ttl;this.database=t||null,this.databaseName=t||"default database",this.routers=r||[],this.readers=n||[],this.writers=o||[],this.expirationTime=i||(0,Nf.int)(0),this.ttl=e}function xf(e,t){return e.filter(function(e){return e.asKey()!==t.asKey()})}function Bf(e,t,r){var n=r.ttl,o=function(t,r){try{var e=(0,Nf.int)(Date.now()),n=(0,Nf.int)(t.ttl).multiply(1e3).add(e);return n.lessThan(e)?Nf.Integer.MAX_VALUE:n}catch(e){throw(0,Nf.newError)("Unable to parse TTL entry from router ".concat(r," from raw routing table:\n").concat(Nf.json.stringify(t),"\nError message: ").concat(e.message),Uf)}}(r,t),i=function(t,r){try{var n=[],o=[],i=[];return t.servers.forEach(function(e){var t=e.role,e=e.addresses;"ROUTE"===t?n=Hf(e).map(function(e){return Df.fromUrl(e)}):"WRITE"===t?i=Hf(e).map(function(e){return Df.fromUrl(e)}):"READ"===t&&(o=Hf(e).map(function(e){return Df.fromUrl(e)}))}),{routers:n,readers:o,writers:i}}catch(e){throw(0,Nf.newError)("Unable to parse servers entry from router ".concat(r," from addresses:\n").concat(Nf.json.stringify(t.servers),"\nError message: ").concat(e.message),Uf)}}(r,t),s=i.routers,a=i.readers,i=i.writers;return Ff(s,"routers",t),Ff(a,"readers",t),new Mf({database:e||r.db,routers:s,readers:a,writers:i,expirationTime:o,ttl:n})}function Ff(e,t,r){if(0===e.length)throw(0,Nf.newError)("Received no "+t+" from router "+r,Uf)}function Hf(e){if(Array.isArray(e))return Array.from(e);throw new TypeError("Array expected but got: "+e)}I.default=Mf,I.createValidRoutingTable=Bf;var E=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},qf=(Object.defineProperty(n,"__esModule",{value:!0}),E(I));function Vf(e){this._routingContext=e}Vf.prototype.lookupRoutingTableOnRouter=function(t,r,n,o){var i=this;return t._acquireConnection(function(e){return i._requestRawRoutingTable(e,t,r,n,o).then(function(e){return e.isNull?null:qf.default.fromRawRoutingTable(r,n,e)})})},Vf.prototype._requestRawRoutingTable=function(r,n,o,e,i){var s=this;return new Promise(function(e,t){r.protocol().requestRoutingInformation({routingContext:s._routingContext,databaseName:o,impersonatedUser:i,sessionContext:{bookmarks:n._lastBookmarks,mode:n._mode,database:n._database,afterComplete:n._onComplete},onCompleted:e,onError:t})})},n.default=Vf;var zf,Wf,a=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},v=(Object.defineProperty(f,"__esModule",{value:!0}),f.RoutingTable=f.Rediscovery=void 0,a(n)),d=(f.Rediscovery=v.default,a(I)),w=(f.RoutingTable=d.default,f.default=v.default,e&&e.__extends||(zf=function(e,t){return(zf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}zf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)})),Gf=e&&e.__assign||function(){return(Gf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Kf=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),Yf=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&Kf(t,e,r);return Yf(t,e),t},Zf=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Xf=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Qf=e&&e.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$f=e&&e.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},_=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Jf=(Object.defineProperty(P,"__esModule",{value:!0}),t),eh=u(f),th=r,rh=_(S),o=_(g),nh=T,oh=b,ih=Jf.error.SERVICE_UNAVAILABLE,sh=Jf.error.SESSION_EXPIRED,ah=Jf.internal.bookmarks.Bookmarks,O=Jf.internal.constants,uh=O.ACCESS_MODE_READ,ch=O.ACCESS_MODE_WRITE,lh=O.BOLT_PROTOCOL_V3,fh=O.BOLT_PROTOCOL_V4_0,hh=O.BOLT_PROTOCOL_V4_4,ph=(0,Jf.int)(3e4),i=(Wf=o.default,w(D,Wf),D.prototype._createConnectionErrorHandler=function(){return new oh.ConnectionErrorHandler(sh)},D.prototype._handleUnavailability=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forget(t,r||null),e},D.prototype._handleAuthorizationExpired=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will close connections to ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this._connectionPool.purge(t).catch(function(){}),e},D.prototype._handleWriteFailure=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget writer ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forgetWriter(t,r||null),(0,Jf.newError)("No longer possible to write to server at "+t,sh,e)},D.prototype.acquireConnection=function(e){var e=void 0===e?{}:e,u=e.accessMode,c=e.database,l=e.bookmarks,f=e.impersonatedUser,h=e.onDatabaseNameResolved;return Zf(this,void 0,void 0,function(){var t,r,n,o,i,s,a=this;return Xf(this,function(e){switch(e.label){case 0:return n={database:c||null},o=new oh.ConnectionErrorHandler(sh,function(e,t){return a._handleUnavailability(e,t,n.database)},function(e,t){return a._handleWriteFailure(e,t,n.database)},function(e,t){return a._handleAuthorizationExpired(e,t,n.database)}),[4,this._freshRoutingTable({accessMode:u,database:n.database,bookmarks:l,impersonatedUser:f,onDatabaseNameResolved:function(e){n.database=n.database||e,h&&h(e)}})];case 1:if(i=e.sent(),u===uh)r=this._loadBalancingStrategy.selectReader(i.readers),t="read";else{if(u!==ch)throw(0,Jf.newError)("Illegal mode "+u);r=this._loadBalancingStrategy.selectWriter(i.writers),t="write"}if(!r)throw(0,Jf.newError)("Failed to obtain connection towards ".concat(t," server. Known routing table is: ").concat(i),sh);e.label=2;case 2:return e.trys.push([2,4,,5]),[4,this._acquireConnectionToServer(r,t,i)];case 3:return s=e.sent(),[2,new oh.DelegateConnection(s,o)];case 4:throw s=e.sent(),o.handleAndTransformError(s,r);case 5:return[2]}})})},D.prototype._hasProtocolVersion=function(s){return Zf(this,void 0,void 0,function(){var t,r,n,o,i;return Xf(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(this._seedRouter)];case 1:t=e.sent(),n=0,e.label=2;case 2:if(!(n<t.length))return[3,8];e.label=3;case 3:return e.trys.push([3,6,,7]),[4,(0,oh.createChannelConnection)(t[n],this._config,this._createConnectionErrorHandler(),this._log)];case 4:return i=e.sent(),o=i.protocol()?i.protocol().version:null,[4,i.close()];case 5:return e.sent(),o?[2,s(o)]:[2,!1];case 6:return i=e.sent(),r=i,[3,7];case 7:return n++,[3,2];case 8:if(r)throw r;return[2,!1]}})})},D.prototype.supportsMultiDb=function(){return Zf(this,void 0,void 0,function(){return Xf(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return fh<=e})];case 1:return[2,e.sent()]}})})},D.prototype.supportsTransactionConfig=function(){return Zf(this,void 0,void 0,function(){return Xf(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return lh<=e})];case 1:return[2,e.sent()]}})})},D.prototype.supportsUserImpersonation=function(){return Zf(this,void 0,void 0,function(){return Xf(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return hh<=e})];case 1:return[2,e.sent()]}})})},D.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},D.prototype.verifyConnectivityAndGetServerInfo=function(e){var l=e.database,f=e.accessMode;return Zf(this,void 0,void 0,function(){var t,r,n,o,i,s,a,u,c;return Xf(this,function(e){switch(e.label){case 0:return t={database:l||null},[4,this._freshRoutingTable({accessMode:f,database:t.database,onDatabaseNameResolved:function(e){t.database=t.database||e}})];case 1:r=e.sent(),r=f===ch?r.writers:r.readers,n=(0,Jf.newError)("No servers available for database '".concat(t.database,"' with access mode '").concat(f,"'"),ih),e.label=2;case 2:e.trys.push([2,9,10,11]),o=Qf(r),i=o.next(),e.label=3;case 3:if(i.done)return[3,8];s=i.value,e.label=4;case 4:return e.trys.push([4,6,,7]),[4,this._verifyConnectivityAndGetServerVersion({address:s})];case 5:return[2,e.sent()];case 6:return a=e.sent(),n=a,[3,7];case 7:return i=o.next(),[3,3];case 8:return[3,11];case 9:return a=e.sent(),u={error:a},[3,11];case 10:try{i&&!i.done&&(c=o.return)&&c.call(o)}finally{if(u)throw u.error}return[7];case 11:throw n}})})},D.prototype.forget=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forget(t)}}),this._connectionPool.purge(t).catch(function(){})},D.prototype.forgetWriter=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forgetWriter(t)}})},D.prototype._acquireConnectionToServer=function(e,t,r){return this._connectionPool.acquire(e)},D.prototype._freshRoutingTable=function(e){var e=void 0===e?{}:e,t=e.accessMode,r=e.database,n=e.bookmarks,o=e.impersonatedUser,e=e.onDatabaseNameResolved,i=this._routingTableRegistry.get(r,function(){return new eh.RoutingTable({database:r})});return i.isStaleFor(t)?(this._log.info('Routing table is stale for database: "'.concat(r,'" and access mode: "').concat(t,'": ').concat(i)),this._refreshRoutingTable(i,n,o,e)):i},D.prototype._refreshRoutingTable=function(e,t,r,n){var o=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(o,e,t,r,n):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(o,e,t,r,n)},D.prototype._fetchRoutingTableFromSeedRouterFallbackToKnownRouters=function(s,a,u,c,l){return Zf(this,void 0,void 0,function(){var t,r,n,o,i;return Xf(this,function(e){switch(e.label){case 0:return t=[],[4,this._fetchRoutingTableUsingSeedRouter(t,this._seedRouter,a,u,c)];case 1:return(t=$f.apply(void 0,[e.sent(),2]),r=t[0],n=t[1],r)?(this._useSeedRouter=!1,[3,4]):[3,2];case 2:return[4,this._fetchRoutingTableUsingKnownRouters(s,a,u,c)];case 3:i=$f.apply(void 0,[e.sent(),2]),o=i[0],i=i[1],r=o,n=i||n,e.label=4;case 4:return[4,this._applyRoutingTableIfPossible(a,r,l,n)];case 5:return[2,e.sent()]}})})},D.prototype._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter=function(o,i,s,a,u){return Zf(this,void 0,void 0,function(){var t,r,n;return Xf(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTableUsingKnownRouters(o,i,s,a)];case 1:return r=$f.apply(void 0,[e.sent(),2]),t=r[0],r=r[1],t?[3,3]:[4,this._fetchRoutingTableUsingSeedRouter(o,this._seedRouter,i,s,a)];case 2:n=$f.apply(void 0,[e.sent(),2]),t=n[0],r=n[1],e.label=3;case 3:return[4,this._applyRoutingTableIfPossible(i,t,u,r)];case 4:return[2,e.sent()]}})})},D.prototype._fetchRoutingTableUsingKnownRouters=function(n,o,i,s){return Zf(this,void 0,void 0,function(){var t,r;return Xf(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTable(n,o,i,s)];case 1:return(t=$f.apply(void 0,[e.sent(),2]),r=t[0],t=t[1],r)?[2,[r,null]]:(r=n.length-1,D._forgetRouter(o,n,r),[2,[null,t]])}})})},D.prototype._fetchRoutingTableUsingSeedRouter=function(r,n,o,i,s){return Zf(this,void 0,void 0,function(){var t;return Xf(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(n)];case 1:return t=e.sent(),t=t.filter(function(e){return r.indexOf(e)<0}),[4,this._fetchRoutingTable(t,o,i,s)];case 2:return[2,e.sent()]}})})},D.prototype._resolveSeedRouter=function(n){return Zf(this,void 0,void 0,function(){var t,r=this;return Xf(this,function(e){switch(e.label){case 0:return[4,this._hostNameResolver.resolve(n)];case 1:return t=e.sent(),[4,Promise.all(t.map(function(e){return r._dnsResolver.resolve(e)}))];case 2:return t=e.sent(),[2,[].concat.apply([],t)]}})})},D.prototype._fetchRoutingTable=function(u,c,l,f){return Zf(this,void 0,void 0,function(){var t=this;return Xf(this,function(e){return[2,u.reduce(function(i,s,a){return Zf(t,void 0,void 0,function(){var t,r,n,o;return Xf(this,function(e){switch(e.label){case 0:return[4,i];case 1:return(t=$f.apply(void 0,[e.sent(),1]),t=t[0])?[2,[t,null]]:(D._forgetRouter(c,u,a-1),[4,this._createSessionForRediscovery(s,l,f)]);case 2:if(t=$f.apply(void 0,[e.sent(),2]),r=t[0],n=t[1],!r)return[3,8];e.label=3;case 3:return e.trys.push([3,5,6,7]),[4,this._rediscovery.lookupRoutingTableOnRouter(r,c.database,s,f)];case 4:return[2,[e.sent(),null]];case 5:return o=e.sent(),[2,this._handleRediscoveryError(o,s)];case 6:return r.close(),[7];case 7:return[3,9];case 8:return[2,[null,n]];case 9:return[2]}})})},Promise.resolve([null,null]))]})})},D.prototype._createSessionForRediscovery=function(o,i,s){return Zf(this,void 0,void 0,function(){var t,r,n=this;return Xf(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this._connectionPool.acquire(o)];case 1:return r=e.sent(),t=oh.ConnectionErrorHandler.create({errorCode:sh,handleAuthorizationExpired:function(e,t){return n._handleAuthorizationExpired(e,t)}}),t=new rh.default(new oh.DelegateConnection(r,t)),r.protocol().version<4?[2,[new Jf.Session({mode:ch,bookmarks:ah.empty(),connectionProvider:t}),null]]:[2,[new Jf.Session({mode:uh,database:"system",bookmarks:i,connectionProvider:t,impersonatedUser:s}),null]];case 2:return r=e.sent(),[2,this._handleRediscoveryError(r,o)];case 3:return[2]}})})},D.prototype._handleRediscoveryError=function(e,t){if(["Neo.ClientError.Database.DatabaseNotFound","Neo.ClientError.Transaction.InvalidBookmark","Neo.ClientError.Transaction.InvalidBookmarkMixture","Neo.ClientError.Statement.ArgumentError","Neo.ClientError.Request.Invalid","Neo.ClientError.Statement.TypeError"].includes(e.code)||(r=e).code.startsWith("Neo.ClientError.Security.")&&!["Neo.ClientError.Security.AuthorizationExpired"].includes(r.code))throw e;if("Neo.ClientError.Procedure.ProcedureNotFound"===e.code)throw(0,Jf.newError)("Server at ".concat(t.asHostPort()," can't perform routing. Make sure you are connecting to a causal cluster"),ih,e);var r;return this._log.warn("unable to fetch routing table because of an error ".concat(e)),[null,e]},D.prototype._applyRoutingTableIfPossible=function(t,r,n,o){return Zf(this,void 0,void 0,function(){return Xf(this,function(e){switch(e.label){case 0:if(r)return 0===r.writers.length&&(this._useSeedRouter=!0),[4,this._updateRoutingTable(r,n)];throw(0,Jf.newError)("Could not perform discovery. No routing servers available. Known routing table: ".concat(t),ih,o);case 1:return e.sent(),[2,r]}})})},D.prototype._updateRoutingTable=function(t,r){return Zf(this,void 0,void 0,function(){return Xf(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.keepAll(t.allServers())];case 1:return e.sent(),this._routingTableRegistry.removeExpired(),this._routingTableRegistry.register(t),r(t.database),this._log.info("Updated routing table ".concat(t)),[2]}})})},D._forgetRouter=function(e,t,r){t=t[r];e&&t&&e.forgetRouter(t)},D);function D(e){var t=e.id,r=e.address,n=e.routingContext,o=e.hostNameResolver,i=e.config,s=e.log,a=e.userAgent,u=e.authToken,e=e.routingTablePurgeDelay,c=Wf.call(this,{id:t,config:i,log:s,userAgent:a,authToken:u},function(e){return(0,oh.createChannelConnection)(e,c._config,c._createConnectionErrorHandler(),c._log,c._routingContext)})||this;return c._routingContext=Gf(Gf({},n),{address:r.toString()}),c._seedRouter=r,c._rediscovery=new eh.default(c._routingContext),c._loadBalancingStrategy=new nh.LeastConnectedLoadBalancingStrategy(c._connectionPool),c._hostNameResolver=o,c._dnsResolver=new th.HostNameResolver,c._log=s,c._useSeedRouter=!0,c._routingTableRegistry=new Nh(e?(0,Jf.int)(e):ph),c}P.default=i;jh.prototype.register=function(e){return this._tables.set(e.database,e),this},jh.prototype.apply=function(e,t){var t=void 0===t?{}:t,r=t.applyWhenExists,t=t.applyWhenDontExists,t=void 0===t?function(){}:t;return this._tables.has(e)?r(this._tables.get(e)):"string"==typeof e||null===e?t():this._forEach(r),this},jh.prototype.get=function(e,t){return this._tables.has(e)?this._tables.get(e):"function"==typeof t?t():t},jh.prototype.removeExpired=function(){var t=this;return this._removeIf(function(e){return e.isExpiredFor(t._routingTablePurgeDelay)})},jh.prototype._forEach=function(e){var t,r;try{for(var n=Qf(this._tables),o=n.next();!o.done;o=n.next())e($f(o.value,2)[1])}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this},jh.prototype._remove=function(e){return this._tables.delete(e),this},jh.prototype._removeIf=function(e){var t,r;try{for(var n=Qf(this._tables),o=n.next();!o.done;o=n.next()){var i=$f(o.value,2),s=i[0];e(i[1])&&this._remove(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this};var dh,_h,yh,bh,mh,gh,vh,wh,Oh,Eh,U,Th,f,Sh,Ph,Ch,Ih,Rh,kh,Nh=jh;function jh(e){this._tables=new Map,this._routingTablePurgeDelay=e}function Ah(e,o,t){void 0===t&&(t={}),Ph(e,"Bolt URL");var r,n,i=Rh.parseDatabaseUrl(e),s=!1,a=!1;switch(i.scheme){case"bolt":break;case"bolt+s":a=!0,n="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":a=!0,n="TRUST_ALL_CERTIFICATES";break;case"neo4j":s=!0;break;case"neo4j+s":n="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",s=a=!0;break;case"neo4j+ssc":n="TRUST_ALL_CERTIFICATES",s=a=!0;break;default:throw new Error("Unknown scheme: ".concat(null!=(r=i.scheme)?r:"null"))}if(a){if("encrypted"in t||"trust"in t)throw new Error("Encryption/trust can only be configured either through URL or config, not both");t.encrypted=Sh,t.trust=n}(o=null!=o?o:{}).scheme=null!=(c=o.scheme)?c:"none",t.userAgent=null!=(c=t.userAgent)?c:kh;var u=Ih.fromUrl(i.hostAndPort),c={address:u,typename:s?"Routing":"Direct",routing:s};return new U.Driver(c,t,function(){{if(s)return function(e,t,r,n){return new Th.RoutingConnectionProvider({id:e,config:t,log:r,hostNameResolver:n,authToken:o,address:u,userAgent:t.userAgent,routingContext:i.query})};if(Ch(i.query))return function(e,t,r){return new Th.DirectConnectionProvider({id:e,config:t,log:r,authToken:o,address:u,userAgent:t.userAgent})};throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"))}}())}function Dh(r,n){return wh(this,void 0,void 0,function(){var t;return Oh(this,function(e){switch(e.label){case 0:t=Ah(r,{scheme:"none",principal:"",credentials:""},n),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,t.getNegotiatedProtocolVersion()];case 2:return e.sent(),[2,!0];case 3:return[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})}return E=xt,dh=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(E,"__esModule",{value:!0}),E.RoutingConnectionProvider=E.DirectConnectionProvider=E.PooledConnectionProvider=E.SingleConnectionProvider=void 0,_h=S,Object.defineProperty(E,"SingleConnectionProvider",{enumerable:!0,get:function(){return dh(_h).default}}),yh=g,Object.defineProperty(E,"PooledConnectionProvider",{enumerable:!0,get:function(){return dh(yh).default}}),bh=C,Object.defineProperty(E,"DirectConnectionProvider",{enumerable:!0,get:function(){return dh(bh).default}}),mh=P,Object.defineProperty(E,"RoutingConnectionProvider",{enumerable:!0,get:function(){return dh(mh).default}}),n=Cr,gh=e&&e.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),vh=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&gh(t,e,r);return vh(t,e),t},I=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||gh(t,e,r)},Object.defineProperty(n,"__esModule",{value:!0}),n.pool=n.packstream=n.channel=n.buf=n.bolt=n.loadBalancing=void 0,n.loadBalancing=a(T),n.bolt=a(s),n.buf=a(ut),n.channel=a(r),n.packstream=a(y),n.pool=a(m),I(xt,n),d=B,wh=e&&e.__awaiter||function(e,s,a,u){return new(a=a||Promise)(function(r,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,o)}i((u=u.apply(e,s||[])).next())})},Oh=e&&e.__generator||function(n,o){var i,s,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,s=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(n,u)}catch(e){t=[6,e],s=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},v=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Object.defineProperty(d,"__esModule",{value:!0}),d.Time=d.LocalTime=d.Duration=d.Point=d.TransactionPromise=d.ManagedTransaction=d.Transaction=d.Session=d.ServerInfo=d.Notification=d.QueryStatistics=d.ProfiledPlan=d.Plan=d.Integer=d.Path=d.PathSegment=d.UnboundRelationship=d.Relationship=d.Node=d.ResultSummary=d.Record=d.Result=d.Driver=d.temporal=d.spatial=d.graph=d.error=d.session=d.types=d.logging=d.auth=d.isRetriableError=d.Neo4jError=d.integer=d.isUnboundRelationship=d.isRelationship=d.isPathSegment=d.isPath=d.isNode=d.isDateTime=d.isLocalDateTime=d.isDate=d.isTime=d.isLocalTime=d.isDuration=d.isPoint=d.isInt=d.int=d.hasReachableServer=d.driver=void 0,d.bookmarkManager=d.Connection=d.ConnectionProvider=d.DateTime=d.LocalDateTime=d.Date=void 0,v=v(F),Eh=H,Object.defineProperty(d,"logging",{enumerable:!0,get:function(){return Eh.logging}}),U=t,Object.defineProperty(d,"Neo4jError",{enumerable:!0,get:function(){return U.Neo4jError}}),Object.defineProperty(d,"isRetriableError",{enumerable:!0,get:function(){return U.isRetriableError}}),Object.defineProperty(d,"error",{enumerable:!0,get:function(){return U.error}}),Object.defineProperty(d,"Integer",{enumerable:!0,get:function(){return U.Integer}}),Object.defineProperty(d,"int",{enumerable:!0,get:function(){return U.int}}),Object.defineProperty(d,"isInt",{enumerable:!0,get:function(){return U.isInt}}),Object.defineProperty(d,"isPoint",{enumerable:!0,get:function(){return U.isPoint}}),Object.defineProperty(d,"Point",{enumerable:!0,get:function(){return U.Point}}),Object.defineProperty(d,"Date",{enumerable:!0,get:function(){return U.Date}}),Object.defineProperty(d,"DateTime",{enumerable:!0,get:function(){return U.DateTime}}),Object.defineProperty(d,"Duration",{enumerable:!0,get:function(){return U.Duration}}),Object.defineProperty(d,"isDate",{enumerable:!0,get:function(){return U.isDate}}),Object.defineProperty(d,"isDateTime",{enumerable:!0,get:function(){return U.isDateTime}}),Object.defineProperty(d,"isDuration",{enumerable:!0,get:function(){return U.isDuration}}),Object.defineProperty(d,"isLocalDateTime",{enumerable:!0,get:function(){return U.isLocalDateTime}}),Object.defineProperty(d,"isLocalTime",{enumerable:!0,get:function(){return U.isLocalTime}}),Object.defineProperty(d,"isNode",{enumerable:!0,get:function(){return U.isNode}}),Object.defineProperty(d,"isPath",{enumerable:!0,get:function(){return U.isPath}}),Object.defineProperty(d,"isPathSegment",{enumerable:!0,get:function(){return U.isPathSegment}}),Object.defineProperty(d,"isRelationship",{enumerable:!0,get:function(){return U.isRelationship}}),Object.defineProperty(d,"isTime",{enumerable:!0,get:function(){return U.isTime}}),Object.defineProperty(d,"isUnboundRelationship",{enumerable:!0,get:function(){return U.isUnboundRelationship}}),Object.defineProperty(d,"LocalDateTime",{enumerable:!0,get:function(){return U.LocalDateTime}}),Object.defineProperty(d,"LocalTime",{enumerable:!0,get:function(){return U.LocalTime}}),Object.defineProperty(d,"Time",{enumerable:!0,get:function(){return U.Time}}),Object.defineProperty(d,"Node",{enumerable:!0,get:function(){return U.Node}}),Object.defineProperty(d,"Path",{enumerable:!0,get:function(){return U.Path}}),Object.defineProperty(d,"PathSegment",{enumerable:!0,get:function(){return U.PathSegment}}),Object.defineProperty(d,"Relationship",{enumerable:!0,get:function(){return U.Relationship}}),Object.defineProperty(d,"UnboundRelationship",{enumerable:!0,get:function(){return U.UnboundRelationship}}),Object.defineProperty(d,"Record",{enumerable:!0,get:function(){return U.Record}}),Object.defineProperty(d,"ResultSummary",{enumerable:!0,get:function(){return U.ResultSummary}}),Object.defineProperty(d,"Result",{enumerable:!0,get:function(){return U.Result}}),Object.defineProperty(d,"ConnectionProvider",{enumerable:!0,get:function(){return U.ConnectionProvider}}),Object.defineProperty(d,"Driver",{enumerable:!0,get:function(){return U.Driver}}),Object.defineProperty(d,"Plan",{enumerable:!0,get:function(){return U.Plan}}),Object.defineProperty(d,"ProfiledPlan",{enumerable:!0,get:function(){return U.ProfiledPlan}}),Object.defineProperty(d,"QueryStatistics",{enumerable:!0,get:function(){return U.QueryStatistics}}),Object.defineProperty(d,"Notification",{enumerable:!0,get:function(){return U.Notification}}),Object.defineProperty(d,"Session",{enumerable:!0,get:function(){return U.Session}}),Object.defineProperty(d,"Transaction",{enumerable:!0,get:function(){return U.Transaction}}),Object.defineProperty(d,"ManagedTransaction",{enumerable:!0,get:function(){return U.ManagedTransaction}}),Object.defineProperty(d,"TransactionPromise",{enumerable:!0,get:function(){return U.TransactionPromise}}),Object.defineProperty(d,"ServerInfo",{enumerable:!0,get:function(){return U.ServerInfo}}),Object.defineProperty(d,"Connection",{enumerable:!0,get:function(){return U.Connection}}),Object.defineProperty(d,"auth",{enumerable:!0,get:function(){return U.auth}}),Object.defineProperty(d,"bookmarkManager",{enumerable:!0,get:function(){return U.bookmarkManager}}),Th=Cr,u=U.driver.READ,f=U.driver.WRITE,_=U.internal.util,Sh=_.ENCRYPTION_ON,Ph=_.assertString,Ch=_.isEmptyObjectOrNull,Ih=U.internal.serverAddress.ServerAddress,Rh=U.internal.urlUtil,d.driver=Ah,d.hasReachableServer=Dh,kh="neo4j-javascript/"+v.default,_={Node:U.Node,Relationship:U.Relationship,UnboundRelationship:U.UnboundRelationship,PathSegment:U.PathSegment,Path:U.Path,Result:U.Result,ResultSummary:U.ResultSummary,Record:U.Record,Point:U.Point,Date:U.Date,DateTime:U.DateTime,Duration:U.Duration,LocalDateTime:U.LocalDateTime,LocalTime:U.LocalTime,Time:U.Time,Integer:U.Integer},d.types=_,v={READ:u,WRITE:f},d.session=v,u={toNumber:U.toNumber,toString:U.toString,inSafeRange:U.inSafeRange},d.integer=u,f={isPoint:U.isPoint},d.spatial=f,b={isDuration:U.isDuration,isLocalTime:U.isLocalTime,isTime:U.isTime,isDate:U.isDate,isLocalDateTime:U.isLocalDateTime,isDateTime:U.isDateTime},d.temporal=b,O={isNode:U.isNode,isPath:U.isPath,isPathSegment:U.isPathSegment,isRelationship:U.isRelationship,isUnboundRelationship:U.isUnboundRelationship},d.graph=O,u={driver:Ah,hasReachableServer:Dh,int:U.int,isInt:U.isInt,isPoint:U.isPoint,isDuration:U.isDuration,isLocalTime:U.isLocalTime,isTime:U.isTime,isDate:U.isDate,isLocalDateTime:U.isLocalDateTime,isDateTime:U.isDateTime,isNode:U.isNode,isPath:U.isPath,isPathSegment:U.isPathSegment,isRelationship:U.isRelationship,isUnboundRelationship:U.isUnboundRelationship,integer:u,Neo4jError:U.Neo4jError,isRetriableError:U.isRetriableError,auth:U.auth,logging:Eh.logging,types:_,session:v,error:U.error,graph:O,spatial:f,temporal:b,Driver:U.Driver,Result:U.Result,Record:U.Record,ResultSummary:U.ResultSummary,Node:U.Node,Relationship:U.Relationship,UnboundRelationship:U.UnboundRelationship,PathSegment:U.PathSegment,Path:U.Path,Integer:U.Integer,Plan:U.Plan,ProfiledPlan:U.ProfiledPlan,QueryStatistics:U.QueryStatistics,Notification:U.Notification,ServerInfo:U.ServerInfo,Session:U.Session,Transaction:U.Transaction,ManagedTransaction:U.ManagedTransaction,TransactionPromise:U.TransactionPromise,Point:U.Point,Duration:U.Duration,LocalTime:U.LocalTime,Time:U.Time,Date:U.Date,LocalDateTime:U.LocalDateTime,DateTime:U.DateTime,ConnectionProvider:U.ConnectionProvider,Connection:U.Connection,bookmarkManager:U.bookmarkManager},d.default=u,M(B)});